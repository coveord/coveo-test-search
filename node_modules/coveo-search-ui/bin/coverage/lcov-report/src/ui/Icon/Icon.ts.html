<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/ui/Icon/Icon.ts</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../../prettify.css">
    <link rel="stylesheet" href="../../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header high">
    <h1>Code coverage report for <span class="entity">src/ui/Icon/Icon.ts</span></h1>
    <h2>
        Statements: <span class="metric">89.47% <small>(51 / 57)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">76% <small>(19 / 25)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">83.33% <small>(5 / 6)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">88% <small>(44 / 50)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> &#187; <a href="index.html">src/ui/Icon/</a> &#187; Icon.ts</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130</td><td class="line-coverage"><span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">76</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">76</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">77</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import {Component} from '../Base/Component'
import {IComponentBindings} from '../Base/ComponentBindings'
import {ComponentOptions} from '../Base/ComponentOptions'
import {IQueryResult} from '../../rest/QueryResult'
import {Assert} from '../../misc/Assert'
import {QueryUtils} from '../../utils/QueryUtils'
import {Initialization} from '../Base/Initialization'
import {Utils} from '../../utils/Utils'
import {FileTypes, IFileTypeInfo} from '../Misc/FileTypes'
import {Quickview} from '../Quickview/Quickview'
import {$$} from '../../utils/Dom'
&nbsp;
export interface IIconOptions {
  value?: string;
  small?: boolean;
  withLabel?: boolean;
  labelValue?: string;
}
&nbsp;
/**
 * An icon component is a Result template component which outputs the corresponding icon for a give filetype. It uses the
 * available icons in the framework, and if no suitable one are found, it fallback on a generic icon.
 */
export class Icon extends Component {
  static ID = 'Icon';
&nbsp;
  /**
   * The options for the component
   * @componentOptions
   */
  static options: IIconOptions = {
    /**
     * Setting this value will tell the Icon component to output this value as it's css class, instead of the auto-selected one.&lt;br/&gt;
     * Default is `undefined`, and the framework will determine an icon from the result filetype.
     */
    value: ComponentOptions.buildIconOption(),
    /**
     * Setting this value to true will output the smaller version of the auto-generated icon.&lt;br/&gt;
     * Default is `false`.
     */
    small: ComponentOptions.buildBooleanOption({ defaultValue: false }),
    /**
     * Setting this to true will force the caption/label to appear.&lt;br/&gt;
     * Setting this to false will force the caption/label to never appear.&lt;br/&gt;
     * Default value is `undefined`, and the framework will determine if a label needs to be displayed.
     */
    withLabel: ComponentOptions.buildBooleanOption(),
    /**
     * Setting this option allow to set the label that should be displayed.&lt;br/&gt;
     * Default value is `undefined`, and the framework will determine the label that will be displayed.
     */
    labelValue: ComponentOptions.buildLocalizedStringOption()
  };
&nbsp;
  static fields = [
    'objecttype',
    'filetype',
  ];
&nbsp;
  /**
   * Create a new Icon component
   * @param element
   * @param options
   * @param bindings
   * @param result
   */
  constructor(public element: HTMLElement, public options?: IIconOptions, bindings?: IComponentBindings, public result?: IQueryResult) {
    super(element, Icon.ID, bindings);
&nbsp;
    this.options = ComponentOptions.initComponentOptions(element, Icon, options);
    this.result = this.result || <span class="branch-1 cbranch-no" title="branch not covered" >this.resolveResult();</span>
    Assert.exists(this.result);
&nbsp;
    var possibleInternalQuickview = $$(this.element).find('.' + Component.computeCssClassNameForType(Quickview.ID));
    <span class="missing-if-branch" title="if path not taken" >I</span>if (!Utils.isNullOrUndefined(possibleInternalQuickview) &amp;&amp; QueryUtils.hasHTMLVersion(this.result)) {
<span class="cstat-no" title="statement not covered" >      $$(this.element).addClass('coveo-with-quickview');</span>
<span class="cstat-no" title="statement not covered" >      $$(this.element).on('click', <span class="fstat-no" title="function not covered" >() =&gt; {</span></span>
<span class="cstat-no" title="statement not covered" >        var qv: Quickview = &lt;Quickview&gt;Component.get(possibleInternalQuickview);</span>
<span class="cstat-no" title="statement not covered" >        qv.open();</span>
      });
    }
&nbsp;
    Icon.createIcon(this.result, this.options, element, bindings);
  }
&nbsp;
  static createIcon(result: IQueryResult, <span class="missing-if-branch" title="if path not taken" >I</span>options: IIconOptions = {}, <span class="missing-if-branch" title="if path not taken" >I</span>element: HTMLElement = $$('div').el, bindings?: IComponentBindings) {
    var info = FileTypes.get(result);
    info = Icon.preprocessIconInfo(options, info);
    $$(element).addClass(info.icon);
    element.setAttribute('title', info.caption);
    if (options.small) {
      $$(element).addClass('coveo-small');
    }
    if (Icon.shouldDisplayLabel(options, bindings)) {
      element.appendChild($$('span', {
        className: 'coveo-icon-caption-overlay'
      }, info.caption).el);
      $$(element).addClass('coveo-icon-with-caption-overlay');
    }
    return element;
  }
&nbsp;
  static shouldDisplayLabel(options: IIconOptions, bindings: IComponentBindings) {
    // Display only in new design.
    // If withLabel is explicitely set to false, the label will never display
    // If withLabel is explicitely set to true, the label will always display
    // If withLabel is set to default value (not a hard true or false), the label will display based on ./core/filetypes/**.json
    // with the property shouldDisplayLabel set on each file type/ objecttype
    // In this case, the generated css will take care of outputting the correct css to display : block
    return bindings &amp;&amp; bindings.searchInterface.isNewDesign() &amp;&amp; options.withLabel !== false;
  }
&nbsp;
  static preprocessIconInfo(options: IIconOptions, info: IFileTypeInfo) {
    if (options.labelValue != null) {
      info.caption = options.labelValue;
    }
    if (options.value != null) {
      info.icon = 'coveo-icon ' + options.value;
    }
    <span class="missing-if-branch" title="if path not taken" >I</span>if (info.caption == null) {
<span class="cstat-no" title="statement not covered" >      info.caption = '';</span>
    }
    <span class="missing-if-branch" title="if path not taken" >I</span>if (info.icon == null) {
<span class="cstat-no" title="statement not covered" >      info.icon = 'coveo-icon coveo-sprites-custom';</span>
    }
    return info;
  }
}
Initialization.registerAutoCreateComponent(Icon);
&nbsp;</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Fri Sep 23 2016 17:38:56 GMT+0000 (UTC)</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>

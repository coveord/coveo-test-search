<!DOCTYPE html>
<html lang="en">

<head>
    <title>Interface Editor</title>
    <meta charset="utf-8" />

    <link rel="stylesheet" type="text/css" href="./interfaceeditor/css/InterfaceEditor.css"/>
    <link rel="stylesheet" type="text/css" href="./caseCreation/css/CaseCreationInterfaceEditor.css"/>

    <script src="./jsSearch/js/CoveoJsSearch.Dependencies.js"></script>
    <script src="./caseCreation/js/CoveoJsSearch_CaseCreation.js"></script>
    <script src="./interfaceEditor/js/InterfaceEditorSolo.js"></script>
    <script src="./caseCreation/js/InterfaceEditor_CaseCreation.js"></script>
    <script src="./interfaceEditor/js/cultures/en.js"></script>
    <script src="./caseCreation/js/cultures/InterfaceEditor.en.js"></script>
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #editor {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
<div id="editor"></div>
<script>
    $(function() {
        var save = function(body) {
            var deferred = $.Deferred();
            $.post('./save', {
                        body: body
                    })
                    .done(function() {
                        deferred.resolve();
                        window.location.replace('.');
                    })
                    .error(function(e) {
                        deferred.resolve(e.responseText);
                    })
            return deferred;
        };

        var load = function() {
            return $.get('./load');
        };

        var close = function() {
            window.location.replace('.');
        };

        var del = function() {
            $.get('del').done(function() {
                window.location = '.';
            });
        };

        var editor = new Coveo.InterfaceEditor.Editor('#editor', {
            namespace: window.location.pathname,
            basicMode: true,
            load: load,
            save: save,
            close: close,
            delete: del,
            iconsUrl: './jsSearch/image/normal-icon-list-new.json',
            mobile: false,
            resultCss: './caseCreation/css/CoveoCaseCreation.css',
            iframeCss: ['./caseCreation/css/CoveoCaseCreation.css', './interfaceEditor/css/InterfaceEditorIframe.css', './caseCreation/css/CaseCreationInterfaceEditor.css'],
            repositories: $.get('./repositories')
        });
    });
</script>
</body>

</html>

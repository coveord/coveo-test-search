{"version":3,"sources":["ResultFolding.min__5f3280c404a1ee75a113.js","./src/ui/ResultFolding/ResultFolding.ts","./src/ui/ResultFolding/DefaultFoldingTemplate.ts"],"names":["webpackJsonpCoveo__temporary","269","module","exports","__webpack_require__","__extends","this","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","verb","n","v","op","f","TypeError","_","y","t","call","label","ops","pop","trys","length","push","g","sent","throw","return","Symbol","iterator","defineProperty","element","options","bindings","ResultFolding","ID","showingMoreResults","ComponentOptions","initComponentOptions","Assert","exists","buildElements","renderElements","_this","showMoreResults","results","e_1","logger","_a","moreResults","cancelAnyPendingShowMore","moreResultsPromise","waitAnimation","$$","className","el","appendChild","updateElementVisibility","childResults","usageAnalytics","logClickEvent","analyticsActionCauseList","foldingShowMore","getAnalyticsMetadata","displayThoseResults","Logger","warn","undefined","detach","showLessResults","logCustomEvent","foldingShowLess","scrollToResultElement","buildHeader","buildResults","buildFooter","parentElement","hasClass","bindOverlayEvents","hide","header","normalCaption","expandedCaption","oneResultCaption","footer","showMore","showLess","footerIconShowMore","SVGIcons","icons","arrowDown","SVGDom","addClassToSVGInContainer","footerIconShowLess","arrowUp","showMoreLink","moreCaption","showLessLink","lessCaption","AccessibleButton","withElement","withLabel","withSelectAction","build","subResultsLength","toggle","toggleClass","Utils","showIfNormal","find","showIfExpanded","resultElem","closest","window","scrollTo","Win","scrollY","getBoundingClientRect","top","childResultsPromises","childsToAppend","map","renderChildResult","all","empty","each","oneChild","childResult","QueryUtils","setStateObjectOnQueryResult","queryStateModel","get","setSearchInterfaceObjectOnQueryResult","searchInterface","resultTemplate","instantiateToElement","wrapInDiv","checkCondition","responsiveComponents","addClass","Initialization","automaticallyCreateComponentsInsideResult","initResult","doesNotExists","bind","one","documentURL","clickUri","documentTitle","title","author","getFieldValue","doExport","exportGlobally","DefaultFoldingTemplate","TemplateComponentOptions","buildTemplateOption","defaultFunction","buildLocalizedStringOption","postProcessing","l","Component","registerAutoCreateComponent","653","instantiateToString","queryResult","getType","Template","654"],"mappings":"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","file":"ResultFolding.min__5f3280c404a1ee75a113.js","sourcesContent":["webpackJsonpCoveo__temporary([41],{\n\n/***/ 269:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Component_1 = __webpack_require__(7);\r\nvar ComponentOptions_1 = __webpack_require__(8);\r\nvar DefaultFoldingTemplate_1 = __webpack_require__(653);\r\nvar Utils_1 = __webpack_require__(4);\r\nvar QueryUtils_1 = __webpack_require__(21);\r\nvar Initialization_1 = __webpack_require__(2);\r\nvar Assert_1 = __webpack_require__(5);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar Strings_1 = __webpack_require__(6);\r\nvar underscore_1 = __webpack_require__(0);\r\nvar GlobalExports_1 = __webpack_require__(3);\r\nvar AnalyticsActionListMeta_1 = __webpack_require__(10);\r\nvar Logger_1 = __webpack_require__(9);\r\n__webpack_require__(654);\r\nvar SVGIcons_1 = __webpack_require__(12);\r\nvar SVGDom_1 = __webpack_require__(16);\r\nvar TemplateComponentOptions_1 = __webpack_require__(61);\r\nvar AccessibleButton_1 = __webpack_require__(15);\r\n/**\r\n * The `ResultFolding` component renders folded result sets. It is usable inside a result template when there is an\r\n * active [`Folding`]{@link Folding} component in the page. This component takes care of rendering the parent result and\r\n * its child results in a coherent manner.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n *\r\n * See [Folding Results](https://docs.coveo.com/en/428/).\r\n */\r\nvar ResultFolding = /** @class */ (function (_super) {\r\n    __extends(ResultFolding, _super);\r\n    /**\r\n     * Creates a new ResultFolding component.\r\n     * @param options The options for the ResultFolding component.\r\n     * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n     * automatically resolved (with a slower execution time).\r\n     * @param result The result to associate the component with.\r\n     */\r\n    function ResultFolding(element, options, bindings, result) {\r\n        var _this = _super.call(this, element, ResultFolding.ID, bindings) || this;\r\n        _this.element = element;\r\n        _this.options = options;\r\n        _this.result = result;\r\n        _this.showingMoreResults = false;\r\n        _this.options = ComponentOptions_1.ComponentOptions.initComponentOptions(_this.element, ResultFolding, options);\r\n        Assert_1.Assert.exists(result);\r\n        _this.buildElements();\r\n        _this.renderElements();\r\n        return _this;\r\n    }\r\n    /**\r\n     * Show more results by fetching additional results from the index, which match the current folded conversation.\r\n     * This is the equivalent of clicking \"Show all conversation\".\r\n     * @returns {Promise<IQueryResult[]>}\r\n     */\r\n    ResultFolding.prototype.showMoreResults = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var results, e_1, logger;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        Assert_1.Assert.exists(this.result.moreResults);\r\n                        this.cancelAnyPendingShowMore();\r\n                        this.moreResultsPromise = this.result.moreResults();\r\n                        this.waitAnimation = Dom_1.$$('div', { className: 'coveo-loading-spinner' }).el;\r\n                        this.results.appendChild(this.waitAnimation);\r\n                        this.updateElementVisibility();\r\n                        return [4 /*yield*/, this.moreResultsPromise];\r\n                    case 1:\r\n                        results = _a.sent();\r\n                        this.childResults = results;\r\n                        this.showingMoreResults = true;\r\n                        this.usageAnalytics.logClickEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.foldingShowMore, this.getAnalyticsMetadata(), this.result, this.element);\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        _a.trys.push([2, 4, , 5]);\r\n                        return [4 /*yield*/, this.displayThoseResults(results)];\r\n                    case 3:\r\n                        _a.sent();\r\n                        this.updateElementVisibility(results.length);\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        e_1 = _a.sent();\r\n                        logger = new Logger_1.Logger(this);\r\n                        logger.warn('An error occured when trying to display more results');\r\n                        return [3 /*break*/, 5];\r\n                    case 5:\r\n                        this.moreResultsPromise = undefined;\r\n                        Dom_1.$$(this.waitAnimation).detach();\r\n                        this.waitAnimation = undefined;\r\n                        return [2 /*return*/, results];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Show less results for a given conversation. This is the equivalent of clicking \"Show less\"\r\n     */\r\n    ResultFolding.prototype.showLessResults = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.cancelAnyPendingShowMore();\r\n                        this.showingMoreResults = false;\r\n                        this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.foldingShowLess, this.getAnalyticsMetadata(), this.element);\r\n                        return [4 /*yield*/, this.displayThoseResults(this.result.childResults)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this.updateElementVisibility();\r\n                        this.scrollToResultElement();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ResultFolding.prototype.buildElements = function () {\r\n        this.buildHeader();\r\n        this.buildResults();\r\n        this.buildFooter();\r\n    };\r\n    ResultFolding.prototype.renderElements = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.displayThoseResults(this.result.childResults)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this.updateElementVisibility();\r\n                        if (Dom_1.$$(this.element.parentElement).hasClass('CoveoCardOverlay')) {\r\n                            this.bindOverlayEvents();\r\n                        }\r\n                        if (this.result.childResults.length == 0 && !this.result.moreResults) {\r\n                            Dom_1.$$(this.element).hide();\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ResultFolding.prototype.buildHeader = function () {\r\n        var header = Dom_1.$$('div', { className: 'coveo-folding-header' }).el;\r\n        this.element.appendChild(header);\r\n        if (this.options.normalCaption != undefined && this.options.expandedCaption != undefined) {\r\n            this.normalCaption = Dom_1.$$('div', { className: 'coveo-folding-normal-caption' }, this.options.normalCaption).el;\r\n            header.appendChild(this.normalCaption);\r\n            this.expandedCaption = Dom_1.$$('div', { className: 'coveo-folding-expanded-caption' }, this.options.expandedCaption).el;\r\n            header.appendChild(this.expandedCaption);\r\n        }\r\n        this.oneResultCaption = Dom_1.$$('div', { className: 'coveo-folding-oneresult-caption' }, this.options.oneResultCaption).el;\r\n        header.appendChild(this.oneResultCaption);\r\n    };\r\n    ResultFolding.prototype.buildResults = function () {\r\n        this.results = Dom_1.$$('div', { className: 'coveo-folding-results' }).el;\r\n        this.element.appendChild(this.results);\r\n    };\r\n    ResultFolding.prototype.buildFooter = function () {\r\n        var _this = this;\r\n        var footer = Dom_1.$$('div', { className: 'coveo-folding-footer' }).el;\r\n        this.element.parentElement.appendChild(footer);\r\n        if (this.result.moreResults) {\r\n            this.showMore = Dom_1.$$('div', { className: 'coveo-folding-footer-section-for-less' }).el;\r\n            footer.appendChild(this.showMore);\r\n            this.showLess = Dom_1.$$('div', { className: 'coveo-folding-footer-section-for-more' }).el;\r\n            footer.appendChild(this.showLess);\r\n            var footerIconShowMore = Dom_1.$$('div', { className: 'coveo-folding-more' }, Dom_1.$$('span', { className: 'coveo-folding-footer-icon' }, SVGIcons_1.SVGIcons.icons.arrowDown).el).el;\r\n            SVGDom_1.SVGDom.addClassToSVGInContainer(footerIconShowMore, 'coveo-folding-more-svg');\r\n            var footerIconShowLess = Dom_1.$$('div', { className: 'coveo-folding-less' }, Dom_1.$$('span', { className: 'coveo-folding-footer-icon' }, SVGIcons_1.SVGIcons.icons.arrowUp).el).el;\r\n            SVGDom_1.SVGDom.addClassToSVGInContainer(footerIconShowLess, 'coveo-folding-less-svg');\r\n            var showMoreLink = Dom_1.$$('a', { className: 'coveo-folding-show-more' }, this.options.moreCaption).el;\r\n            var showLessLink = Dom_1.$$('a', { className: 'coveo-folding-show-less' }, this.options.lessCaption).el;\r\n            new AccessibleButton_1.AccessibleButton()\r\n                .withElement(this.showMore)\r\n                .withLabel(this.options.moreCaption)\r\n                .withSelectAction(function () { return _this.showMoreResults(); })\r\n                .build();\r\n            new AccessibleButton_1.AccessibleButton()\r\n                .withElement(this.showLess)\r\n                .withLabel(this.options.lessCaption)\r\n                .withSelectAction(function () { return _this.showLessResults(); })\r\n                .build();\r\n            this.showMore.appendChild(showMoreLink);\r\n            this.showLess.appendChild(showLessLink);\r\n            this.showMore.appendChild(footerIconShowMore);\r\n            this.showLess.appendChild(footerIconShowLess);\r\n        }\r\n    };\r\n    ResultFolding.prototype.updateElementVisibility = function (subResultsLength) {\r\n        if (this.normalCaption) {\r\n            Dom_1.$$(this.normalCaption).toggle(!this.showingMoreResults && this.result.childResults.length > 0);\r\n        }\r\n        if (this.expandedCaption) {\r\n            Dom_1.$$(this.expandedCaption).toggle(this.showingMoreResults);\r\n        }\r\n        Dom_1.$$(this.oneResultCaption).toggleClass('coveo-hidden', !(subResultsLength && subResultsLength == 1));\r\n        if (this.showMore) {\r\n            Dom_1.$$(this.showMore).toggleClass('coveo-visible', !this.showingMoreResults && !Utils_1.Utils.exists(this.moreResultsPromise));\r\n            Dom_1.$$(this.showLess).toggleClass('coveo-visible', this.showingMoreResults);\r\n        }\r\n        var showIfNormal = Dom_1.$$(this.element).find('.coveo-show-if-normal');\r\n        if (showIfNormal) {\r\n            Dom_1.$$(showIfNormal).toggle(!this.showingMoreResults);\r\n        }\r\n        var showIfExpanded = Dom_1.$$(this.element).find('.coveo-show-if-expanded');\r\n        if (showIfExpanded) {\r\n            Dom_1.$$(showIfExpanded).toggle(this.showingMoreResults);\r\n        }\r\n    };\r\n    ResultFolding.prototype.scrollToResultElement = function () {\r\n        var resultElem = Dom_1.$$(this.element).closest('CoveoResult');\r\n        window.scrollTo(0, new Dom_1.Win(window).scrollY() + resultElem.getBoundingClientRect().top);\r\n    };\r\n    ResultFolding.prototype.displayThoseResults = function (results) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            var childResultsPromises, childsToAppend;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        childResultsPromises = underscore_1.map(results, function (result) {\r\n                            return _this.renderChildResult(result);\r\n                        });\r\n                        return [4 /*yield*/, Promise.all(childResultsPromises)];\r\n                    case 1:\r\n                        childsToAppend = _a.sent();\r\n                        Dom_1.$$(this.results).empty();\r\n                        underscore_1.each(childsToAppend, function (oneChild) {\r\n                            _this.results.appendChild(oneChild);\r\n                        });\r\n                        return [2 /*return*/, true];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ResultFolding.prototype.renderChildResult = function (childResult) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var oneChild;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        QueryUtils_1.QueryUtils.setStateObjectOnQueryResult(this.queryStateModel.get(), childResult);\r\n                        QueryUtils_1.QueryUtils.setSearchInterfaceObjectOnQueryResult(this.searchInterface, childResult);\r\n                        return [4 /*yield*/, this.options.resultTemplate.instantiateToElement(childResult, {\r\n                                wrapInDiv: false,\r\n                                checkCondition: false,\r\n                                responsiveComponents: this.searchInterface.responsiveComponents\r\n                            })];\r\n                    case 1:\r\n                        oneChild = _a.sent();\r\n                        Dom_1.$$(oneChild).addClass('coveo-result-folding-child-result');\r\n                        Dom_1.$$(oneChild).toggleClass('coveo-normal-child-result', !this.showingMoreResults);\r\n                        Dom_1.$$(oneChild).toggleClass('coveo-expanded-child-result', this.showingMoreResults);\r\n                        return [4 /*yield*/, Initialization_1.Initialization.automaticallyCreateComponentsInsideResult(oneChild, childResult).initResult];\r\n                    case 2:\r\n                        _a.sent();\r\n                        return [2 /*return*/, oneChild];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ResultFolding.prototype.cancelAnyPendingShowMore = function () {\r\n        if (this.moreResultsPromise) {\r\n            this.moreResultsPromise = undefined;\r\n        }\r\n        Assert_1.Assert.doesNotExists(this.moreResultsPromise);\r\n        Assert_1.Assert.doesNotExists(this.waitAnimation);\r\n    };\r\n    ResultFolding.prototype.bindOverlayEvents = function () {\r\n        var _this = this;\r\n        this.bind.one(this.element.parentElement, 'openCardOverlay', function () {\r\n            if (_this.result.moreResults) {\r\n                _this.showMoreResults();\r\n            }\r\n        });\r\n    };\r\n    ResultFolding.prototype.getAnalyticsMetadata = function () {\r\n        return {\r\n            documentURL: this.result.clickUri,\r\n            documentTitle: this.result.title,\r\n            author: Utils_1.Utils.getFieldValue(this.result, 'author')\r\n        };\r\n    };\r\n    ResultFolding.ID = 'ResultFolding';\r\n    ResultFolding.doExport = function () {\r\n        GlobalExports_1.exportGlobally({\r\n            ResultFolding: ResultFolding,\r\n            DefaultFoldingTemplate: DefaultFoldingTemplate_1.DefaultFoldingTemplate\r\n        });\r\n    };\r\n    /**\r\n     * The options for the component\r\n     * @componentOptions\r\n     */\r\n    ResultFolding.options = {\r\n        /**\r\n         * Specifies the template to use to render each of the child results for a top result.\r\n         *\r\n         * You can specify a previously registered template to use either by referring to its HTML `id` attribute or to a\r\n         * CSS selector (see {@link TemplateCache}).\r\n         *\r\n         * **Example:**\r\n         *\r\n         * Specifying a previously registered template by referring to its HTML `id` attribute:\r\n         *\r\n         * ```html\r\n         * <span class=\"CoveoResultFolding\" data-result-template-id=\"Foo\"></span>\r\n         * ```\r\n         *\r\n         * Specifying a previously registered template by referring to a CSS selector:\r\n         *\r\n         * ```html\r\n         * <span class='CoveoResultFolding' data-result-template-selector=\"#Foo\"></span>\r\n         * ```\r\n         *\r\n         * If you do not specify a custom folding template, the component uses the default result folding template.\r\n         */\r\n        resultTemplate: TemplateComponentOptions_1.TemplateComponentOptions.buildTemplateOption({ defaultFunction: function () { return new DefaultFoldingTemplate_1.DefaultFoldingTemplate(); } }),\r\n        /**\r\n         * Specifies the caption to display at the top of the child results when the folding result set is not expanded.\r\n         *\r\n         * Default value is `undefined`, which displays no caption.\r\n         */\r\n        normalCaption: ComponentOptions_1.ComponentOptions.buildLocalizedStringOption(),\r\n        /**\r\n         * Specifies the caption to display at the top of the child results when the folding result set is expanded.\r\n         *\r\n         * Default value is `undefined`, which displays no caption.\r\n         */\r\n        expandedCaption: ComponentOptions_1.ComponentOptions.buildLocalizedStringOption(),\r\n        /**\r\n         * Specifies the caption to display on the link to expand / show child results.\r\n         *\r\n         * Default value is the localized string for `ShowMore`.\r\n         */\r\n        moreCaption: ComponentOptions_1.ComponentOptions.buildLocalizedStringOption({ postProcessing: function (value) { return value || Strings_1.l('ShowMore'); } }),\r\n        /**\r\n         * Specifies the caption to display on the link to shrink the loaded folding result set back to only the top result.\r\n         *\r\n         * Default value is the localized string for `ShowLess`.\r\n         */\r\n        lessCaption: ComponentOptions_1.ComponentOptions.buildLocalizedStringOption({ postProcessing: function (value) { return value || Strings_1.l('ShowLess'); } }),\r\n        /**\r\n         * Specifies the caption to display when there is only one result in a folding result set.\r\n         *\r\n         * Default value is the localized string for `DisplayingTheOnlyMessage`\r\n         */\r\n        oneResultCaption: ComponentOptions_1.ComponentOptions.buildLocalizedStringOption({\r\n            postProcessing: function (value) { return value || Strings_1.l('DisplayingTheOnlyMessage'); }\r\n        })\r\n    };\r\n    return ResultFolding;\r\n}(Component_1.Component));\r\nexports.ResultFolding = ResultFolding;\r\nInitialization_1.Initialization.registerAutoCreateComponent(ResultFolding);\r\n\n\n/***/ }),\n\n/***/ 653:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Template_1 = __webpack_require__(27);\r\nvar DefaultFoldingTemplate = /** @class */ (function (_super) {\r\n    __extends(DefaultFoldingTemplate, _super);\r\n    function DefaultFoldingTemplate() {\r\n        return _super.call(this) || this;\r\n    }\r\n    DefaultFoldingTemplate.prototype.instantiateToString = function (queryResult) {\r\n        return '<div class=\"coveo-child-result\"><span class=\"CoveoIcon\" data-small=\"true\"></span> <a class=\"CoveoResultLink\"></a> <span class=\"CoveoQuickview\"></span></div>';\r\n    };\r\n    DefaultFoldingTemplate.prototype.getType = function () {\r\n        return 'DefaultFoldingTemplate';\r\n    };\r\n    return DefaultFoldingTemplate;\r\n}(Template_1.Template));\r\nexports.DefaultFoldingTemplate = DefaultFoldingTemplate;\r\n\n\n/***/ }),\n\n/***/ 654:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// ResultFolding.min__5f3280c404a1ee75a113.js","import { Template } from '../Templates/Template';\r\nimport { Component } from '../Base/Component';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { DefaultFoldingTemplate } from './DefaultFoldingTemplate';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { QueryUtils } from '../../utils/QueryUtils';\r\nimport { Initialization } from '../Base/Initialization';\r\nimport { Assert } from '../../misc/Assert';\r\nimport { $$, Win } from '../../utils/Dom';\r\nimport { l } from '../../strings/Strings';\r\nimport { each, map } from 'underscore';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { analyticsActionCauseList, IAnalyticsDocumentViewMeta } from '../Analytics/AnalyticsActionListMeta';\r\nimport { Logger } from '../../misc/Logger';\r\n\r\nimport 'styling/_ResultFolding';\r\nimport { SVGIcons } from '../../utils/SVGIcons';\r\nimport { SVGDom } from '../../utils/SVGDom';\r\nimport { TemplateComponentOptions } from '../Base/TemplateComponentOptions';\r\nimport { AccessibleButton } from '../../utils/AccessibleButton';\r\n\r\nexport interface IResultFoldingOptions {\r\n  resultTemplate?: Template;\r\n  normalCaption?: string;\r\n  expandedCaption?: string;\r\n  moreCaption?: string;\r\n  lessCaption?: string;\r\n  oneResultCaption?: string;\r\n}\r\n\r\n/**\r\n * The `ResultFolding` component renders folded result sets. It is usable inside a result template when there is an\r\n * active [`Folding`]{@link Folding} component in the page. This component takes care of rendering the parent result and\r\n * its child results in a coherent manner.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n *\r\n * See [Folding Results](https://docs.coveo.com/en/428/).\r\n */\r\nexport class ResultFolding extends Component {\r\n  static ID = 'ResultFolding';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      ResultFolding: ResultFolding,\r\n      DefaultFoldingTemplate: DefaultFoldingTemplate\r\n    });\r\n  };\r\n\r\n  /**\r\n   * The options for the component\r\n   * @componentOptions\r\n   */\r\n  static options: IResultFoldingOptions = {\r\n    /**\r\n     * Specifies the template to use to render each of the child results for a top result.\r\n     *\r\n     * You can specify a previously registered template to use either by referring to its HTML `id` attribute or to a\r\n     * CSS selector (see {@link TemplateCache}).\r\n     *\r\n     * **Example:**\r\n     *\r\n     * Specifying a previously registered template by referring to its HTML `id` attribute:\r\n     *\r\n     * ```html\r\n     * <span class=\"CoveoResultFolding\" data-result-template-id=\"Foo\"></span>\r\n     * ```\r\n     *\r\n     * Specifying a previously registered template by referring to a CSS selector:\r\n     *\r\n     * ```html\r\n     * <span class='CoveoResultFolding' data-result-template-selector=\"#Foo\"></span>\r\n     * ```\r\n     *\r\n     * If you do not specify a custom folding template, the component uses the default result folding template.\r\n     */\r\n    resultTemplate: TemplateComponentOptions.buildTemplateOption({ defaultFunction: () => new DefaultFoldingTemplate() }),\r\n\r\n    /**\r\n     * Specifies the caption to display at the top of the child results when the folding result set is not expanded.\r\n     *\r\n     * Default value is `undefined`, which displays no caption.\r\n     */\r\n    normalCaption: ComponentOptions.buildLocalizedStringOption(),\r\n\r\n    /**\r\n     * Specifies the caption to display at the top of the child results when the folding result set is expanded.\r\n     *\r\n     * Default value is `undefined`, which displays no caption.\r\n     */\r\n    expandedCaption: ComponentOptions.buildLocalizedStringOption(),\r\n\r\n    /**\r\n     * Specifies the caption to display on the link to expand / show child results.\r\n     *\r\n     * Default value is the localized string for `ShowMore`.\r\n     */\r\n    moreCaption: ComponentOptions.buildLocalizedStringOption({ postProcessing: value => value || l('ShowMore') }),\r\n\r\n    /**\r\n     * Specifies the caption to display on the link to shrink the loaded folding result set back to only the top result.\r\n     *\r\n     * Default value is the localized string for `ShowLess`.\r\n     */\r\n    lessCaption: ComponentOptions.buildLocalizedStringOption({ postProcessing: value => value || l('ShowLess') }),\r\n\r\n    /**\r\n     * Specifies the caption to display when there is only one result in a folding result set.\r\n     *\r\n     * Default value is the localized string for `DisplayingTheOnlyMessage`\r\n     */\r\n    oneResultCaption: ComponentOptions.buildLocalizedStringOption({\r\n      postProcessing: value => value || l('DisplayingTheOnlyMessage')\r\n    })\r\n  };\r\n\r\n  private normalCaption: HTMLElement;\r\n  private expandedCaption: HTMLElement;\r\n  private oneResultCaption: HTMLElement;\r\n  private results: HTMLElement;\r\n  private showMore: HTMLElement;\r\n  private showLess: HTMLElement;\r\n  private waitAnimation: HTMLElement;\r\n  private moreResultsPromise: Promise<IQueryResult[]>;\r\n  private showingMoreResults = false;\r\n\r\n  public childResults: IQueryResult[];\r\n\r\n  /**\r\n   * Creates a new ResultFolding component.\r\n   * @param options The options for the ResultFolding component.\r\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n   * automatically resolved (with a slower execution time).\r\n   * @param result The result to associate the component with.\r\n   */\r\n  constructor(\r\n    public element: HTMLElement,\r\n    public options?: IResultFoldingOptions,\r\n    bindings?: IComponentBindings,\r\n    public result?: IQueryResult\r\n  ) {\r\n    super(element, ResultFolding.ID, bindings);\r\n\r\n    this.options = ComponentOptions.initComponentOptions(this.element, ResultFolding, options);\r\n\r\n    Assert.exists(result);\r\n\r\n    this.buildElements();\r\n    this.renderElements();\r\n  }\r\n\r\n  /**\r\n   * Show more results by fetching additional results from the index, which match the current folded conversation.\r\n   * This is the equivalent of clicking \"Show all conversation\".\r\n   * @returns {Promise<IQueryResult[]>}\r\n   */\r\n  public async showMoreResults() {\r\n    Assert.exists(this.result.moreResults);\r\n\r\n    this.cancelAnyPendingShowMore();\r\n    this.moreResultsPromise = this.result.moreResults();\r\n    this.waitAnimation = $$('div', { className: 'coveo-loading-spinner' }).el;\r\n    this.results.appendChild(this.waitAnimation);\r\n    this.updateElementVisibility();\r\n\r\n    const results = await this.moreResultsPromise;\r\n    this.childResults = results;\r\n    this.showingMoreResults = true;\r\n    this.usageAnalytics.logClickEvent<IAnalyticsDocumentViewMeta>(\r\n      analyticsActionCauseList.foldingShowMore,\r\n      this.getAnalyticsMetadata(),\r\n      this.result,\r\n      this.element\r\n    );\r\n\r\n    try {\r\n      await this.displayThoseResults(results);\r\n      this.updateElementVisibility(results.length);\r\n    } catch (e) {\r\n      const logger = new Logger(this);\r\n      logger.warn('An error occured when trying to display more results');\r\n    }\r\n\r\n    this.moreResultsPromise = undefined;\r\n    $$(this.waitAnimation).detach();\r\n    this.waitAnimation = undefined;\r\n\r\n    return results;\r\n  }\r\n\r\n  /**\r\n   * Show less results for a given conversation. This is the equivalent of clicking \"Show less\"\r\n   */\r\n  public async showLessResults() {\r\n    this.cancelAnyPendingShowMore();\r\n    this.showingMoreResults = false;\r\n    this.usageAnalytics.logCustomEvent<IAnalyticsDocumentViewMeta>(\r\n      analyticsActionCauseList.foldingShowLess,\r\n      this.getAnalyticsMetadata(),\r\n      this.element\r\n    );\r\n    await this.displayThoseResults(this.result.childResults);\r\n    this.updateElementVisibility();\r\n    this.scrollToResultElement();\r\n  }\r\n\r\n  private buildElements() {\r\n    this.buildHeader();\r\n    this.buildResults();\r\n    this.buildFooter();\r\n  }\r\n\r\n  private async renderElements() {\r\n    await this.displayThoseResults(this.result.childResults);\r\n    this.updateElementVisibility();\r\n\r\n    if ($$(this.element.parentElement).hasClass('CoveoCardOverlay')) {\r\n      this.bindOverlayEvents();\r\n    }\r\n\r\n    if (this.result.childResults.length == 0 && !this.result.moreResults) {\r\n      $$(this.element).hide();\r\n    }\r\n  }\r\n\r\n  private buildHeader() {\r\n    let header = $$('div', { className: 'coveo-folding-header' }).el;\r\n    this.element.appendChild(header);\r\n    if (this.options.normalCaption != undefined && this.options.expandedCaption != undefined) {\r\n      this.normalCaption = $$('div', { className: 'coveo-folding-normal-caption' }, this.options.normalCaption).el;\r\n      header.appendChild(this.normalCaption);\r\n\r\n      this.expandedCaption = $$('div', { className: 'coveo-folding-expanded-caption' }, this.options.expandedCaption).el;\r\n      header.appendChild(this.expandedCaption);\r\n    }\r\n    this.oneResultCaption = $$('div', { className: 'coveo-folding-oneresult-caption' }, this.options.oneResultCaption).el;\r\n    header.appendChild(this.oneResultCaption);\r\n  }\r\n\r\n  private buildResults() {\r\n    this.results = $$('div', { className: 'coveo-folding-results' }).el;\r\n    this.element.appendChild(this.results);\r\n  }\r\n\r\n  private buildFooter() {\r\n    const footer = $$('div', { className: 'coveo-folding-footer' }).el;\r\n    this.element.parentElement.appendChild(footer);\r\n\r\n    if (this.result.moreResults) {\r\n      this.showMore = $$('div', { className: 'coveo-folding-footer-section-for-less' }).el;\r\n      footer.appendChild(this.showMore);\r\n\r\n      this.showLess = $$('div', { className: 'coveo-folding-footer-section-for-more' }).el;\r\n      footer.appendChild(this.showLess);\r\n\r\n      const footerIconShowMore = $$(\r\n        'div',\r\n        { className: 'coveo-folding-more' },\r\n        $$('span', { className: 'coveo-folding-footer-icon' }, SVGIcons.icons.arrowDown).el\r\n      ).el;\r\n      SVGDom.addClassToSVGInContainer(footerIconShowMore, 'coveo-folding-more-svg');\r\n\r\n      const footerIconShowLess = $$(\r\n        'div',\r\n        { className: 'coveo-folding-less' },\r\n        $$('span', { className: 'coveo-folding-footer-icon' }, SVGIcons.icons.arrowUp).el\r\n      ).el;\r\n      SVGDom.addClassToSVGInContainer(footerIconShowLess, 'coveo-folding-less-svg');\r\n\r\n      const showMoreLink = $$('a', { className: 'coveo-folding-show-more' }, this.options.moreCaption).el;\r\n      const showLessLink = $$('a', { className: 'coveo-folding-show-less' }, this.options.lessCaption).el;\r\n\r\n      new AccessibleButton()\r\n        .withElement(this.showMore)\r\n        .withLabel(this.options.moreCaption)\r\n        .withSelectAction(() => this.showMoreResults())\r\n        .build();\r\n\r\n      new AccessibleButton()\r\n        .withElement(this.showLess)\r\n        .withLabel(this.options.lessCaption)\r\n        .withSelectAction(() => this.showLessResults())\r\n        .build();\r\n\r\n      this.showMore.appendChild(showMoreLink);\r\n      this.showLess.appendChild(showLessLink);\r\n      this.showMore.appendChild(footerIconShowMore);\r\n      this.showLess.appendChild(footerIconShowLess);\r\n    }\r\n  }\r\n\r\n  private updateElementVisibility(subResultsLength?: number) {\r\n    if (this.normalCaption) {\r\n      $$(this.normalCaption).toggle(!this.showingMoreResults && this.result.childResults.length > 0);\r\n    }\r\n    if (this.expandedCaption) {\r\n      $$(this.expandedCaption).toggle(this.showingMoreResults);\r\n    }\r\n    $$(this.oneResultCaption).toggleClass('coveo-hidden', !(subResultsLength && subResultsLength == 1));\r\n\r\n    if (this.showMore) {\r\n      $$(this.showMore).toggleClass('coveo-visible', !this.showingMoreResults && !Utils.exists(this.moreResultsPromise));\r\n      $$(this.showLess).toggleClass('coveo-visible', this.showingMoreResults);\r\n    }\r\n\r\n    let showIfNormal = $$(this.element).find('.coveo-show-if-normal');\r\n    if (showIfNormal) {\r\n      $$(showIfNormal).toggle(!this.showingMoreResults);\r\n    }\r\n\r\n    let showIfExpanded = $$(this.element).find('.coveo-show-if-expanded');\r\n    if (showIfExpanded) {\r\n      $$(showIfExpanded).toggle(this.showingMoreResults);\r\n    }\r\n  }\r\n\r\n  private scrollToResultElement() {\r\n    let resultElem = $$(this.element).closest('CoveoResult');\r\n    window.scrollTo(0, new Win(window).scrollY() + resultElem.getBoundingClientRect().top);\r\n  }\r\n\r\n  private async displayThoseResults(results: IQueryResult[]): Promise<boolean> {\r\n    const childResultsPromises = map(results, result => {\r\n      return this.renderChildResult(result);\r\n    });\r\n\r\n    const childsToAppend: HTMLElement[] = await Promise.all(childResultsPromises);\r\n    $$(this.results).empty();\r\n    each(childsToAppend, oneChild => {\r\n      this.results.appendChild(oneChild);\r\n    });\r\n    return true;\r\n  }\r\n\r\n  private async renderChildResult(childResult: IQueryResult): Promise<HTMLElement> {\r\n    QueryUtils.setStateObjectOnQueryResult(this.queryStateModel.get(), childResult);\r\n    QueryUtils.setSearchInterfaceObjectOnQueryResult(this.searchInterface, childResult);\r\n\r\n    const oneChild: HTMLElement = await this.options.resultTemplate.instantiateToElement(childResult, {\r\n      wrapInDiv: false,\r\n      checkCondition: false,\r\n      responsiveComponents: this.searchInterface.responsiveComponents\r\n    });\r\n\r\n    $$(oneChild).addClass('coveo-result-folding-child-result');\r\n    $$(oneChild).toggleClass('coveo-normal-child-result', !this.showingMoreResults);\r\n    $$(oneChild).toggleClass('coveo-expanded-child-result', this.showingMoreResults);\r\n\r\n    await Initialization.automaticallyCreateComponentsInsideResult(oneChild, childResult).initResult;\r\n    return oneChild;\r\n  }\r\n\r\n  private cancelAnyPendingShowMore() {\r\n    if (this.moreResultsPromise) {\r\n      this.moreResultsPromise = undefined;\r\n    }\r\n\r\n    Assert.doesNotExists(this.moreResultsPromise);\r\n    Assert.doesNotExists(this.waitAnimation);\r\n  }\r\n\r\n  private bindOverlayEvents() {\r\n    this.bind.one(this.element.parentElement, 'openCardOverlay', () => {\r\n      if (this.result.moreResults) {\r\n        this.showMoreResults();\r\n      }\r\n    });\r\n  }\r\n\r\n  private getAnalyticsMetadata(): IAnalyticsDocumentViewMeta {\r\n    return {\r\n      documentURL: this.result.clickUri,\r\n      documentTitle: this.result.title,\r\n      author: Utils.getFieldValue(this.result, 'author')\r\n    };\r\n  }\r\n}\r\n\r\nInitialization.registerAutoCreateComponent(ResultFolding);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResultFolding/ResultFolding.ts","import { Template } from '../Templates/Template';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\n\r\nexport class DefaultFoldingTemplate extends Template {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  instantiateToString(queryResult?: IQueryResult): string {\r\n    return '<div class=\"coveo-child-result\"><span class=\"CoveoIcon\" data-small=\"true\"></span> <a class=\"CoveoResultLink\"></a> <span class=\"CoveoQuickview\"></span></div>';\r\n  }\r\n\r\n  getType() {\r\n    return 'DefaultFoldingTemplate';\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResultFolding/DefaultFoldingTemplate.ts"],"sourceRoot":""}
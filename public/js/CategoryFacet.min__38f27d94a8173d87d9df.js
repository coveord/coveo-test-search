webpackJsonpCoveo__temporary([10],{14:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=function(){function e(){}return e.addClassToSVGInContainer=function(t,n){var o=t.querySelector("svg");o.setAttribute("class",""+e.getClass(o)+n)},e.removeClassFromSVGInContainer=function(t,n){var o=t.querySelector("svg");o.setAttribute("class",e.getClass(o).replace(n,""))},e.addStyleToSVGInContainer=function(e,t){var n=e.querySelector("svg");o.each(t,function(e,t){n.style[t]=e})},e.getClass=function(e){var t=e.getAttribute("class");return t?t+" ":""},e}();t.SVGDom=r},145:function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,s)}c((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,a&&(i=a[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(a,n[1])).done)return i;switch(a=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(i=c.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){c.label=n[1];break}if(6===n[0]&&c.label<i[1]){c.label=i[1],i=n;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(n);break}i[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,a,i,s,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),s=n(7),c=n(8),l=n(1),u=n(2),h=n(3),p=n(490),d=n(491),f=n(493),y=n(14),g=n(13),v=n(12);n(494);var m=n(15),b=n(4),C=n(0),S=n(5),E=n(10),A=n(495),F=n(28),R=n(37),$=n(497),V=n(9),w=n(498),P=n(36),O=function(e){function t(n,o,r){var a=e.call(this,n,"CategoryFacet",r)||this;return a.element=n,a.options=o,a.listenToQueryStateChange=!0,a.moreValuesToFetch=!0,a.numberOfChildValuesCurrentlyDisplayed=0,a.options=c.ComponentOptions.initComponentOptions(n,t,o),a.categoryFacetQueryController=new f.CategoryFacetQueryController(a),a.categoryFacetTemplates=new p.CategoryFacetTemplates,a.categoryValueRoot=new d.CategoryValueRoot(l.$$(a.element),a.categoryFacetTemplates,a),a.categoryValueRoot.path=a.activePath,a.currentPage=0,a.numberOfValues=a.options.numberOfValues,a.options.enableFacetSearch&&(a.categoryFacetSearch=new A.CategoryFacetSearch(a)),a.options.debug&&new w.CategoryFacetDebug(a),a.bind.onRootElement(E.QueryEvents.buildingQuery,function(e){return a.handleBuildingQuery(e)}),a.bind.onRootElement(E.QueryEvents.querySuccess,function(e){return a.handleQuerySuccess(e)}),a.bind.onRootElement(E.QueryEvents.duringQuery,function(){return a.addFading()}),a.bind.onRootElement(E.QueryEvents.deferredQuerySuccess,function(){return a.removeFading()}),a.bind.onRootElement(R.BreadcrumbEvents.populateBreadcrumb,function(e){return a.handlePopulateBreadCrumb(e)}),a.bind.onRootElement(R.BreadcrumbEvents.clearBreadcrumb,function(){return a.handleClearBreadcrumb()}),a.buildFacetHeader(),a.initQueryStateEvents(),a}return o(t,e),t.prototype.isCurrentlyDisplayed=function(){return this.hasValues},Object.defineProperty(t.prototype,"activePath",{get:function(){return this.queryStateModel.get(this.queryStateAttribute)||this.options.basePath},set:function(e){this.listenToQueryStateChange=!1,this.queryStateModel.set(this.queryStateAttribute,e),this.listenToQueryStateChange=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryStateAttribute",{get:function(){return v.QueryStateModel.getFacetId(this.options.id)},enumerable:!0,configurable:!0}),t.prototype.handleBuildingQuery=function(e){this.positionInQuery=this.categoryFacetQueryController.putCategoryFacetInQueryBuilder(e.queryBuilder,this.activePath,this.numberOfValues+1)},t.prototype.handleNoResults=function(){return this.isPristine()?void this.hide():this.hasValues?void this.show():(this.activePath=this.options.basePath,void this.hide())},t.prototype.handleQuerySuccess=function(e){if(b.Utils.isNullOrUndefined(e.results.categoryFacets))return void this.notImplementedError();if(b.Utils.isNullOrUndefined(e.results.categoryFacets[this.positionInQuery]))return void this.handleNoResults();var t=e.query.categoryFacets[this.positionInQuery].maximumNumberOfValues,n=e.results.categoryFacets[this.positionInQuery];if(this.moreValuesToFetch=t==n.values.length,this.clear(),n.notImplemented)return void this.notImplementedError();if(0==n.values.length&&0==n.parentValues.length)return void this.handleNoResults();if(this.renderValues(n,t),this.options.enableFacetSearch){var o=this.categoryFacetSearch.build();l.$$(o).insertAfter(this.categoryValueRoot.listRoot.el)}this.options.enableMoreLess&&this.renderMoreLess(),this.isPristine()||l.$$(this.element).addClass("coveo-category-facet-non-empty-path")},t.prototype.changeActivePath=function(e){this.activePath=e},t.prototype.executeQuery=function(){return r(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:this.showWaitingAnimation(),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,this.queryController.executeQuery()];case 2:return e.sent(),[3,4];case 3:return this.hideWaitAnimation(),[7];case 4:return[2]}})})},t.prototype.reload=function(){this.changeActivePath(this.activePath),this.logAnalyticsEvent(V.analyticsActionCauseList.categoryFacetReload),this.executeQuery()},t.prototype.getVisibleParentValues=function(){return this.getVisibleParentCategoryValues().map(function(e){return e.getDescriptor()})},t.prototype.getVisibleParentCategoryValues=function(){if(0==this.categoryValueRoot.children.length||0==this.categoryValueRoot.children[0].children.length)return[];for(var e=this.categoryValueRoot.children[0],t=[e];0!=e.children.length&&!b.Utils.arrayEqual(e.path,this.activePath);)e=e.children[0],t.push(e);return t},t.prototype.showMore=function(){this.moreValuesToFetch&&(this.currentPage++,this.numberOfValues=this.options.numberOfValues+this.currentPage*this.options.pageSize,this.reload())},t.prototype.showLess=function(){this.currentPage>0&&(this.currentPage--,this.numberOfValues=this.options.numberOfValues+this.currentPage*this.options.pageSize,this.reload())},t.prototype.getAvailableValues=function(){return this.activeCategoryValue?this.activeCategoryValue.children.map(function(e){return{value:e.categoryValueDescriptor.value,count:e.categoryValueDescriptor.count,path:e.path}}):[]},t.prototype.selectValue=function(e){S.Assert.check(C.contains(C.pluck(this.getAvailableValues(),"value"),e),"Failed while trying to select a value that is not available.");var t=this.activePath.slice(0);t.push(e),this.changeActivePath(t),this.logAnalyticsEvent(V.analyticsActionCauseList.categoryFacetSelect),this.executeQuery()},t.prototype.deselectCurrentValue=function(){if(0!=this.activePath.length){var e=this.activePath.slice(0);e.pop(),this.changeActivePath(e),this.logAnalyticsEvent(V.analyticsActionCauseList.categoryFacetSelect),this.executeQuery()}},t.prototype.reset=function(){this.changeActivePath(this.options.basePath),this.logAnalyticsEvent(V.analyticsActionCauseList.categoryFacetClear),this.executeQuery()},t.prototype.disable=function(){e.prototype.disable.call(this),this.hide()},t.prototype.hide=function(){l.$$(this.element).addClass("coveo-hidden")},t.prototype.show=function(){l.$$(this.element).removeClass("coveo-hidden")},t.prototype.debugValue=function(e){return r(this,void 0,void 0,function(){var t,n;return a(this,function(o){switch(o.label){case 0:return t=new P.QueryBuilder,this.categoryFacetQueryController.addDebugGroupBy(t,e),[4,this.queryController.getEndpoint().search(t.build())];case 1:return n=o.sent(),w.CategoryFacetDebug.analyzeResults(n.groupByResults[0],this.options.delimitingCharacter),[2]}})})},t.prototype.showWaitingAnimation=function(){"hidden"==this.waitElement.el.style.visibility&&(this.waitElement.el.style.visibility="visible")},t.prototype.hideWaitAnimation=function(){"visible"==this.waitElement.el.style.visibility&&(this.waitElement.el.style.visibility="hidden")},t.prototype.logAnalyticsEvent=function(e,t){void 0===t&&(t=this.activePath),this.usageAnalytics.logSearchEvent(e,{categoryFacetId:this.options.id,categoryFacetPath:t,categoryFacetTitle:this.options.title})},t.prototype.getEndpoint=function(){return this.queryController.getEndpoint()},Object.defineProperty(t.prototype,"children",{get:function(){return this.categoryValueRoot.children},enumerable:!0,configurable:!0}),t.prototype.renderValues=function(e,n){this.show();var o,r=this.sortParentValues(e.parentValues),a=this.categoryValueRoot,i=!1,s=Math.floor(t.NUMBER_OF_VALUES_TO_KEEP_AFTER_TRUNCATING/2),c=Math.ceil(t.NUMBER_OF_VALUES_TO_KEEP_AFTER_TRUNCATING/2);r=this.hideBasePathInParentValues(r),this.shouldTruncate(r)&&(o=this.findPathOfLastTruncatedParentValue(r,c),i=!0,r=C.first(r,s).concat(C.last(r,c))),this.isPristine()||this.addAllCategoriesButton();for(var l=0;l<r.length;l++){a=a.renderAsParent(r[l]);l==r.length-1||a.makeSelectable().showCollapseArrow(),i&&(l==s-1&&this.addEllipsis(),l==s&&(a.path=o.concat([r[l].value])))}var u=this.moreValuesToFetch?e.values.slice(0,n-1):e.values.slice(0,n);this.numberOfChildValuesCurrentlyDisplayed=u.length,a.renderChildren(u),this.activeCategoryValue=a},t.prototype.hideBasePathInParentValues=function(e){return b.Utils.arrayEqual(C.first(this.activePath,this.options.basePath.length),this.options.basePath)&&(e=C.last(e,e.length-this.options.basePath.length)),e},t.prototype.shouldTruncate=function(e){return e.length>t.MAXIMUM_NUMBER_OF_VALUES_BEFORE_TRUNCATING},t.prototype.addEllipsis=function(){this.categoryValueRoot.listRoot.append(this.categoryFacetTemplates.buildEllipsis().el)},t.prototype.findPathOfLastTruncatedParentValue=function(e,t){var n=e.length-t-1;return C.reduce(C.first(e,n+1),function(e,t){return e.concat([t.value])},[])},t.prototype.addAllCategoriesButton=function(){var e=this,t=this.categoryFacetTemplates.buildAllCategoriesButton();t.on("click",function(){return e.reset()}),this.categoryValueRoot.listRoot.append(t.el)},t.prototype.isPristine=function(){return b.Utils.arrayEqual(this.activePath,this.options.basePath)},t.prototype.buildFacetHeader=function(){var e=this;this.waitElement=l.$$("div",{className:t.WAIT_ELEMENT_CLASS},g.SVGIcons.icons.loading),y.SVGDom.addClassToSVGInContainer(this.waitElement.el,"coveo-category-facet-header-wait-animation-svg"),this.waitElement.el.style.visibility="hidden";var n=l.$$("div",{className:"coveo-category-facet-title"},this.options.title);this.facetHeader=l.$$("div",{className:"coveo-category-facet-header"},n),l.$$(this.element).prepend(this.facetHeader.el),this.facetHeader.append(this.waitElement.el);var o=l.$$("div",{title:s.l("Clear",this.options.title),className:"coveo-category-facet-header-eraser coveo-facet-header-eraser"},g.SVGIcons.icons.mainClear);y.SVGDom.addClassToSVGInContainer(o.el,"coveo-facet-header-eraser-svg"),o.on("click",function(){e.logAnalyticsEvent(V.analyticsActionCauseList.categoryFacetClear),e.reset()}),this.facetHeader.append(o.el)},t.prototype.handleQueryStateChanged=function(e){if(this.listenToQueryStateChange){var t=e.attributes[this.queryStateAttribute];!b.Utils.isNullOrUndefined(t)&&C.isArray(t)&&0!=t.length&&(this.activePath=t)}},t.prototype.initQueryStateEvents=function(){var e=this;this.queryStateModel.registerNewAttribute(this.queryStateAttribute,this.options.basePath),this.bind.onQueryState(m.MODEL_EVENTS.CHANGE,void 0,function(t){return e.handleQueryStateChanged(t)})},t.prototype.addFading=function(){l.$$(this.element).addClass("coveo-category-facet-values-fade")},t.prototype.removeFading=function(){l.$$(this.element).removeClass("coveo-category-facet-values-fade")},t.prototype.notImplementedError=function(){this.logger.error("Category Facets are not supported by your current search endpoint. Disabling this component."),this.disable()},t.prototype.sortParentValues=function(e){if(this.activePath.length!=e.length)return this.logger.warn("Inconsistent CategoryFacet results: Number of parent values results does not equal length of active path"),e;for(var t=[],n=this,o=0,r=this.activePath;o<r.length;o++){var a=r[o],i=function(o){var r=C.find(e,function(e){return e.value.toLowerCase()==o.toLowerCase()});if(!r)return n.logger.warn("Inconsistent CategoryFacet results: path not consistent with parent values results"),{value:e};t.push(r)}(a);if("object"==typeof i)return i.value}return t},t.prototype.renderMoreLess=function(){this.moreLessContainer=l.$$("div",{className:"coveo-category-facet-more-less-container"}),l.$$(this.element).append(this.moreLessContainer.el),this.numberOfChildValuesCurrentlyDisplayed>this.options.numberOfValues&&this.moreLessContainer.append(this.buildLessButton()),this.moreValuesToFetch&&this.moreLessContainer.append(this.buildMoreButton())},t.prototype.clear=function(){this.categoryValueRoot.clear(),this.options.enableFacetSearch&&this.categoryFacetSearch.clear(),this.moreLessContainer&&this.moreLessContainer.detach(),l.$$(this.element).removeClass("coveo-category-facet-non-empty-path")},t.prototype.buildMoreButton=function(){var e=this,t=l.$$("span",{className:"coveo-facet-more-icon"},g.SVGIcons.icons.arrowDown).el;y.SVGDom.addClassToSVGInContainer(t,"coveo-facet-more-icon-svg");var n=l.$$("div",{className:"coveo-category-facet-more",tabindex:0},t),o=function(){return e.showMore()};return n.on("click",function(){return e.showMore()}),n.on("keyup",F.KeyboardUtils.keypressAction(F.KEYBOARD.ENTER,o)),n.el},t.prototype.buildLessButton=function(){var e=this,t=l.$$("span",{className:"coveo-facet-less-icon"},g.SVGIcons.icons.arrowUp).el;y.SVGDom.addClassToSVGInContainer(t,"coveo-facet-less-icon-svg");var n=l.$$("div",{className:"coveo-category-facet-less",tabIndex:0},t),o=function(){return e.showLess()};return n.on("click",o),n.on("keyup",F.KeyboardUtils.keypressAction(F.KEYBOARD.ENTER,o)),n.el},t.prototype.handlePopulateBreadCrumb=function(e){var t=this,n=this.getVisibleParentValues().pop();if(!this.isPristine()&&n){var o=function(){t.logAnalyticsEvent(V.analyticsActionCauseList.breadcrumbFacet),t.reset()},r=new $.CategoryFacetBreadcrumb(this.options.title,o,n);e.breadcrumbs.push({element:r.build()})}},t.prototype.handleClearBreadcrumb=function(){this.changeActivePath(this.options.basePath)},Object.defineProperty(t.prototype,"hasValues",{get:function(){return this.getAvailableValues().length>0},enumerable:!0,configurable:!0}),t.doExport=function(){h.exportGlobally({CategoryFacet:t})},t.ID="CategoryFacet",t.options={field:c.ComponentOptions.buildFieldOption({required:!0}),title:c.ComponentOptions.buildLocalizedStringOption({defaultValue:s.l("NoTitle")}),numberOfValues:c.ComponentOptions.buildNumberOption({defaultValue:5,min:0,section:"CommonOptions"}),enableFacetSearch:c.ComponentOptions.buildBooleanOption({defaultValue:!0}),id:c.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field}}),injectionDepth:c.ComponentOptions.buildNumberOption({defaultValue:1e3,min:0}),numberOfResultsInFacetSearch:c.ComponentOptions.buildNumberOption({defaultValue:15,min:1}),facetSearchDelay:c.ComponentOptions.buildNumberOption({defaultValue:100,min:0}),enableMoreLess:c.ComponentOptions.buildBooleanOption({defaultValue:!0}),pageSize:c.ComponentOptions.buildNumberOption({defaultValue:10,min:1,depend:"enableMoreLess"}),delimitingCharacter:c.ComponentOptions.buildStringOption({defaultValue:"|"}),basePath:c.ComponentOptions.buildListOption({defaultValue:[]}),maximumDepth:c.ComponentOptions.buildNumberOption({min:1,defaultValue:Number.MAX_VALUE}),debug:c.ComponentOptions.buildBooleanOption({defaultValue:!1})},t.MAXIMUM_NUMBER_OF_VALUES_BEFORE_TRUNCATING=15,t.NUMBER_OF_VALUES_TO_KEEP_AFTER_TRUNCATING=10,t.WAIT_ELEMENT_CLASS="coveo-category-facet-header-wait-animation",t}(i.Component);t.CategoryFacet=O,u.Initialization.registerAutoCreateComponent(O),O.doExport()},154:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=function(){function e(){}return e.addPrefixedEvent=function(e,t,n){o.each(this.prefixes,function(o){""==o&&(t=t.toLowerCase()),e.addEventListener(o+t,n,!1)})},e.removePrefixedEvent=function(e,t,n){o.each(this.prefixes,function(o){""==o&&(t=t.toLowerCase()),e.removeEventListener(o+t,n,!1)})},e.prefixes=["webkit","moz","MS","o",""],e}();t.EventsUtils=r},18:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(11),r=n(28),a=n(1);n(367);var i=function(){function e(){this.logger=new o.Logger(this)}return e.prototype.withOwner=function(e){return this.eventOwner=e,this},e.prototype.withElement=function(e){return e instanceof HTMLElement?this.element=a.$$(e):this.element=e,this},e.prototype.withLabel=function(e){return this.label=e,this},e.prototype.withTitle=function(e){return this.title=e,this},e.prototype.withSelectAction=function(e){return this.clickAction=e,this.enterKeyboardAction=e,this},e.prototype.withClickAction=function(e){return this.clickAction=e,this},e.prototype.withEnterKeyboardAction=function(e){return this.enterKeyboardAction=e,this},e.prototype.withFocusAndMouseEnterAction=function(e){return this.focusAction=e,this.mouseenterAction=e,this},e.prototype.withFocusAction=function(e){return this.focusAction=e,this},e.prototype.withMouseEnterAction=function(e){return this.mouseenterAction=e,this},e.prototype.withBlurAndMouseLeaveAction=function(e){return this.mouseleaveAction=e,this.blurAction=e,this},e.prototype.withMouseLeaveAction=function(e){return this.mouseleaveAction=e,this},e.prototype.withBlurAction=function(e){return this.blurAction=e,this},e.prototype.build=function(){return this.element||(this.element=a.$$("div")),this.ensureCorrectRole(),this.ensureCorrectLabel(),this.ensureTitle(),this.ensureSelectAction(),this.ensureUnselectAction(),this.ensureMouseenterAndFocusAction(),this.ensureMouseleaveAndBlurAction(),this.ensureDifferentiationBetweenKeyboardAndMouseFocus(),this},e.prototype.ensureDifferentiationBetweenKeyboardAndMouseFocus=function(){var e=this,t="coveo-accessible-button-pressed",n="coveo-accessible-button-focused";a.$$(this.element).addClass("coveo-accessible-button"),a.$$(this.element).on("mousedown",function(){a.$$(e.element).addClass(t),a.$$(e.element).removeClass(n)}),a.$$(this.element).on("mouseup",function(){return a.$$(e.element).removeClass(t)}),a.$$(this.element).on("focus",function(){a.$$(e.element).hasClass(t)||a.$$(e.element).addClass(n)}),a.$$(this.element).on("blur",function(){return a.$$(e.element).removeClass(n)})},e.prototype.ensureCorrectRole=function(){this.element.getAttribute("role")||this.element.setAttribute("role","button")},e.prototype.ensureCorrectLabel=function(){if(!this.label)return void this.logger.error("Missing label to create an accessible button !");this.element.setAttribute("aria-label",this.label)},e.prototype.ensureTitle=function(){this.title&&this.element.setAttribute("title",this.title)},e.prototype.ensureTabIndex=function(){this.element.setAttribute("tabindex","0")},e.prototype.ensureSelectAction=function(){var e=this;this.enterKeyboardAction&&(this.ensureTabIndex(),this.bindEvent("keyup",r.KeyboardUtils.keypressAction(r.KEYBOARD.ENTER,function(t){return e.enterKeyboardAction(t)}))),this.clickAction&&this.bindEvent("click",this.clickAction)},e.prototype.ensureUnselectAction=function(){this.blurAction&&this.bindEvent("blur",this.blurAction),this.mouseleaveAction&&this.bindEvent("mouseleave",this.mouseleaveAction)},e.prototype.ensureMouseenterAndFocusAction=function(){this.mouseenterAction&&this.bindEvent("mouseenter",this.mouseenterAction),this.focusAction&&this.bindEvent("focus",this.focusAction)},e.prototype.ensureMouseleaveAndBlurAction=function(){this.mouseleaveAction&&this.bindEvent("mouseleave",this.mouseleaveAction),this.blurAction&&this.bindEvent("blur",this.blurAction)},e.prototype.bindEvent=function(e,t){this.eventOwner?this.eventOwner.on(this.element,e,t):a.$$(this.element).on(e,t)},e}();t.AccessibleButton=i},328:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.Legacy="legacy",e.Wildcards="wildcards",e.Regex="regex",e.EditDistance="editdistance",e.Phonetic="phonetic"}(t.AllowedValuesPatternType||(t.AllowedValuesPatternType={}))},331:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(13),a=n(14),i=n(6),s=n(7),c=n(154),l=n(70),u=n(371),h=n(0),p=function(){function e(e){var t=this;this.facetSearch=e,this.searchBarIsAnimating=!1,this.triggeredScroll=!1,this.facetSearchUserInputHandler=new u.FacetSearchUserInputHandler(this.facetSearch),this.searchResults=o.$$("ul",{className:"coveo-facet-search-results"}).el,o.$$(this.searchResults).on("scroll",function(){return t.handleScrollEvent()}),o.$$(this.searchResults).hide()}return e.prototype.build=function(e){var t=this;this.search=document.createElement("div"),o.$$(this.search).addClass("coveo-facet-search"),this.magnifier=this.buildMagnifierIcon(),this.search.appendChild(this.magnifier),this.wait=this.buildWaitIcon(),this.search.appendChild(this.wait),this.hideFacetSearchWaitingAnimation(),this.clear=o.$$("div",{className:"coveo-facet-search-clear",title:s.l("Clear",s.l("Search"))},r.SVGIcons.icons.checkboxHookExclusionMore).el,a.SVGDom.addClassToSVGInContainer(this.clear,"coveo-facet-search-clear-svg"),this.clear.style.display="none",this.search.appendChild(this.clear);var n=document.createElement("div");return o.$$(n).addClass("coveo-facet-search-middle"),this.search.appendChild(n),this.input=this.buildInputElement(),i.Component.pointElementsToDummyForm(this.input),n.appendChild(this.input),o.$$(this.input).on("keyup",function(e){t.facetSearchUserInputHandler.handleKeyboardEvent(e)}),o.$$(this.clear).on("click",function(t){e&&e()}),o.$$(this.input).on("focus",function(e){t.handleFacetSearchFocus()}),this.detectSearchBarAnimation(),this.search},e.prototype.showFacetSearchWaitingAnimation=function(){this.magnifier&&o.$$(this.magnifier).hide(),o.$$(this.wait).show()},e.prototype.getValueInInputForFacetSearch=function(){return this.input.value.trim()},e.prototype.hideFacetSearchWaitingAnimation=function(){o.$$(this.magnifier).show(),o.$$(this.wait).hide()},e.prototype.detectSearchBarAnimation=function(){var e=this;c.EventsUtils.addPrefixedEvent(this.search,"AnimationStart",function(t){"grow"==t.animationName&&(e.searchBarIsAnimating=!0)}),c.EventsUtils.addPrefixedEvent(this.search,"AnimationEnd",function(t){"grow"==t.animationName&&(e.searchBarIsAnimating=!1)})},e.prototype.positionSearchResults=function(t,n,r){var a=this;if(null!=this.searchResults){t.appendChild(this.searchResults),this.searchResults.style.display="block",this.searchResults.style.width=n-e.FACET_SEARCH_PADDING+"px","none"==o.$$(this.searchResults).css("display")&&(this.searchResults.style.display="");"none"==o.$$(this.search).css("display")||this.searchBarIsAnimating?("none"==o.$$(this.searchResults).css("display")&&(this.searchResults.style.display=""),c.EventsUtils.addPrefixedEvent(this.search,"AnimationEnd",function(){a.positionPopUp(r,t),c.EventsUtils.removePrefixedEvent(a.search,"AnimationEnd",a)})):this.positionPopUp(r,t)}},e.prototype.setAsCurrentResult=function(e){this.currentResult&&this.currentResult.removeClass("coveo-facet-search-current-result"),this.currentResult=e,e.addClass("coveo-facet-search-current-result")},e.prototype.moveCurrentResultDown=function(){var e=this.currentResult.el.nextElementSibling;e||(e=h.first(this.searchResults.children)),this.setAsCurrentResult(o.$$(e)),this.highlightAndShowCurrentResultWithKeyboard()},e.prototype.moveCurrentResultUp=function(){var e=this.currentResult.el.previousElementSibling;e||(e=h.last(this.searchResults.children)),this.setAsCurrentResult(o.$$(e)),this.highlightAndShowCurrentResultWithKeyboard()},e.prototype.highlightCurrentQueryInSearchResults=function(e){this.facetSearch.getCaptions().forEach(function(t){t.innerHTML=o.$$(t).text().replace(e,'<span class="coveo-highlight">$1</span>')})},e.prototype.appendToSearchResults=function(e){this.searchResults.appendChild(e),this.setupFacetSearchResultsEvents(e)},e.prototype.focus=function(){this.input.focus(),this.handleFacetSearchFocus()},e.prototype.highlightAndShowCurrentResultWithKeyboard=function(){this.currentResult.addClass("coveo-facet-search-current-result"),this.triggeredScroll=!0,this.searchResults.scrollTop=this.currentResult.el.offsetTop},e.prototype.handleFacetSearchFocus=function(){null==this.facetSearch.currentlyDisplayedResults&&this.facetSearch.displayNewValues()},e.prototype.setupFacetSearchResultsEvents=function(e){var t=this;o.$$(e).on("mousemove",function(){t.setAsCurrentResult(o.$$(e))});var n=!1,r=!1;o.$$(e).on("mousedown",function(){return r=!1}),o.$$(e).on("mousemove",function(){return r=!0}),o.$$(e).on("touchmove",function(){return n=!0}),o.$$(e).on("mouseup touchend",function(){n||r||setTimeout(function(){t.facetSearch.dismissSearchResults()},0),n=!1,r=!1})},e.prototype.hideSearchResultsElement=function(){o.$$(this.searchResults).hide(),o.$$(this.searchResults).remove()},e.prototype.clearSearchInput=function(){this.input&&(this.input.value="")},e.prototype.buildMagnifierIcon=function(){var e=document.createElement("div");return e.innerHTML=r.SVGIcons.icons.search,o.$$(e).addClass("coveo-facet-search-magnifier"),a.SVGDom.addClassToSVGInContainer(e,"coveo-facet-search-magnifier-svg"),this.search.appendChild(e),e},e.prototype.buildWaitIcon=function(){var e=document.createElement("div");return e.innerHTML=r.SVGIcons.icons.loading,o.$$(e).addClass("coveo-facet-search-wait-animation"),a.SVGDom.addClassToSVGInContainer(e,"coveo-facet-search-wait-animation-svg"),e},e.prototype.buildInputElement=function(){return o.$$("input",{className:"coveo-facet-search-input",type:"test",autocapitalize:"off",autocorrect:"off","aria-label":s.l("Search")}).el},e.prototype.positionPopUp=function(e,t){l.PopupUtils.positionPopup(this.searchResults,e,t,{horizontal:l.PopupHorizontalAlignment.CENTER,vertical:l.PopupVerticalAlignment.BOTTOM})},e.prototype.handleScrollEvent=function(){this.triggeredScroll?this.triggeredScroll=!1:this.facetSearchUserInputHandler.handleFacetSearchResultsScroll()},e.FACET_SEARCH_PADDING=40,e}();t.FacetSearchElement=p},366:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(492),r=n(0),a=function(){function e(e,t,n,o){this.element=e,this.categoryFacetTemplates=t,this.categoryValue=n,this.categoryFacet=o,this.children=[]}return e.prototype.clearChildren=function(){this.element.removeClass("coveo-active-category-facet-parent"),this.children.forEach(function(e){e.clear()}),this.children=[]},e.prototype.renderChildren=function(e){var t=this;r.each(e,function(e){t.renderValue(e,!0).makeSelectable()})},e.prototype.renderAsParent=function(e){return this.renderValue(e,!1)},e.prototype.renderValue=function(e,t){var n=this.categoryValue.path.concat([e.value]),r={value:e.value,count:e.numberOfResults,path:n},a=new o.CategoryValue(this.categoryValue.listRoot,r,this.categoryFacetTemplates,this.categoryFacet);return a.render(t),this.children.push(a),a},e}();t.CategoryChildrenValueRenderer=a},367:function(e,t){},371:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(28),r=function(){function e(e){this.facetSearch=e}return e.prototype.handleKeyboardEvent=function(e){switch(e.which){case o.KEYBOARD.ENTER:this.facetSearch.keyboardNavigationEnterPressed(e);break;case o.KEYBOARD.DELETE:this.facetSearch.keyboardNavigationDeletePressed&&this.facetSearch.keyboardNavigationDeletePressed(e);break;case o.KEYBOARD.ESCAPE:this.facetSearch.dismissSearchResults();break;case o.KEYBOARD.DOWN_ARROW:this.facetSearch.facetSearchElement.moveCurrentResultDown();break;case o.KEYBOARD.UP_ARROW:this.facetSearch.facetSearchElement.moveCurrentResultUp();break;default:this.facetSearch.keyboardEventDefaultHandler()}},e.prototype.handleFacetSearchResultsScroll=function(){if(!this.facetSearch.facetSearchPromise&&""==this.facetSearch.facetSearchElement.getValueInInputForFacetSearch()&&this.facetSearch.moreValuesToFetch){var e=this.facetSearch.facetSearchElement.searchResults.clientHeight;this.facetSearch.facetSearchElement.searchResults.scrollHeight-(this.facetSearch.facetSearchElement.searchResults.scrollTop+e)<e/2&&this.facetSearch.fetchMoreValues()}},e}();t.FacetSearchUserInputHandler=r},490:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(13),a=n(14),i=n(0),s=n(7),c=function(){function e(){this.listRoot=o.$$("ul",{className:"coveo-category-facet-values"}),this.collapseArrow=o.$$("span",{className:"coveo-category-facet-collapse-children"},r.SVGIcons.icons.arrowDown),a.SVGDom.addClassToSVGInContainer(this.collapseArrow.el,"coveo-category-facet-collapse-children-svg")}return e.prototype.buildListRoot=function(){return this.listRoot.clone(!0)},e.prototype.buildListElement=function(e){var t=o.$$("div",{},this.createListElement(e));return o.$$(t.el.firstChild)},e.prototype.buildAllCategoriesButton=function(){var e=o.$$("span",{className:"coveo-category-facet-all-categories-caption"},s.l("AllCategories"));return o.$$("li",{className:"coveo-category-facet-value coveo-category-facet-all-categories"},this.buildCollapseArrow(),e)},e.prototype.buildEllipsis=function(){var e=o.$$("span",{className:"coveo-category-facet-ellipsis-caption"},"[ ... ]");return o.$$("li",{className:"coveo-category-facet-ellipsis"},e)},e.prototype.buildCollapseArrow=function(){return this.collapseArrow.clone(!0)},e.prototype.createListElement=function(e){return'<li class="coveo-category-facet-value">\n        <label class="coveo-category-facet-value-label">\n          <span title="'+i.escape(e.value)+'" class="coveo-category-facet-value-caption">'+i.escape(e.value)+'</span>\n          <span class="coveo-category-facet-value-count">'+e.count+"</span>\n        </label>\n      </li>"},e}();t.CategoryFacetTemplates=c},491:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(366),r=function(){function e(e,t,n){this.element=e,this.path=[],this.categoryChildrenValueRenderer=new o.CategoryChildrenValueRenderer(e,t,this,n),this.listRoot=t.buildListRoot(),this.appendListRoot()}return e.prototype.renderChildren=function(e){this.appendListRoot(),this.categoryChildrenValueRenderer.renderChildren(e)},e.prototype.renderAsParent=function(e){return this.appendListRoot(),this.categoryChildrenValueRenderer.renderAsParent(e)},Object.defineProperty(e.prototype,"children",{get:function(){return this.categoryChildrenValueRenderer.children},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.listRoot.detach(),this.listRoot.empty(),this.categoryChildrenValueRenderer.clearChildren()},e.prototype.appendListRoot=function(){this.element.append(this.listRoot.el)},e}();t.CategoryValueRoot=r},492:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(366),a=n(9),i=n(18),s=n(7),c=function(){function e(e,t,n,o){this.listRoot=e,this.categoryValueDescriptor=t,this.categoryFacetTemplates=n,this.categoryFacet=o,this.isActive=!1,this.element=this.categoryFacetTemplates.buildListElement({value:this.categoryValueDescriptor.value,count:this.categoryValueDescriptor.count}),this.collapseArrow=this.categoryFacetTemplates.buildCollapseArrow(),this.categoryChildrenValueRenderer=new r.CategoryChildrenValueRenderer(this.element,n,this,this.categoryFacet),this.path=this.categoryValueDescriptor.path}return e.prototype.render=function(e){this.pastMaximumDepth()&&this.element.addClass("coveo-category-facet-last-value"),e?this.element.addClass("coveo-category-facet-child-value"):this.element.addClass("coveo-category-facet-parent-value"),this.listRoot.append(this.element.el)},e.prototype.getDescriptor=function(){return{value:this.categoryValueDescriptor.value,count:this.categoryValueDescriptor.count,path:this.path}},e.prototype.clear=function(){this.element.detach(),this.categoryChildrenValueRenderer.clearChildren()},e.prototype.renderChildren=function(e){this.isActive=!0,this.element.addClass("coveo-active-category-facet-parent"),this.categoryChildrenValueRenderer.renderChildren(e)},e.prototype.renderAsParent=function(e){return this.categoryChildrenValueRenderer.renderAsParent(e)},Object.defineProperty(e.prototype,"children",{get:function(){return this.categoryChildrenValueRenderer.children},enumerable:!0,configurable:!0}),e.prototype.makeSelectable=function(){var e=this;return this.label=o.$$(this.element.find(".coveo-category-facet-value-label")),this.label.addClass("coveo-selectable"),(new i.AccessibleButton).withElement(this.label).withSelectAction(function(){return e.onSelect()}).withLabel(s.l(this.categoryValueDescriptor.value)+" "+this.categoryValueDescriptor.count).build(),this},e.prototype.showCollapseArrow=function(){if(!this.collapseArrow.el.parentElement){var e=this.element.find("label");o.$$(e).prepend(this.collapseArrow.el)}return this},e.prototype.onSelect=function(){this.pastMaximumDepth()||(this.categoryFacet.logAnalyticsEvent(a.analyticsActionCauseList.categoryFacetSelect,this.path),this.categoryFacet.changeActivePath(this.path),this.categoryFacet.executeQuery())},e.prototype.pastMaximumDepth=function(){return this.path.length-this.categoryFacet.options.basePath.length>=this.categoryFacet.options.maximumDepth},e}();t.CategoryValue=c},493:function(e,t,n){"use strict";var o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,s)}c((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,a&&(i=a[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(a,n[1])).done)return i;switch(a=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(i=c.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){c.label=n[1];break}if(6===n[0]&&c.label<i[1]){c.label=i[1],i=n;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(n);break}i[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,a,i,s,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i=n(328),s=n(4),c=function(){function e(e){this.categoryFacet=e}return e.prototype.putCategoryFacetInQueryBuilder=function(e,t,n){var o=e.categoryFacets.length;0!=t.length&&e.advancedExpression.addFieldExpression(this.categoryFacet.options.field,"==",[t.join(this.categoryFacet.options.delimitingCharacter)]);var r={field:this.categoryFacet.options.field,path:t,injectionDepth:this.categoryFacet.options.injectionDepth,maximumNumberOfValues:n,delimitingCharacter:this.categoryFacet.options.delimitingCharacter};return e.categoryFacets.push(r),o},e.prototype.searchFacetValues=function(e,t){return r(this,void 0,void 0,function(){var n,r,s,c;return a(this,function(a){switch(a.label){case 0:return n=o({},this.categoryFacet.queryController.getLastQuery()),r={allowedValues:["*"+e+"*"],allowedValuesPatternType:i.AllowedValuesPatternType.Wildcards,maximumNumberOfValues:t,field:this.categoryFacet.options.field,sortCriteria:"occurrences",injectionDepth:this.categoryFacet.options.injectionDepth},n.groupBy=[r],n.categoryFacets.splice(this.categoryFacet.positionInQuery,1),[4,this.categoryFacet.queryController.getEndpoint().search(n)];case 1:return s=a.sent(),c=function(e,t){return e.numberOfResults==t.numberOfResults?e.value.length-t.value.length:t.numberOfResults-e.numberOfResults},[2,s.groupByResults[0].values.sort(c)]}})})},e.prototype.addDebugGroupBy=function(e,t){e.groupByRequests.push({field:this.categoryFacet.options.field,allowedValues:[".*"+s.Utils.escapeRegexCharacter(t)+".*"],allowedValuesPatternType:i.AllowedValuesPatternType.Regex})},e}();t.CategoryFacetQueryController=c},494:function(e,t){},495:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,s)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,a&&(i=a[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(a,n[1])).done)return i;switch(a=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(i=c.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){c.label=n[1];break}if(6===n[0]&&c.label<i[1]){c.label=i[1],i=n;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(n);break}i[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,a,i,s,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a=n(331),i=n(0),s=n(1),c=n(14),l=n(13),u=n(7);n(496);var h=n(19),p=n(9),d=n(18),f=function(){function e(e){var t=this;this.categoryFacet=e,this.moreValuesToFetch=!0,this.facetSearchElement=new a.FacetSearchElement(this),this.displayNewValues=i.debounce(this.getDisplayNewValuesFunction(),this.categoryFacet.options.facetSearchDelay),this.categoryFacet.root.addEventListener("click",function(e){return t.handleClickElsewhere(e)}),this.numberOfValuesToFetch=this.categoryFacet.options.numberOfResultsInFacetSearch}return e.prototype.build=function(){var e=this;this.container=s.$$("div",{className:"coveo-category-facet-search-container",role:"heading","aria-level":3}),(new d.AccessibleButton).withElement(this.container).withSelectAction(function(){s.$$(e.categoryFacet.element).addClass("coveo-category-facet-searching"),e.focus()}).withLabel(u.l("Search")).build();var t=this.facetSearchElement.build(),n=this.buildfacetSearchPlaceholder();return this.container.append(t),this.container.append(n.el),this.container},e.prototype.focus=function(){this.facetSearchElement.focus()},e.prototype.clear=function(){this.dismissSearchResults(),this.container&&this.container.detach()},e.prototype.dismissSearchResults=function(){this.removeNoResultsCssClasses(),s.$$(this.categoryFacet.element).removeClass("coveo-category-facet-searching"),s.$$(this.facetSearchElement.searchResults).empty(),this.facetSearchElement.clearSearchInput(),this.facetSearchElement.hideSearchResultsElement(),this.currentlyDisplayedResults=null,this.numberOfValuesToFetch=this.categoryFacet.options.numberOfResultsInFacetSearch,this.moreValuesToFetch=!0},e.prototype.keyboardEventDefaultHandler=function(){this.moreValuesToFetch=!0,this.displayNewValues()},e.prototype.keyboardNavigationEnterPressed=function(){this.selectCurrentResult()},e.prototype.fetchMoreValues=function(){this.numberOfValuesToFetch+=this.categoryFacet.options.numberOfResultsInFacetSearch,this.displayNewValues()},e.prototype.getCaptions=function(){var e=s.$$(this.facetSearchElement.searchResults);return e.findAll(".coveo-category-facet-search-value-caption").concat(e.findAll(".coveo-category-facet-search-path-parents")).concat(e.findAll(".coveo-category-facet-search-path-last-value"))},e.prototype.selectCurrentResult=function(){if(this.facetSearchElement.currentResult){var e=this.facetSearchElement.currentResult.el.dataset.path,t=this.categoryFacet.options.delimitingCharacter,n=e.split(t);this.categoryFacet.changeActivePath(n),this.categoryFacet.logAnalyticsEvent(p.analyticsActionCauseList.categoryFacetSelect,n),this.categoryFacet.executeQuery()}},e.prototype.handleClickElsewhere=function(e){s.$$(e.target).closest(".coveo-category-facet-search-container")||this.dismissSearchResults()},e.prototype.buildfacetSearchPlaceholder=function(){var e=s.$$("div",{className:"coveo-category-facet-search-placeholder"}),t=s.$$("div",{className:"coveo-category-facet-search-icon"},l.SVGIcons.icons.checkboxHookExclusionMore);c.SVGDom.addClassToSVGInContainer(t.el,"coveo-category-facet-search-icon-svg");var n=s.$$("span",{className:"coveo-category-facet-search-label"},u.l("Search"));return e.append(t.el),e.append(n.el),e},e.prototype.getDisplayNewValuesFunction=function(){var e=this;return function(){return o(e,void 0,void 0,function(){var e;return r(this,function(t){switch(t.label){case 0:return this.facetSearchElement.showFacetSearchWaitingAnimation(),this.categoryFacet.logger.info("Triggering new Category Facet search"),[4,this.categoryFacet.categoryFacetQueryController.searchFacetValues(this.facetSearchElement.input.value,this.numberOfValuesToFetch)];case 1:return e=t.sent(),(this.logAnalyticsEvent(),e.length<this.numberOfValuesToFetch&&(this.moreValuesToFetch=!1),0==e.length)?(this.noFacetSearchResults(),[2]):(this.removeNoResultsCssClasses(),this.setFacetSearchResults(e),this.shouldPositionSearchResults&&this.facetSearchElement.positionSearchResults(this.categoryFacet.root,this.categoryFacet.element.clientWidth,this.facetSearchElement.search),this.facetSearchElement.hideFacetSearchWaitingAnimation(),[2])}})})}},e.prototype.setFacetSearchResults=function(e){s.$$(this.facetSearchElement.searchResults).empty(),this.currentlyDisplayedResults=i.pluck(e,"value");for(var t=0;t<e.length;t++){var n=this.buildFacetSearchValue(e[t]);0==t&&this.facetSearchElement.setAsCurrentResult(n),this.facetSearchElement.appendToSearchResults(n.el)}this.highlightCurrentQueryWithinSearchResults()},e.prototype.buildFacetSearchValue=function(e){var t=this,n=e.value.split(this.categoryFacet.options.delimitingCharacter),o=0!=n.slice(0,-1).length?n.slice(0,-1).join("/")+"/":"",r=s.$$("span",{className:"coveo-category-facet-search-value-caption"},i.last(n)),a=s.$$("span",{className:"coveo-category-facet-search-value-number"},e.numberOfResults.toString(10)),c=s.$$("span",{className:"coveo-category-facet-search-path-parents"},o),l=s.$$("span",{className:"coveo-category-facet-search-path"},c),h=s.$$("div",{className:"coveo-category-facet-search-first-row"},r,a),f=s.$$("div",{className:"coveo-category-facet-search-second-row"},l),y=s.$$("li",{className:"coveo-category-facet-search-value",title:n},h,f);return y.el.dataset.path=e.value,(new d.AccessibleButton).withElement(y).withSelectAction(function(){t.categoryFacet.changeActivePath(n),t.categoryFacet.logAnalyticsEvent(p.analyticsActionCauseList.categoryFacetSelect,n),t.categoryFacet.executeQuery()}).withLabel(u.l(i.last(n))+" "+e.numberOfResults).build(),y},e.prototype.noFacetSearchResults=function(){this.facetSearchElement.hideFacetSearchWaitingAnimation(),this.facetSearchElement.hideSearchResultsElement(),s.$$(this.facetSearchElement.search).addClass("coveo-facet-search-no-results"),s.$$(this.categoryFacet.element).addClass("coveo-no-results")},e.prototype.removeNoResultsCssClasses=function(){this.facetSearchElement.search&&s.$$(this.facetSearchElement.search).removeClass("coveo-facet-search-no-results"),s.$$(this.categoryFacet.element).removeClass("coveo-no-results")},e.prototype.highlightCurrentQueryWithinSearchResults=function(){var e=new RegExp("("+h.StringUtils.stringToRegex(this.facetSearchElement.input.value,!0)+")","ig");this.facetSearchElement.highlightCurrentQueryInSearchResults(e)},e.prototype.logAnalyticsEvent=function(){this.categoryFacet.usageAnalytics.logCustomEvent(p.analyticsActionCauseList.categoryFacetSearch,{categoryFacetId:this.categoryFacet.options.id,categoryFacetTitle:this.categoryFacet.options.title},this.categoryFacet.root)},Object.defineProperty(e.prototype,"shouldPositionSearchResults",{get:function(){var e=this.facetSearchElement.searchResults;return e&&!e.parentElement},enumerable:!0,configurable:!0}),e}();t.CategoryFacetSearch=f},496:function(e,t){},497:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(14),a=n(13),i=function(){function e(e,t,n){this.categoryFacetTitle=e,this.onClickHandler=t,this.categoryValueDescriptor=n}return e.prototype.build=function(){var e=o.$$("span",{className:"coveo-facet-breadcrumb-clear"},a.SVGIcons.icons.checkboxHookExclusionMore);r.SVGDom.addClassToSVGInContainer(e.el,"coveo-facet-breadcrumb-clear-svg");var t=this.categoryValueDescriptor.value+" "+this.categoryValueDescriptor.count,n=o.$$("span",{className:"coveo-category-facet-breadcrumb-title"},this.categoryFacetTitle+": "),i=o.$$("span",{className:"coveo-category-facet-breadcrumb-values"},this.categoryValueDescriptor.path.join("/"),e),s=o.$$("span",{className:"coveo-category-facet-breadcrumb",title:t},n,i);return s.on("click",this.onClickHandler),s.el},e}();t.CategoryFacetBreadcrumb=i},498:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(145),r=n(10),a=n(0),i=n(11),s=(function(){function e(){}}(),function(){function e(e){var t=this;this.categoryFacet=e,this.categoryFacet.bind.onRootElement(r.QueryEvents.buildingQuery,function(e){return t.handleBuildingQuery(e)}),this.categoryFacet.bind.onRootElement(r.QueryEvents.querySuccess,function(e){t.handleQuerySuccess(e)})}return e.prototype.handleBuildingQuery=function(e){var t=e.queryBuilder.groupByRequests.length;if(0==this.categoryFacet.activePath.length)this.positionInQuery={start:t,end:t+1},this.addGroupByForEmptyPath(e.queryBuilder);else{var n=this.categoryFacet.activePath;this.positionInQuery={start:t,end:t+n.length},this.addGroupByForEachPathElement(e.queryBuilder,n)}},e.prototype.handleQuerySuccess=function(t){var n=this;t.results.groupByResults.slice(this.positionInQuery.start,this.positionInQuery.end).forEach(function(t){return e.analyzeResults(t,n.categoryFacet.options.delimitingCharacter)})},e.prototype.addGroupByForEmptyPath=function(e){e.groupByRequests.push({field:this.categoryFacet.options.field,injectionDepth:this.categoryFacet.options.injectionDepth})},e.prototype.addGroupByForEachPathElement=function(e,t){var n=this;t.forEach(function(t){n.categoryFacet.categoryFacetQueryController.addDebugGroupBy(e,t)})},e.analyzeResults=function(e,t){var n=this,o=new Map,r=[],i=this.buildPathsFromGroupByValues(e.values,t);return i=a.sortBy(i,function(e){return e.length}),i.forEach(function(e){if(1==e.length)n.addFirstNodeToTree(o,e);else{for(var a=!0,i=e.slice(0,-1),s=o,c=0,l=i;c<l.length;c++){var u=l[c];if(!(s=s.get(u))){n.processOrphan(r,e,t),a=!1;break}}a&&n.addValidNodeToTree(s,e)}}),r},e.buildPathsFromGroupByValues=function(e,t){return a.chain(e).pluck("value").map(function(e){return e.split(t)}).sortBy(function(e){return e.length}).value()},e.addFirstNodeToTree=function(e,t){e.set(t[0],new Map)},e.addValidNodeToTree=function(e,t){e.set(t.slice(-1)[0],new Map)},e.processOrphan=function(e,t,n){var o=t.join(n);e.push(o),this.logger.error("Value "+o+" has no parent.")},e.logger=new i.Logger(o.CategoryFacet),e}());t.CategoryFacetDebug=s}});
{"version":3,"sources":["SmartSnippetSuggestions.min__5f3280c404a1ee75a113.js","./src/ui/SmartSnippet/SmartSnippetSuggestions.ts","./src/misc/AttachShadowPolyfill.ts","./src/ui/SmartSnippet/SmartSnippetCollapsibleSuggestion.ts"],"names":["webpackJsonpCoveo__temporary","296","module","exports","__webpack_require__","__extends","this","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","value","QUESTIONS_LIST_TITLE_CLASSNAME","QUESTIONS_LIST_CLASSNAME","SmartSnippetSuggestionsClassNames","HAS_QUESTIONS_CLASSNAME","BASE_CLASSNAME","element","options","bindings","SmartSnippetSuggestions","ID","titleId","uniqueId","bind","onRootElement","QueryEvents","deferredQuerySuccess","data","handleQuerySuccess","_this","get","contentLoaded","enumerable","configurable","getCorrespondingResult","questionAnswer","find","queryController","getLastResults","results","result","raw","documentId","contentIdKey","contentIdValue","hasQuestions","relatedQuestions","length","$$","toggleClass","renderedQuestionAnswer","isEqual","detachContent","appendChild","title","buildTitle","el","questionAnswers","buildQuestionAnswers","detach","className","id","l","innerCSS","getInnerCSS","answers","map","SmartSnippetCollapsibleSuggestion","container","ariaLabelledby","answer","build","Promise","all","loading","children","filter","HTMLScriptElement","type","toLowerCase","innerHTML","join","doExport","exportGlobally","Component","Initialization","registerAutoCreateComponent","517","init","__awaiter","iframe","onLoad","iframeBody","shadowRoot","__generator","_a","label","scrolling","resolve","addEventListener","contentDocument","body","style","margin","autoUpdateHeight","mode","elementToResize","content","MutationObserver","height","clientHeight","observe","attributes","characterData","childList","subtree","thisArg","_arguments","P","generator","reject","fulfilled","step","next","e","rejected","done","then","apply","verb","n","v","op","f","TypeError","_","y","t","call","ops","pop","trys","push","g","sent","throw","return","Symbol","iterator","582","702","703","QUESTION_CLASSNAME","QUESTION_TITLE_CLASSNAME","QUESTION_TITLE_LABEL_CLASSNAME","QUESTION_TITLE_CHECKBOX_CLASSNAME","QUESTION_SNIPPET_CLASSNAME","QUESTION_SNIPPET_HIDDEN_CLASSNAME","SHADOW_CLASSNAME","RAW_CONTENT_CLASSNAME","SOURCE_CLASSNAME","SmartSnippetCollapsibleSuggestionClassNames","SOURCE_TITLE_CLASSNAME","SOURCE_URL_CLASSNAME","source","labelId","snippetId","checkboxId","expanded","collapsibleContainer","buildCollapsibleContainer","answerSnippet","question","buildStyle","updateExpanded","styleTag","document","createElement","checkbox","buildCheckbox","text","on","toggle","role","tabindex","ariaControls","AccessibleButton","withElement","withLabel","withEnterKeyboardAction","shadowContainer","attachShadow","buildAnswerSnippetContent","append","buildSourceUrl","clickUri","buildSourceTitle","snippet","buildLink","url","href","innerText","setAttribute","toString","setHtml","SVGIcons","icons","arrowUp","arrowDown"],"mappings":"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","file":"SmartSnippetSuggestions.min__5f3280c404a1ee75a113.js","sourcesContent":["webpackJsonpCoveo__temporary([28],{\n\n/***/ 296:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n__webpack_require__(702);\r\nvar Component_1 = __webpack_require__(7);\r\nvar GlobalExports_1 = __webpack_require__(3);\r\nvar QueryEvents_1 = __webpack_require__(11);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar underscore_1 = __webpack_require__(0);\r\nvar SmartSnippetCollapsibleSuggestion_1 = __webpack_require__(703);\r\nvar Strings_1 = __webpack_require__(6);\r\nvar Initialization_1 = __webpack_require__(2);\r\nvar BASE_CLASSNAME = 'coveo-smart-snippet-suggestions';\r\nvar HAS_QUESTIONS_CLASSNAME = BASE_CLASSNAME + \"-has-questions\";\r\nvar QUESTIONS_LIST_CLASSNAME = BASE_CLASSNAME + \"-questions\";\r\nvar QUESTIONS_LIST_TITLE_CLASSNAME = QUESTIONS_LIST_CLASSNAME + \"-title\";\r\nexports.SmartSnippetSuggestionsClassNames = {\r\n    HAS_QUESTIONS_CLASSNAME: HAS_QUESTIONS_CLASSNAME,\r\n    QUESTIONS_LIST_CLASSNAME: QUESTIONS_LIST_CLASSNAME,\r\n    QUESTIONS_LIST_TITLE_CLASSNAME: QUESTIONS_LIST_TITLE_CLASSNAME\r\n};\r\nvar SmartSnippetSuggestions = /** @class */ (function (_super) {\r\n    __extends(SmartSnippetSuggestions, _super);\r\n    function SmartSnippetSuggestions(element, options, bindings) {\r\n        var _this = _super.call(this, element, SmartSnippetSuggestions.ID, bindings) || this;\r\n        _this.element = element;\r\n        _this.options = options;\r\n        _this.titleId = underscore_1.uniqueId(QUESTIONS_LIST_TITLE_CLASSNAME);\r\n        _this.bind.onRootElement(QueryEvents_1.QueryEvents.deferredQuerySuccess, function (data) { return _this.handleQuerySuccess(data); });\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SmartSnippetSuggestions.prototype, \"loading\", {\r\n        get: function () {\r\n            return this.contentLoaded;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * @warning This method only works for the demo. In practice, the source of the answer will not always be part of the results.\r\n     */\r\n    SmartSnippetSuggestions.prototype.getCorrespondingResult = function (questionAnswer) {\r\n        return underscore_1.find(this.queryController.getLastResults().results, function (result) { return result.raw[questionAnswer.documentId.contentIdKey] === questionAnswer.documentId.contentIdValue; });\r\n    };\r\n    SmartSnippetSuggestions.prototype.handleQuerySuccess = function (data) {\r\n        var questionAnswer = data.results.questionAnswer;\r\n        var hasQuestions = !!(questionAnswer && questionAnswer.relatedQuestions.length);\r\n        Dom_1.$$(this.element).toggleClass(HAS_QUESTIONS_CLASSNAME, hasQuestions);\r\n        if (hasQuestions) {\r\n            if (this.renderedQuestionAnswer && underscore_1.isEqual(questionAnswer, this.renderedQuestionAnswer)) {\r\n                return;\r\n            }\r\n            this.detachContent();\r\n            this.element.appendChild((this.title = this.buildTitle()).el);\r\n            this.element.appendChild((this.questionAnswers = this.buildQuestionAnswers(questionAnswer.relatedQuestions)).el);\r\n        }\r\n        else {\r\n            this.detachContent();\r\n        }\r\n        this.renderedQuestionAnswer = questionAnswer;\r\n    };\r\n    SmartSnippetSuggestions.prototype.detachContent = function () {\r\n        this.title && this.title.detach();\r\n        this.questionAnswers && this.questionAnswers.detach();\r\n        this.title = this.questionAnswers = null;\r\n    };\r\n    SmartSnippetSuggestions.prototype.buildTitle = function () {\r\n        return Dom_1.$$('span', { className: QUESTIONS_LIST_TITLE_CLASSNAME, id: this.titleId }, Strings_1.l('SuggestedQuestions'));\r\n    };\r\n    SmartSnippetSuggestions.prototype.buildQuestionAnswers = function (questionAnswers) {\r\n        var _this = this;\r\n        var innerCSS = this.getInnerCSS();\r\n        var answers = questionAnswers.map(function (questionAnswer) { return new SmartSnippetCollapsibleSuggestion_1.SmartSnippetCollapsibleSuggestion(questionAnswer, innerCSS, _this.getCorrespondingResult(questionAnswer)); });\r\n        var container = Dom_1.$$.apply(void 0, ['ul',\r\n            { className: QUESTIONS_LIST_CLASSNAME, ariaLabelledby: this.titleId }].concat(answers.map(function (answer) { return answer.build(); })));\r\n        this.contentLoaded = Promise.all(answers.map(function (answer) { return answer.loading; }));\r\n        return container;\r\n    };\r\n    SmartSnippetSuggestions.prototype.getInnerCSS = function () {\r\n        return Dom_1.$$(this.element)\r\n            .children()\r\n            .filter(function (element) { return element instanceof HTMLScriptElement && element.type.toLowerCase() === 'text/css'; })\r\n            .map(function (element) { return element.innerHTML; })\r\n            .join('\\n');\r\n    };\r\n    SmartSnippetSuggestions.ID = 'SmartSnippetSuggestions';\r\n    SmartSnippetSuggestions.doExport = function () {\r\n        GlobalExports_1.exportGlobally({\r\n            SmartSnippetSuggestions: SmartSnippetSuggestions\r\n        });\r\n    };\r\n    return SmartSnippetSuggestions;\r\n}(Component_1.Component));\r\nexports.SmartSnippetSuggestions = SmartSnippetSuggestions;\r\nInitialization_1.Initialization.registerAutoCreateComponent(SmartSnippetSuggestions);\r\nSmartSnippetSuggestions.doExport();\r\n\n\n/***/ }),\n\n/***/ 517:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Dom_1 = __webpack_require__(1);\r\n__webpack_require__(582);\r\nfunction attachShadow(element, init) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var iframe, onLoad, iframeBody, shadowRoot;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    iframe = Dom_1.$$('iframe', { className: 'coveo-shadow-iframe', scrolling: 'no', title: init.title }).el;\r\n                    onLoad = new Promise(function (resolve) { return iframe.addEventListener('load', function () { return resolve(); }); });\r\n                    element.appendChild(iframe);\r\n                    return [4 /*yield*/, onLoad];\r\n                case 1:\r\n                    _a.sent();\r\n                    iframeBody = iframe.contentDocument.body;\r\n                    iframeBody.style.margin = '0';\r\n                    shadowRoot = Dom_1.$$('div', { style: 'overflow: auto;' }).el;\r\n                    iframeBody.appendChild(shadowRoot);\r\n                    autoUpdateHeight(iframe, shadowRoot);\r\n                    if (init.mode === 'open') {\r\n                        Object.defineProperty(element, 'shadowRoot', { get: function () { return shadowRoot; } });\r\n                    }\r\n                    return [2 /*return*/, shadowRoot];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.attachShadow = attachShadow;\r\nfunction autoUpdateHeight(elementToResize, content) {\r\n    var heightObserver = new MutationObserver(function () {\r\n        elementToResize.style.height = content.clientHeight + \"px\";\r\n    });\r\n    heightObserver.observe(content, {\r\n        attributes: true,\r\n        characterData: true,\r\n        childList: true,\r\n        subtree: true\r\n    });\r\n}\r\n\n\n/***/ }),\n\n/***/ 582:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 702:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 703:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar underscore_1 = __webpack_require__(0);\r\nvar AccessibleButton_1 = __webpack_require__(15);\r\nvar SVGIcons_1 = __webpack_require__(12);\r\nvar AttachShadowPolyfill_1 = __webpack_require__(517);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar Strings_1 = __webpack_require__(6);\r\nvar QUESTION_CLASSNAME = \"coveo-smart-snippet-suggestions-question\";\r\nvar QUESTION_TITLE_CLASSNAME = QUESTION_CLASSNAME + \"-title\";\r\nvar QUESTION_TITLE_LABEL_CLASSNAME = QUESTION_TITLE_CLASSNAME + \"-label\";\r\nvar QUESTION_TITLE_CHECKBOX_CLASSNAME = QUESTION_TITLE_CLASSNAME + \"-checkbox\";\r\nvar QUESTION_SNIPPET_CLASSNAME = QUESTION_CLASSNAME + \"-snippet\";\r\nvar QUESTION_SNIPPET_HIDDEN_CLASSNAME = QUESTION_SNIPPET_CLASSNAME + \"-hidden\";\r\nvar SHADOW_CLASSNAME = QUESTION_SNIPPET_CLASSNAME + \"-content\";\r\nvar RAW_CONTENT_CLASSNAME = SHADOW_CLASSNAME + \"-raw\";\r\nvar SOURCE_CLASSNAME = QUESTION_CLASSNAME + \"-source\";\r\nvar SOURCE_TITLE_CLASSNAME = SOURCE_CLASSNAME + \"-title\";\r\nvar SOURCE_URL_CLASSNAME = SOURCE_CLASSNAME + \"-url\";\r\nexports.SmartSnippetCollapsibleSuggestionClassNames = {\r\n    QUESTION_CLASSNAME: QUESTION_CLASSNAME,\r\n    QUESTION_TITLE_CLASSNAME: QUESTION_TITLE_CLASSNAME,\r\n    QUESTION_TITLE_LABEL_CLASSNAME: QUESTION_TITLE_LABEL_CLASSNAME,\r\n    QUESTION_TITLE_CHECKBOX_CLASSNAME: QUESTION_TITLE_CHECKBOX_CLASSNAME,\r\n    QUESTION_SNIPPET_CLASSNAME: QUESTION_SNIPPET_CLASSNAME,\r\n    QUESTION_SNIPPET_HIDDEN_CLASSNAME: QUESTION_SNIPPET_HIDDEN_CLASSNAME,\r\n    SHADOW_CLASSNAME: SHADOW_CLASSNAME,\r\n    RAW_CONTENT_CLASSNAME: RAW_CONTENT_CLASSNAME,\r\n    SOURCE_CLASSNAME: SOURCE_CLASSNAME,\r\n    SOURCE_TITLE_CLASSNAME: SOURCE_TITLE_CLASSNAME,\r\n    SOURCE_URL_CLASSNAME: SOURCE_URL_CLASSNAME\r\n};\r\nvar SmartSnippetCollapsibleSuggestion = /** @class */ (function () {\r\n    function SmartSnippetCollapsibleSuggestion(questionAnswer, innerCSS, source) {\r\n        this.questionAnswer = questionAnswer;\r\n        this.innerCSS = innerCSS;\r\n        this.source = source;\r\n        this.labelId = underscore_1.uniqueId(QUESTION_TITLE_LABEL_CLASSNAME);\r\n        this.snippetId = underscore_1.uniqueId(QUESTION_SNIPPET_CLASSNAME);\r\n        this.checkboxId = underscore_1.uniqueId(QUESTION_TITLE_CHECKBOX_CLASSNAME);\r\n        this.expanded = false;\r\n    }\r\n    Object.defineProperty(SmartSnippetCollapsibleSuggestion.prototype, \"loading\", {\r\n        get: function () {\r\n            return this.contentLoaded;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SmartSnippetCollapsibleSuggestion.prototype.build = function () {\r\n        var collapsibleContainer = this.buildCollapsibleContainer(this.questionAnswer.answerSnippet, this.questionAnswer.question, this.innerCSS && this.buildStyle(this.innerCSS));\r\n        var title = this.buildTitle(this.questionAnswer.question);\r\n        this.updateExpanded();\r\n        return Dom_1.$$('li', {\r\n            className: QUESTION_CLASSNAME,\r\n            ariaLabelledby: this.labelId\r\n        }, title, collapsibleContainer).el;\r\n    };\r\n    SmartSnippetCollapsibleSuggestion.prototype.buildStyle = function (innerCSS) {\r\n        var styleTag = document.createElement('style');\r\n        styleTag.innerHTML = innerCSS;\r\n        return styleTag;\r\n    };\r\n    SmartSnippetCollapsibleSuggestion.prototype.buildTitle = function (question) {\r\n        var _this = this;\r\n        var checkbox = this.buildCheckbox(question);\r\n        var label = Dom_1.$$('span', { className: QUESTION_TITLE_LABEL_CLASSNAME, id: this.labelId });\r\n        label.text(question);\r\n        var title = Dom_1.$$('span', { className: QUESTION_TITLE_CLASSNAME }, label, checkbox);\r\n        title.on('click', function () { return _this.toggle(); });\r\n        return title;\r\n    };\r\n    SmartSnippetCollapsibleSuggestion.prototype.buildCheckbox = function (question) {\r\n        var _this = this;\r\n        this.checkbox = Dom_1.$$('div', {\r\n            role: 'button',\r\n            tabindex: 0,\r\n            ariaControls: this.snippetId,\r\n            className: QUESTION_TITLE_CHECKBOX_CLASSNAME,\r\n            id: this.checkboxId\r\n        });\r\n        new AccessibleButton_1.AccessibleButton()\r\n            .withElement(this.checkbox)\r\n            .withLabel(Strings_1.l('ExpandQuestionAnswer', question))\r\n            .withEnterKeyboardAction(function () { return _this.toggle(); })\r\n            .build();\r\n        return this.checkbox;\r\n    };\r\n    SmartSnippetCollapsibleSuggestion.prototype.buildCollapsibleContainer = function (innerHTML, title, style) {\r\n        var _this = this;\r\n        var shadowContainer = Dom_1.$$('div', { className: SHADOW_CLASSNAME });\r\n        this.collapsibleContainer = Dom_1.$$('div', { className: QUESTION_SNIPPET_CLASSNAME, id: this.snippetId }, shadowContainer);\r\n        this.contentLoaded = AttachShadowPolyfill_1.attachShadow(shadowContainer.el, { mode: 'open', title: Strings_1.l('AnswerSpecificSnippet', title) }).then(function (shadowRoot) {\r\n            shadowRoot.appendChild(_this.buildAnswerSnippetContent(innerHTML, style).el);\r\n        });\r\n        if (this.source) {\r\n            this.collapsibleContainer.append(this.buildSourceUrl(this.source.clickUri));\r\n            this.collapsibleContainer.append(this.buildSourceTitle(this.source.title, this.source.clickUri));\r\n        }\r\n        return this.collapsibleContainer;\r\n    };\r\n    SmartSnippetCollapsibleSuggestion.prototype.buildAnswerSnippetContent = function (innerHTML, style) {\r\n        var snippet = Dom_1.$$('div', { className: RAW_CONTENT_CLASSNAME }, innerHTML);\r\n        var container = Dom_1.$$('div', {}, snippet);\r\n        if (style) {\r\n            container.append(style);\r\n        }\r\n        return container;\r\n    };\r\n    SmartSnippetCollapsibleSuggestion.prototype.buildSourceTitle = function (title, clickUri) {\r\n        return this.buildLink(title, clickUri, SOURCE_TITLE_CLASSNAME);\r\n    };\r\n    SmartSnippetCollapsibleSuggestion.prototype.buildSourceUrl = function (url) {\r\n        return this.buildLink(url, url, SOURCE_URL_CLASSNAME);\r\n    };\r\n    SmartSnippetCollapsibleSuggestion.prototype.buildLink = function (text, href, className) {\r\n        var element = Dom_1.$$('a', { className: className, href: href }).el;\r\n        element.innerText = text;\r\n        return element;\r\n    };\r\n    SmartSnippetCollapsibleSuggestion.prototype.toggle = function () {\r\n        this.expanded = !this.expanded;\r\n        this.updateExpanded();\r\n    };\r\n    SmartSnippetCollapsibleSuggestion.prototype.updateExpanded = function () {\r\n        this.checkbox.setAttribute('aria-expanded', this.expanded.toString());\r\n        this.checkbox.setHtml(this.expanded ? SVGIcons_1.SVGIcons.icons.arrowUp : SVGIcons_1.SVGIcons.icons.arrowDown);\r\n        this.collapsibleContainer.setAttribute('tabindex', \"\" + (this.expanded ? 0 : -1));\r\n        this.collapsibleContainer.setAttribute('aria-hidden', (!this.expanded).toString());\r\n        this.collapsibleContainer.toggleClass(QUESTION_SNIPPET_HIDDEN_CLASSNAME, !this.expanded);\r\n    };\r\n    return SmartSnippetCollapsibleSuggestion;\r\n}());\r\nexports.SmartSnippetCollapsibleSuggestion = SmartSnippetCollapsibleSuggestion;\r\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// SmartSnippetSuggestions.min__5f3280c404a1ee75a113.js","import 'styling/_SmartSnippetSuggestions';\r\nimport { Component } from '../Base/Component';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\nimport { QueryEvents, IQuerySuccessEventArgs } from '../../events/QueryEvents';\r\nimport { IPartialQuestionAnswerResponse, IQuestionAnswerResponse } from '../../rest/QuestionAnswerResponse';\r\nimport { $$, Dom } from '../../utils/Dom';\r\nimport { uniqueId, isEqual, find } from 'underscore';\r\nimport { SmartSnippetCollapsibleSuggestion } from './SmartSnippetCollapsibleSuggestion';\r\nimport { l } from '../../strings/Strings';\r\nimport { Initialization } from '../Base/Initialization';\r\n\r\nconst BASE_CLASSNAME = 'coveo-smart-snippet-suggestions';\r\nconst HAS_QUESTIONS_CLASSNAME = `${BASE_CLASSNAME}-has-questions`;\r\nconst QUESTIONS_LIST_CLASSNAME = `${BASE_CLASSNAME}-questions`;\r\nconst QUESTIONS_LIST_TITLE_CLASSNAME = `${QUESTIONS_LIST_CLASSNAME}-title`;\r\n\r\nexport const SmartSnippetSuggestionsClassNames = {\r\n  HAS_QUESTIONS_CLASSNAME,\r\n  QUESTIONS_LIST_CLASSNAME,\r\n  QUESTIONS_LIST_TITLE_CLASSNAME\r\n};\r\n\r\nexport class SmartSnippetSuggestions extends Component {\r\n  static ID = 'SmartSnippetSuggestions';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      SmartSnippetSuggestions\r\n    });\r\n  };\r\n\r\n  private readonly titleId = uniqueId(QUESTIONS_LIST_TITLE_CLASSNAME);\r\n  private contentLoaded: Promise<any>;\r\n  private title: Dom;\r\n  private questionAnswers: Dom;\r\n  private renderedQuestionAnswer: IQuestionAnswerResponse;\r\n\r\n  constructor(public element: HTMLElement, public options?: {}, bindings?: IComponentBindings) {\r\n    super(element, SmartSnippetSuggestions.ID, bindings);\r\n    this.bind.onRootElement(QueryEvents.deferredQuerySuccess, (data: IQuerySuccessEventArgs) => this.handleQuerySuccess(data));\r\n  }\r\n\r\n  public get loading() {\r\n    return this.contentLoaded;\r\n  }\r\n\r\n  /**\r\n   * @warning This method only works for the demo. In practice, the source of the answer will not always be part of the results.\r\n   */\r\n  private getCorrespondingResult(questionAnswer: IPartialQuestionAnswerResponse) {\r\n    return find(\r\n      this.queryController.getLastResults().results,\r\n      result => result.raw[questionAnswer.documentId.contentIdKey] === questionAnswer.documentId.contentIdValue\r\n    );\r\n  }\r\n\r\n  private handleQuerySuccess(data: IQuerySuccessEventArgs) {\r\n    const questionAnswer = data.results.questionAnswer;\r\n    const hasQuestions = !!(questionAnswer && questionAnswer.relatedQuestions.length);\r\n    $$(this.element).toggleClass(HAS_QUESTIONS_CLASSNAME, hasQuestions);\r\n    if (hasQuestions) {\r\n      if (this.renderedQuestionAnswer && isEqual(questionAnswer, this.renderedQuestionAnswer)) {\r\n        return;\r\n      }\r\n      this.detachContent();\r\n      this.element.appendChild((this.title = this.buildTitle()).el);\r\n      this.element.appendChild((this.questionAnswers = this.buildQuestionAnswers(questionAnswer.relatedQuestions)).el);\r\n    } else {\r\n      this.detachContent();\r\n    }\r\n    this.renderedQuestionAnswer = questionAnswer;\r\n  }\r\n\r\n  private detachContent() {\r\n    this.title && this.title.detach();\r\n    this.questionAnswers && this.questionAnswers.detach();\r\n    this.title = this.questionAnswers = null;\r\n  }\r\n\r\n  private buildTitle() {\r\n    return $$('span', { className: QUESTIONS_LIST_TITLE_CLASSNAME, id: this.titleId }, l('SuggestedQuestions'));\r\n  }\r\n\r\n  private buildQuestionAnswers(questionAnswers: IPartialQuestionAnswerResponse[]) {\r\n    const innerCSS = this.getInnerCSS();\r\n    const answers = questionAnswers.map(\r\n      questionAnswer => new SmartSnippetCollapsibleSuggestion(questionAnswer, innerCSS, this.getCorrespondingResult(questionAnswer))\r\n    );\r\n    const container = $$(\r\n      'ul',\r\n      { className: QUESTIONS_LIST_CLASSNAME, ariaLabelledby: this.titleId },\r\n      ...answers.map(answer => answer.build())\r\n    );\r\n    this.contentLoaded = Promise.all(answers.map(answer => answer.loading));\r\n    return container;\r\n  }\r\n\r\n  private getInnerCSS() {\r\n    return $$(this.element)\r\n      .children()\r\n      .filter(element => element instanceof HTMLScriptElement && element.type.toLowerCase() === 'text/css')\r\n      .map(element => element.innerHTML)\r\n      .join('\\n');\r\n  }\r\n}\r\n\r\nInitialization.registerAutoCreateComponent(SmartSnippetSuggestions);\r\nSmartSnippetSuggestions.doExport();\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/SmartSnippetSuggestions.ts","import { $$ } from '../utils/Dom';\r\nimport 'styling/_AttachShadowPolyfill';\r\n\r\nexport async function attachShadow(element: HTMLElement, init: ShadowRootInit & { title: string }): Promise<HTMLElement> {\r\n  const iframe = $$('iframe', { className: 'coveo-shadow-iframe', scrolling: 'no', title: init.title }).el as HTMLIFrameElement;\r\n  const onLoad = new Promise(resolve => iframe.addEventListener('load', () => resolve()));\r\n  element.appendChild(iframe);\r\n  await onLoad;\r\n\r\n  const iframeBody = iframe.contentDocument.body as HTMLBodyElement;\r\n  iframeBody.style.margin = '0';\r\n  const shadowRoot = $$('div', { style: 'overflow: auto;' }).el;\r\n  iframeBody.appendChild(shadowRoot);\r\n  autoUpdateHeight(iframe, shadowRoot);\r\n  if (init.mode === 'open') {\r\n    Object.defineProperty(element, 'shadowRoot', { get: () => shadowRoot });\r\n  }\r\n\r\n  return shadowRoot;\r\n}\r\n\r\nfunction autoUpdateHeight(elementToResize: HTMLElement, content: HTMLElement) {\r\n  const heightObserver = new MutationObserver(() => {\r\n    elementToResize.style.height = `${content.clientHeight}px`;\r\n  });\r\n  heightObserver.observe(content, {\r\n    attributes: true,\r\n    characterData: true,\r\n    childList: true,\r\n    subtree: true\r\n  });\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/misc/AttachShadowPolyfill.ts","import { IPartialQuestionAnswerResponse } from '../../rest/QuestionAnswerResponse';\r\nimport { uniqueId } from 'underscore';\r\nimport { AccessibleButton } from '../../utils/AccessibleButton';\r\nimport { SVGIcons } from '../../utils/SVGIcons';\r\nimport { attachShadow } from '../../misc/AttachShadowPolyfill';\r\nimport { $$, Dom } from '../../utils/Dom';\r\nimport { l } from '../../strings/Strings';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\n\r\nconst QUESTION_CLASSNAME = `coveo-smart-snippet-suggestions-question`;\r\nconst QUESTION_TITLE_CLASSNAME = `${QUESTION_CLASSNAME}-title`;\r\nconst QUESTION_TITLE_LABEL_CLASSNAME = `${QUESTION_TITLE_CLASSNAME}-label`;\r\nconst QUESTION_TITLE_CHECKBOX_CLASSNAME = `${QUESTION_TITLE_CLASSNAME}-checkbox`;\r\nconst QUESTION_SNIPPET_CLASSNAME = `${QUESTION_CLASSNAME}-snippet`;\r\nconst QUESTION_SNIPPET_HIDDEN_CLASSNAME = `${QUESTION_SNIPPET_CLASSNAME}-hidden`;\r\nconst SHADOW_CLASSNAME = `${QUESTION_SNIPPET_CLASSNAME}-content`;\r\nconst RAW_CONTENT_CLASSNAME = `${SHADOW_CLASSNAME}-raw`;\r\nconst SOURCE_CLASSNAME = `${QUESTION_CLASSNAME}-source`;\r\nconst SOURCE_TITLE_CLASSNAME = `${SOURCE_CLASSNAME}-title`;\r\nconst SOURCE_URL_CLASSNAME = `${SOURCE_CLASSNAME}-url`;\r\n\r\nexport const SmartSnippetCollapsibleSuggestionClassNames = {\r\n  QUESTION_CLASSNAME,\r\n  QUESTION_TITLE_CLASSNAME,\r\n  QUESTION_TITLE_LABEL_CLASSNAME,\r\n  QUESTION_TITLE_CHECKBOX_CLASSNAME,\r\n  QUESTION_SNIPPET_CLASSNAME,\r\n  QUESTION_SNIPPET_HIDDEN_CLASSNAME,\r\n  SHADOW_CLASSNAME,\r\n  RAW_CONTENT_CLASSNAME,\r\n  SOURCE_CLASSNAME,\r\n  SOURCE_TITLE_CLASSNAME,\r\n  SOURCE_URL_CLASSNAME\r\n};\r\n\r\nexport class SmartSnippetCollapsibleSuggestion {\r\n  private readonly labelId = uniqueId(QUESTION_TITLE_LABEL_CLASSNAME);\r\n  private readonly snippetId = uniqueId(QUESTION_SNIPPET_CLASSNAME);\r\n  private readonly checkboxId = uniqueId(QUESTION_TITLE_CHECKBOX_CLASSNAME);\r\n  private contentLoaded: Promise<void>;\r\n  private collapsibleContainer: Dom;\r\n  private checkbox: Dom;\r\n  private expanded = false;\r\n\r\n  constructor(\r\n    private readonly questionAnswer: IPartialQuestionAnswerResponse,\r\n    private readonly innerCSS?: string,\r\n    private readonly source?: IQueryResult\r\n  ) {}\r\n\r\n  public get loading() {\r\n    return this.contentLoaded;\r\n  }\r\n\r\n  public build() {\r\n    const collapsibleContainer = this.buildCollapsibleContainer(\r\n      this.questionAnswer.answerSnippet,\r\n      this.questionAnswer.question,\r\n      this.innerCSS && this.buildStyle(this.innerCSS)\r\n    );\r\n    const title = this.buildTitle(this.questionAnswer.question);\r\n    this.updateExpanded();\r\n    return $$(\r\n      'li',\r\n      {\r\n        className: QUESTION_CLASSNAME,\r\n        ariaLabelledby: this.labelId\r\n      },\r\n      title,\r\n      collapsibleContainer\r\n    ).el as HTMLLIElement;\r\n  }\r\n\r\n  private buildStyle(innerCSS: string) {\r\n    const styleTag = document.createElement('style');\r\n    styleTag.innerHTML = innerCSS;\r\n    return styleTag;\r\n  }\r\n\r\n  private buildTitle(question: string) {\r\n    const checkbox = this.buildCheckbox(question);\r\n    const label = $$('span', { className: QUESTION_TITLE_LABEL_CLASSNAME, id: this.labelId });\r\n    label.text(question);\r\n    const title = $$('span', { className: QUESTION_TITLE_CLASSNAME }, label, checkbox);\r\n    title.on('click', () => this.toggle());\r\n    return title;\r\n  }\r\n\r\n  private buildCheckbox(question: string) {\r\n    this.checkbox = $$('div', {\r\n      role: 'button',\r\n      tabindex: 0,\r\n      ariaControls: this.snippetId,\r\n      className: QUESTION_TITLE_CHECKBOX_CLASSNAME,\r\n      id: this.checkboxId\r\n    });\r\n    new AccessibleButton()\r\n      .withElement(this.checkbox)\r\n      .withLabel(l('ExpandQuestionAnswer', question))\r\n      .withEnterKeyboardAction(() => this.toggle())\r\n      .build();\r\n    return this.checkbox;\r\n  }\r\n\r\n  private buildCollapsibleContainer(innerHTML: string, title: string, style?: HTMLStyleElement) {\r\n    const shadowContainer = $$('div', { className: SHADOW_CLASSNAME });\r\n    this.collapsibleContainer = $$('div', { className: QUESTION_SNIPPET_CLASSNAME, id: this.snippetId }, shadowContainer);\r\n    this.contentLoaded = attachShadow(shadowContainer.el, { mode: 'open', title: l('AnswerSpecificSnippet', title) }).then(shadowRoot => {\r\n      shadowRoot.appendChild(this.buildAnswerSnippetContent(innerHTML, style).el);\r\n    });\r\n    if (this.source) {\r\n      this.collapsibleContainer.append(this.buildSourceUrl(this.source.clickUri));\r\n      this.collapsibleContainer.append(this.buildSourceTitle(this.source.title, this.source.clickUri));\r\n    }\r\n    return this.collapsibleContainer;\r\n  }\r\n\r\n  private buildAnswerSnippetContent(innerHTML: string, style?: HTMLStyleElement) {\r\n    const snippet = $$('div', { className: RAW_CONTENT_CLASSNAME }, innerHTML);\r\n    const container = $$('div', {}, snippet);\r\n    if (style) {\r\n      container.append(style);\r\n    }\r\n    return container;\r\n  }\r\n\r\n  private buildSourceTitle(title: string, clickUri: string) {\r\n    return this.buildLink(title, clickUri, SOURCE_TITLE_CLASSNAME);\r\n  }\r\n\r\n  private buildSourceUrl(url: string) {\r\n    return this.buildLink(url, url, SOURCE_URL_CLASSNAME);\r\n  }\r\n\r\n  private buildLink(text: string, href: string, className: string) {\r\n    const element = $$('a', { className, href }).el as HTMLAnchorElement;\r\n    element.innerText = text;\r\n    return element;\r\n  }\r\n\r\n  private toggle() {\r\n    this.expanded = !this.expanded;\r\n    this.updateExpanded();\r\n  }\r\n\r\n  private updateExpanded() {\r\n    this.checkbox.setAttribute('aria-expanded', this.expanded.toString());\r\n    this.checkbox.setHtml(this.expanded ? SVGIcons.icons.arrowUp : SVGIcons.icons.arrowDown);\r\n    this.collapsibleContainer.setAttribute('tabindex', `${this.expanded ? 0 : -1}`);\r\n    this.collapsibleContainer.setAttribute('aria-hidden', (!this.expanded).toString());\r\n    this.collapsibleContainer.toggleClass(QUESTION_SNIPPET_HIDDEN_CLASSNAME, !this.expanded);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/SmartSnippetCollapsibleSuggestion.ts"],"sourceRoot":""}
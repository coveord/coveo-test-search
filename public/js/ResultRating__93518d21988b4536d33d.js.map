{"version":3,"sources":["./src/ui/ResultRating/ResultRating.ts","./sass/_ResultRating.scss"],"names":[],"mappings":"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","file":"ResultRating__93518d21988b4536d33d.js","sourcesContent":["import 'styling/_ResultRating';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\nimport { IRatingRequest } from '../../rest/RatingRequest';\r\nimport { AccessibleButton } from '../../utils/AccessibleButton';\r\nimport { $$, Dom } from '../../utils/Dom';\r\nimport { SVGDom } from '../../utils/SVGDom';\r\nimport { SVGIcons } from '../../utils/SVGIcons';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { Component } from '../Base/Component';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { Initialization } from '../Base/Initialization';\r\n\r\nexport enum RatingValues {\r\n  Undefined,\r\n  Lowest,\r\n  Low,\r\n  Average,\r\n  Good,\r\n  Best\r\n}\r\n\r\nexport interface IResultRatingOptions {}\r\n/**\r\n * **Note:**\r\n *\r\n * > The Coveo Cloud V2 platform does not support collaborative rating. Therefore, this component is obsolete in Coveo Cloud V2.\r\n *\r\n * The `ResultRating` component renders a 5-star rating widget. Interactive rating is possible if\r\n * the [`enableCollaborativeRating`]{@link SearchInterface.options.enableCollaborativeRating} option of your\r\n * search interface is `true`, and if collaborative rating is enabled on your Coveo index.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n *\r\n * @notSupportedIn salesforcefree\r\n */\r\nexport class ResultRating extends Component {\r\n  static ID = 'ResultRating';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      ResultRating: ResultRating\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Creates a new `ResultRating` component.\r\n   * @param element The HTMLElement on which to instantiate the component.\r\n   * @param options The options for the `ResultRating` component.\r\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n   * automatically resolved (with a slower execution time).\r\n   * @param result The result to associate the component with.\r\n   */\r\n  constructor(\r\n    public element: HTMLElement,\r\n    public options?: IResultRatingOptions,\r\n    public bindings?: IComponentBindings,\r\n    public result?: IQueryResult\r\n  ) {\r\n    super(element, ResultRating.ID, bindings);\r\n    this.options = ComponentOptions.initComponentOptions(element, ResultRating, options);\r\n\r\n    if (!Utils.isNullOrUndefined(result.rating)) {\r\n      this.renderComponent(element, result.rating);\r\n    }\r\n  }\r\n\r\n  private renderComponent(element: HTMLElement, rating: number) {\r\n    for (let starNumber = 1; starNumber <= 5; starNumber++) {\r\n      this.renderStar(element, starNumber <= rating, starNumber);\r\n    }\r\n  }\r\n\r\n  private renderStar(element: HTMLElement, isChecked: boolean, value: number) {\r\n    let star: Dom;\r\n    const starElement = $$(element).find('a[rating-value=\"' + value + '\"]');\r\n    if (starElement == null) {\r\n      star = $$('a', { className: 'coveo-result-rating-star' }, SVGIcons.icons.star);\r\n      SVGDom.addClassToSVGInContainer(star.el, 'coveo-result-rating-star-svg');\r\n      element.appendChild(star.el);\r\n\r\n      if (this.bindings.searchInterface.options.enableCollaborativeRating) {\r\n        new AccessibleButton()\r\n          .withElement(star)\r\n          .withSelectAction(e => {\r\n            const targetElement: HTMLElement = <HTMLElement>e.currentTarget;\r\n            this.rateDocument(parseInt(targetElement.getAttribute('rating-value')));\r\n          })\r\n          .withLabel(value.toString())\r\n          .build();\r\n\r\n        star.on('mouseover', e => {\r\n          const targetElement: HTMLElement = <HTMLElement>e.currentTarget;\r\n          this.renderComponent(element, parseInt(targetElement.getAttribute('rating-value')));\r\n        });\r\n\r\n        star.on('mouseout', () => {\r\n          this.renderComponent(element, this.result.rating);\r\n        });\r\n      }\r\n\r\n      star.el.setAttribute('rating-value', value.toString());\r\n    } else {\r\n      star = $$(starElement);\r\n    }\r\n\r\n    star.toggleClass('coveo-result-rating-star-active', isChecked);\r\n  }\r\n\r\n  /**\r\n   * Rates an item using the the specified `rating` value.\r\n   * @param rating The rating to assign to the item.\r\n   *\r\n   * The possible values are:\r\n   *\r\n   * - `0`: renders no star.\r\n   * - `1`: renders 1 star.\r\n   * - `2`: renders 2 stars.\r\n   * - `3`: renders 3 stars.\r\n   * - `4`: renders 4 stars.\r\n   * - `5`: renders 5 stars.\r\n   */\r\n  public rateDocument(rating: RatingValues) {\r\n    const request: IRatingRequest = {\r\n      rating: RatingValues[rating],\r\n      uniqueId: this.result.uniqueId\r\n    };\r\n\r\n    this.queryController\r\n      .getEndpoint()\r\n      .rateDocument(request)\r\n      .then(() => {\r\n        this.result.rating = rating;\r\n        this.renderComponent(this.element, rating);\r\n      })\r\n      .catch(() => {\r\n        this.logger.error('An error occurred while rating the item');\r\n      });\r\n  }\r\n}\r\n\r\nInitialization.registerAutoCreateComponent(ResultRating);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResultRating/ResultRating.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_ResultRating.scss\n// module id = 657\n// module chunks = 62 88"],"sourceRoot":""}
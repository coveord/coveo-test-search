{"version":3,"sources":["Thumbnail.min__5f3280c404a1ee75a113.js","./src/ui/Icon/Icon.ts","./src/ui/Thumbnail/Thumbnail.ts","./src/ui/ResultLink/ResultLink.ts"],"names":["webpackJsonpCoveo__temporary","188","module","exports","__webpack_require__","__extends","this","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","value","element","options","bindings","result","Icon","ID","ComponentOptions","initComponentOptions","resolveResult","Assert","exists","TemplateFieldsEvaluator","evaluateFieldsToMatch","conditions","initialize","parentElement","removeChild","_this","possibleInternalQuickview","$$","find","Component","computeCssClassNameForType","Utils","isNullOrUndefined","QueryUtils","hasHTMLVersion","addClass","on","get","open","createIcon","el","info","FileTypes","searchInterface","getBindings","preprocessIconInfo","toggleClass","small","undefined","indexOf","icon","replace","setAttribute","caption","shouldDisplayLabel","appendChild","className","withLabel","labelValue","doExport","exportGlobally","buildStringOption","buildBooleanOption","buildLocalizedStringOption","buildFieldConditionOption","Initialization","registerAutoCreateComponent","283","Thumbnail","initOptions","tagName","toLowerCase","img","clickable","ResultLink","href","replaceWith","append","hasThumbnail","buildThumbnailImage","logger","icn","endpoint","queryController","getEndpoint","isJsonp","buildImageWithDirectSrcAttribute","buildImageWithBase64SrcAttribute","makeAccessible","dataStreamUri","getViewAsDatastreamUri","uniqueId","contentType","resizeContainingFieldTable","getRawDataStream","then","response","rawBinary","String","fromCharCode","apply","Uint8Array","btoa","catch","setEmptyThumbnailClass","l","title","closestFieldTableElement","closest","updateToggleHeight","noThumbnailClass","defaultValue","parent","_","extend","532","92","os","logOpenDocument","debounce","saveLastQuery","documentURL","getAttribute","escapedClickUri","usageAnalytics","logClickEvent","analyticsActionCauseList","documentOpen","documentTitle","author","getFieldValue","root","Defer","flush","initialOptions","resultLinkOptions","componentOptionsModel","ComponentOptionsModel","attributesEnum","resultLink","openQuickview","raw","DeviceUtils","isMobileDevice","quickviewShouldBeOpened","once","window","setTimeout","clearTimeout","renderUri","bindEventToOpen","test","innerHTML","getDisplayedTitle","getDisplayedTitleAsText","openLink","logAnalytics","location","getResultUri","openLinkInNewWindow","openLinkInOutlook","hasOutlookField","openLinkAsConfigured","toExecuteOnOpen","bindOnClickIfNotUndefined","bindOpenQuickviewIfNotUndefined","setHrefIfNotAlready","openLinkThatIsNotAnAnchor","titleTemplate","newTitle","StringUtils","buildStringTemplateFromResult","StreamHighlightUtils","highlightStreamText","termsToHighlight","phrasesToHighlight","HighlightUtils","highlightString","titleHighlights","container","setHtml","text","escape","clickUri","enumerable","configurable","onClick","e","call","AccessibleButton","withElement","withSelectAction","build","resultElement","trigger","ResultListEvents","preventDefault","elementIsAnAnchor","alwaysOpenInNewWindow","openInOutlook","isNonEmptyString","filterProtocol","uri","isAbsolute","isRelative","hrefTemplate","field","setField","OSUtils","OS_NAME","MACOSX","WINDOWS","isUriThatMustBeOpenedInQuickview","buildFieldOption","buildCustomOption"],"mappings":"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","file":"Thumbnail.min__5f3280c404a1ee75a113.js","sourcesContent":["webpackJsonpCoveo__temporary([34,63,81],{\n\n/***/ 188:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Component_1 = __webpack_require__(7);\r\nvar ComponentOptions_1 = __webpack_require__(8);\r\nvar Assert_1 = __webpack_require__(5);\r\nvar QueryUtils_1 = __webpack_require__(21);\r\nvar Initialization_1 = __webpack_require__(2);\r\nvar Utils_1 = __webpack_require__(4);\r\nvar FileTypes_1 = __webpack_require__(113);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar GlobalExports_1 = __webpack_require__(3);\r\nvar TemplateFieldsEvaluator_1 = __webpack_require__(132);\r\n/**\r\n * The Icon component outputs the corresponding icon for a given file type. The component searches for a suitable icon\r\n * from those available in the Coveo JavaScript Search Framework. If the component finds no suitable icon, it instead\r\n * outputs a generic icon.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n */\r\nvar Icon = /** @class */ (function (_super) {\r\n    __extends(Icon, _super);\r\n    /**\r\n     * Creates a new Icon component.\r\n     * @param element The HTMLElement on which to instantiate the component.\r\n     * @param options The options for the Icon component.\r\n     * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n     * automatically resolved (with a slower execution time).\r\n     * @param result The result to associate the component with.\r\n     */\r\n    function Icon(element, options, bindings, result) {\r\n        var _this = _super.call(this, element, Icon.ID, bindings) || this;\r\n        _this.element = element;\r\n        _this.options = options;\r\n        _this.result = result;\r\n        _this.options = ComponentOptions_1.ComponentOptions.initComponentOptions(element, Icon, options);\r\n        _this.result = _this.result || _this.resolveResult();\r\n        Assert_1.Assert.exists(_this.result);\r\n        if (TemplateFieldsEvaluator_1.TemplateFieldsEvaluator.evaluateFieldsToMatch(_this.options.conditions, _this.result)) {\r\n            _this.initialize(element, bindings);\r\n        }\r\n        else if (_this.element.parentElement != null) {\r\n            _this.element.parentElement.removeChild(_this.element);\r\n        }\r\n        return _this;\r\n    }\r\n    Icon.prototype.initialize = function (element, bindings) {\r\n        var possibleInternalQuickview = Dom_1.$$(this.element).find('.' + Component_1.Component.computeCssClassNameForType('Quickview'));\r\n        if (!Utils_1.Utils.isNullOrUndefined(possibleInternalQuickview) && QueryUtils_1.QueryUtils.hasHTMLVersion(this.result)) {\r\n            Dom_1.$$(this.element).addClass('coveo-with-quickview');\r\n            Dom_1.$$(this.element).on('click', function () {\r\n                var qv = Component_1.Component.get(possibleInternalQuickview);\r\n                qv.open();\r\n            });\r\n        }\r\n        Icon.createIcon(this.result, this.options, element, bindings);\r\n    };\r\n    Icon.createIcon = function (result, options, element, bindings) {\r\n        if (options === void 0) { options = {}; }\r\n        if (element === void 0) { element = Dom_1.$$('div').el; }\r\n        var info = FileTypes_1.FileTypes.get(result);\r\n        if (!bindings && result.searchInterface) {\r\n            // try to resolve results bindings automatically\r\n            bindings = result.searchInterface.getBindings();\r\n        }\r\n        info = Icon.preprocessIconInfo(options, info);\r\n        Dom_1.$$(element).toggleClass('coveo-small', options.small === true);\r\n        if (options.value != undefined) {\r\n            if (options.small === true) {\r\n                if (options.value.indexOf('-small') == -1) {\r\n                    info.icon += '-small';\r\n                }\r\n            }\r\n            if (options.small === false) {\r\n                if (options.value.indexOf('-small') != -1) {\r\n                    info.icon = info.icon.replace('-small', '');\r\n                }\r\n            }\r\n        }\r\n        Dom_1.$$(element).addClass(info.icon);\r\n        element.setAttribute('title', info.caption);\r\n        if (Icon.shouldDisplayLabel(options, bindings)) {\r\n            element.appendChild(Dom_1.$$('span', {\r\n                className: 'coveo-icon-caption-overlay'\r\n            }, info.caption).el);\r\n            Dom_1.$$(element).addClass('coveo-icon-with-caption-overlay');\r\n            Dom_1.$$(element).setAttribute('data-with-label', 'true');\r\n        }\r\n        return element;\r\n    };\r\n    Icon.shouldDisplayLabel = function (options, bindings) {\r\n        // If withLabel is explicitely set to false, the label will never display\r\n        // If withLabel is explicitely set to true, the label will always display\r\n        // If withLabel is set to default value (not a hard true or false), the label will display based on ./core/filetypes/**.json\r\n        // with the property shouldDisplayLabel set on each file type/ objecttype\r\n        // In this case, the generated css will take care of outputting the correct css to display : block\r\n        return options.withLabel !== false;\r\n    };\r\n    Icon.preprocessIconInfo = function (options, info) {\r\n        if (options.labelValue != null) {\r\n            info.caption = options.labelValue;\r\n        }\r\n        if (options.value != null) {\r\n            info.icon = 'coveo-icon ' + options.value;\r\n        }\r\n        if (info.caption == null) {\r\n            info.caption = '';\r\n        }\r\n        if (info.icon == null) {\r\n            info.icon = 'coveo-icon coveo-sprites-custom';\r\n        }\r\n        return info;\r\n    };\r\n    Icon.ID = 'Icon';\r\n    Icon.doExport = function () {\r\n        GlobalExports_1.exportGlobally({\r\n            Icon: Icon\r\n        });\r\n    };\r\n    /**\r\n     * The options for the Icon\r\n     * @componentOptions\r\n     */\r\n    Icon.options = {\r\n        /**\r\n         * Specifies the value that the Icon component should output as its CSS class instead of the auto-selected value.\r\n         *\r\n         * Default value is `undefined`, which means that the Coveo JavaScript Search Framework outputs a suitable icon\r\n         * depending on the result file type.\r\n         */\r\n        value: ComponentOptions_1.ComponentOptions.buildStringOption(),\r\n        /**\r\n         * Specifies whether the Icon component should output the smaller version of the icon instead of the regular one.\r\n         *\r\n         * Default value is `undefined`.\r\n         */\r\n        small: ComponentOptions_1.ComponentOptions.buildBooleanOption(),\r\n        /**\r\n         * Specifies whether the Icon component should force the output icon to display its caption/label.\r\n         *\r\n         * **Note:**\r\n         *\r\n         * > Due to limited screen real estate, setting this option to `true` has no effect on icons used inside Coveo for\r\n         * > Salesforce Insight Panels.\r\n         *\r\n         * Default value is `undefined`, which means that the Coveo JavaScript Search Framework determines whether the icon\r\n         * needs to display a caption/label depending on the result file type.\r\n         */\r\n        withLabel: ComponentOptions_1.ComponentOptions.buildBooleanOption(),\r\n        /**\r\n         * Specifies what text to display as the icon caption/label.\r\n         *\r\n         * Default value is `undefined`, which means that the Coveo JavaScript Search Framework determines what text the icon\r\n         * needs to display depending on the result file type.\r\n         */\r\n        labelValue: ComponentOptions_1.ComponentOptions.buildLocalizedStringOption(),\r\n        /**\r\n         * A field-based condition that must be satisfied by the query result item for the component to be rendered.\r\n         *\r\n         * Note: This option uses a distinctive markup configuration syntax allowing multiple conditions to be expressed. Its underlying logic is the same as that of the field value conditions mechanism used by result templates.\r\n         *\r\n         * **Examples:**\r\n         * Render the component if the query result item's @documenttype field value is Article or Documentation.\r\n         * ```html\r\n         * <div class=\"CoveoIcon\" data-field=\"@author\" data-condition-field-documenttype=\"Article, Documentation\"></div>\r\n         * ```\r\n         *\r\n         * Render the component if the query result item's @documenttype field value is anything but Case.\r\n         * ```html\r\n         * <div class=\"CoveoIcon\" data-field=\"@author\" data-condition-field-not-documenttype=\"Case\"></div>\r\n         * ```\r\n         * Render the component if the query result item's @documenttype field value is Article, and if its @author field value is anything but Anonymous.\r\n         * ```html\r\n         * <div class=\"CoveoIcon\" data-field=\"@author\" data-condition-field-documenttype=\"Article\" data-condition-field-not-author=\"Anonymous\"></div>\r\n         * ```\r\n         * Default value is `undefined`.\r\n         */\r\n        conditions: ComponentOptions_1.ComponentOptions.buildFieldConditionOption()\r\n    };\r\n    return Icon;\r\n}(Component_1.Component));\r\nexports.Icon = Icon;\r\nInitialization_1.Initialization.registerAutoCreateComponent(Icon);\r\n\n\n/***/ }),\n\n/***/ 283:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar _ = __webpack_require__(0);\r\nvar GlobalExports_1 = __webpack_require__(3);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar QueryUtils_1 = __webpack_require__(21);\r\nvar Component_1 = __webpack_require__(7);\r\nvar ComponentOptions_1 = __webpack_require__(8);\r\nvar Initialization_1 = __webpack_require__(2);\r\nvar RegisteredNamedMethods_1 = __webpack_require__(30);\r\nvar Icon_1 = __webpack_require__(188);\r\nvar ResultLink_1 = __webpack_require__(92);\r\nvar Strings_1 = __webpack_require__(6);\r\n/**\r\n * The Thumbnail component automatically fetches the thumbnail of the result object and outputs an HTML `img` tag with\r\n * it.\r\n * @notSupportedIn salesforcefree\r\n */\r\nvar Thumbnail = /** @class */ (function (_super) {\r\n    __extends(Thumbnail, _super);\r\n    /**\r\n     * Creates a new Thumbnail component.\r\n     * @param element The HTMLElement on which to instantiate the component.\r\n     * @param options The options for the Thumbnail component.\r\n     * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n     * automatically resolved (with a slower execution time).\r\n     * @param result The result to associate the component with.\r\n     */\r\n    function Thumbnail(element, options, bindings, result) {\r\n        var _this = _super.call(this, element, Thumbnail.ID, bindings) || this;\r\n        _this.element = element;\r\n        _this.options = options;\r\n        _this.bindings = bindings;\r\n        _this.result = result;\r\n        _this.options = ComponentOptions_1.ComponentOptions.initOptions(element, Thumbnail.options, options, Thumbnail.ID);\r\n        if (_this.element.tagName.toLowerCase() != 'img') {\r\n            _this.img = Dom_1.$$('img').el;\r\n            _this.element.appendChild(_this.img);\r\n        }\r\n        else {\r\n            _this.img = _this.element;\r\n        }\r\n        if (_this.options.clickable) {\r\n            if (_this.element.tagName.toLowerCase() != 'img') {\r\n                new ResultLink_1.ResultLink(_this.element, _this.options, _this.bindings, _this.result);\r\n            }\r\n            else {\r\n                var href = Dom_1.$$('a');\r\n                Dom_1.$$(_this.element).replaceWith(href.el);\r\n                Dom_1.$$(href).append(_this.element);\r\n                new ResultLink_1.ResultLink(href.el, _this.options, _this.bindings, _this.result);\r\n            }\r\n        }\r\n        // We need to set src to a blank image right away to avoid the image from\r\n        // changing size once it's loaded. Also, doing this prevents a border from\r\n        // appearing on some browsers when there is no thumbnail. I've found no other\r\n        // way to get rid of it...\r\n        _this.img.setAttribute('src', 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==');\r\n        if (QueryUtils_1.QueryUtils.hasThumbnail(result)) {\r\n            _this.buildThumbnailImage();\r\n        }\r\n        else {\r\n            _this.logger.info('Result has no thumbnail. Cannot build thumbnail image, instanciating an Icon component instead.');\r\n            var icn = new Icon_1.Icon(Dom_1.$$('div').el, { small: true }, bindings, result);\r\n            Dom_1.$$(_this.element).replaceWith(icn.element);\r\n        }\r\n        return _this;\r\n    }\r\n    Thumbnail.prototype.buildThumbnailImage = function () {\r\n        var endpoint = this.bindings.queryController.getEndpoint();\r\n        if (endpoint.isJsonp()) {\r\n            // For jsonp we can't GET/POST for binary data. We are limited\r\n            // to only setting the src attribute directly on the img.\r\n            this.buildImageWithDirectSrcAttribute(endpoint);\r\n        }\r\n        else {\r\n            // Base 64 img allows us to GET/POST the image as raw binary, so that we can also\r\n            // pass the credential of the user. Useful for phonegap among others.\r\n            this.buildImageWithBase64SrcAttribute(endpoint);\r\n        }\r\n        this.makeAccessible();\r\n    };\r\n    Thumbnail.prototype.buildImageWithDirectSrcAttribute = function (endpoint) {\r\n        var dataStreamUri = endpoint.getViewAsDatastreamUri(this.result.uniqueId, '$Thumbnail$', {\r\n            contentType: 'image/png'\r\n        });\r\n        this.img.setAttribute('src', dataStreamUri);\r\n        this.resizeContainingFieldTable();\r\n    };\r\n    Thumbnail.prototype.buildImageWithBase64SrcAttribute = function (endpoint) {\r\n        var _this = this;\r\n        endpoint\r\n            .getRawDataStream(this.result.uniqueId, '$Thumbnail$')\r\n            .then(function (response) {\r\n            var rawBinary = String.fromCharCode.apply(null, new Uint8Array(response));\r\n            _this.img.setAttribute('src', 'data:image/png;base64, ' + btoa(rawBinary));\r\n            _this.resizeContainingFieldTable();\r\n        })\r\n            .catch(function () {\r\n            _this.setEmptyThumbnailClass();\r\n        });\r\n    };\r\n    Thumbnail.prototype.makeAccessible = function () {\r\n        this.img.setAttribute('alt', Strings_1.l('ThumbnailOf', this.result.title));\r\n    };\r\n    Thumbnail.prototype.resizeContainingFieldTable = function () {\r\n        var className = Component_1.Component.computeCssClassNameForType('FieldTable');\r\n        var closestFieldTableElement = Dom_1.$$(this.element).closest(className);\r\n        if (closestFieldTableElement != null) {\r\n            var fieldTable = RegisteredNamedMethods_1.get(closestFieldTableElement);\r\n            fieldTable.updateToggleHeight();\r\n        }\r\n    };\r\n    Thumbnail.prototype.setEmptyThumbnailClass = function () {\r\n        Dom_1.$$(this.img).addClass(this.options.noThumbnailClass);\r\n    };\r\n    Thumbnail.ID = 'Thumbnail';\r\n    Thumbnail.doExport = function () {\r\n        GlobalExports_1.exportGlobally({\r\n            Thumbnail: Thumbnail\r\n        });\r\n    };\r\n    /**\r\n     * Options for the Thumbnail\r\n     * @componentOptions\r\n     */\r\n    Thumbnail.options = {\r\n        /**\r\n         * Specifies the CSS class to use on the `img` tag that the Thumbnail component outputs when a result has no\r\n         * thumbnail in the index.\r\n         *\r\n         * Default value is `coveo-no-thumbnail`.\r\n         */\r\n        noThumbnailClass: ComponentOptions_1.ComponentOptions.buildStringOption({ defaultValue: 'coveo-no-thumbnail' }),\r\n        /**\r\n         * Specifies whether to create a clickable {@link ResultLink} around the Thumbnail.\r\n         *\r\n         * Default value is `false`.\r\n         *\r\n         * If set to true, you can use the options specified on {@link ResultLink.options}\r\n         */\r\n        clickable: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false })\r\n    };\r\n    Thumbnail.parent = ResultLink_1.ResultLink;\r\n    return Thumbnail;\r\n}(Component_1.Component));\r\nexports.Thumbnail = Thumbnail;\r\nThumbnail.options = _.extend({}, ResultLink_1.ResultLink.options, Thumbnail.options);\r\nInitialization_1.Initialization.registerAutoCreateComponent(Thumbnail);\r\n\n\n/***/ }),\n\n/***/ 532:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 92:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Component_1 = __webpack_require__(7);\r\nvar ComponentOptions_1 = __webpack_require__(8);\r\nvar ComponentOptionsModel_1 = __webpack_require__(28);\r\nvar AnalyticsActionListMeta_1 = __webpack_require__(10);\r\nvar ResultListEvents_1 = __webpack_require__(29);\r\nvar HighlightUtils_1 = __webpack_require__(68);\r\nvar DeviceUtils_1 = __webpack_require__(24);\r\nvar OSUtils_1 = __webpack_require__(181);\r\nvar Initialization_1 = __webpack_require__(2);\r\nvar QueryUtils_1 = __webpack_require__(21);\r\nvar Assert_1 = __webpack_require__(5);\r\nvar Utils_1 = __webpack_require__(4);\r\nvar Defer_1 = __webpack_require__(31);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar StreamHighlightUtils_1 = __webpack_require__(114);\r\nvar StringUtils_1 = __webpack_require__(22);\r\nvar underscore_1 = __webpack_require__(0);\r\nvar GlobalExports_1 = __webpack_require__(3);\r\n__webpack_require__(532);\r\nvar AccessibleButton_1 = __webpack_require__(15);\r\n/**\r\n * The `ResultLink` component automatically transform a search result title into a clickable link pointing to the\r\n * original item.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n */\r\nvar ResultLink = /** @class */ (function (_super) {\r\n    __extends(ResultLink, _super);\r\n    /**\r\n     * Creates a new `ResultLink` component.\r\n     * @param element The HTMLElement on which to instantiate the component.\r\n     * @param options The options for the `ResultLink` component.\r\n     * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n     * automatically resolved (with a slower execution time).\r\n     * @param result The result to associate the component with.\r\n     * @param os\r\n     */\r\n    function ResultLink(element, options, bindings, result, os) {\r\n        var _this = _super.call(this, element, ResultLink.ID, bindings) || this;\r\n        _this.element = element;\r\n        _this.options = options;\r\n        _this.bindings = bindings;\r\n        _this.result = result;\r\n        _this.os = os;\r\n        _this.logOpenDocument = underscore_1.debounce(function () {\r\n            _this.queryController.saveLastQuery();\r\n            var documentURL = Dom_1.$$(_this.element).getAttribute('href');\r\n            if (documentURL == undefined || documentURL == '') {\r\n                documentURL = _this.escapedClickUri;\r\n            }\r\n            _this.usageAnalytics.logClickEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.documentOpen, {\r\n                documentURL: documentURL,\r\n                documentTitle: _this.result.title,\r\n                author: Utils_1.Utils.getFieldValue(_this.result, 'author')\r\n            }, _this.result, _this.root);\r\n            Defer_1.Defer.flush();\r\n        }, 1500, true);\r\n        var initialOptions = ComponentOptions_1.ComponentOptions.initComponentOptions(element, ResultLink, options);\r\n        var resultLinkOptions = _this.componentOptionsModel.get(ComponentOptionsModel_1.ComponentOptionsModel.attributesEnum.resultLink);\r\n        _this.options = underscore_1.extend({}, initialOptions, resultLinkOptions);\r\n        _this.result = result || _this.resolveResult();\r\n        if (_this.options.openQuickview == null) {\r\n            _this.options.openQuickview = result.raw['connectortype'] == 'ExchangeCrawler' && DeviceUtils_1.DeviceUtils.isMobileDevice();\r\n        }\r\n        _this.element.setAttribute('tabindex', '0');\r\n        Assert_1.Assert.exists(_this.componentOptionsModel);\r\n        Assert_1.Assert.exists(_this.result);\r\n        if (!_this.quickviewShouldBeOpened()) {\r\n            // Bind on multiple \"click\" or \"mouse\" events.\r\n            // Create a function that will be executed only once, so as not to log multiple events\r\n            // Once a result link has been opened, and that we log at least one analytics event,\r\n            // it should not matter if the end user open the same link multiple times with different methods.\r\n            // It's still only one \"click\" event as far as UA is concerned.\r\n            // Also need to handle \"longpress\" on mobile (the contextual menu), which we assume to be 1 s long.\r\n            var executeOnlyOnce_1 = underscore_1.once(function () { return _this.logOpenDocument(); });\r\n            Dom_1.$$(element).on(['contextmenu', 'click', 'mousedown', 'mouseup'], executeOnlyOnce_1);\r\n            var longPressTimer_1;\r\n            Dom_1.$$(element).on('touchstart', function () {\r\n                longPressTimer_1 = window.setTimeout(executeOnlyOnce_1, 1000);\r\n            });\r\n            Dom_1.$$(element).on('touchend', function () {\r\n                if (longPressTimer_1) {\r\n                    clearTimeout(longPressTimer_1);\r\n                }\r\n            });\r\n        }\r\n        _this.renderUri(element, result);\r\n        _this.bindEventToOpen();\r\n        return _this;\r\n    }\r\n    ResultLink.prototype.renderUri = function (element, result) {\r\n        if (/^\\s*$/.test(this.element.innerHTML)) {\r\n            var title = this.getDisplayedTitle();\r\n            this.element.innerHTML = title;\r\n            if (!this.element.title) {\r\n                this.element.title = this.getDisplayedTitleAsText();\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Opens the result in the same window, no matter how the actual component is configured for the end user.\r\n     * @param logAnalytics Specifies whether the method should log an analytics event.\r\n     */\r\n    ResultLink.prototype.openLink = function (logAnalytics) {\r\n        if (logAnalytics === void 0) { logAnalytics = true; }\r\n        if (logAnalytics) {\r\n            this.logOpenDocument();\r\n        }\r\n        window.location.href = this.getResultUri();\r\n    };\r\n    /**\r\n     * Opens the result in a new window, no matter how the actual component is configured for the end user.\r\n     * @param logAnalytics Specifies whether the method should log an analytics event.\r\n     */\r\n    ResultLink.prototype.openLinkInNewWindow = function (logAnalytics) {\r\n        if (logAnalytics === void 0) { logAnalytics = true; }\r\n        if (logAnalytics) {\r\n            this.logOpenDocument();\r\n        }\r\n        window.open(this.getResultUri(), '_blank');\r\n    };\r\n    /**\r\n     * Tries to open the result in Microsoft Outlook if the result has an `outlookformacuri` or `outlookuri` field.\r\n     *\r\n     * Normally, this implies the result should be a link to an email.\r\n     *\r\n     * If the needed fields are not present, this method does nothing.\r\n     * @param logAnalytics Specifies whether the method should log an analytics event.\r\n     */\r\n    ResultLink.prototype.openLinkInOutlook = function (logAnalytics) {\r\n        if (logAnalytics === void 0) { logAnalytics = true; }\r\n        if (this.hasOutlookField()) {\r\n            if (logAnalytics) {\r\n                this.logOpenDocument();\r\n            }\r\n            this.openLink();\r\n        }\r\n    };\r\n    /**\r\n     * Opens the link in the same manner the end user would.\r\n     *\r\n     * This essentially simulates a click on the result link.\r\n     *\r\n     * @param logAnalytics Specifies whether the method should log an analytics event.\r\n     */\r\n    ResultLink.prototype.openLinkAsConfigured = function (logAnalytics) {\r\n        if (logAnalytics === void 0) { logAnalytics = true; }\r\n        if (this.toExecuteOnOpen) {\r\n            if (logAnalytics) {\r\n                this.logOpenDocument();\r\n            }\r\n            this.toExecuteOnOpen();\r\n        }\r\n    };\r\n    ResultLink.prototype.bindEventToOpen = function () {\r\n        return (this.bindOnClickIfNotUndefined() ||\r\n            this.bindOpenQuickviewIfNotUndefined() ||\r\n            this.setHrefIfNotAlready() ||\r\n            this.openLinkThatIsNotAnAnchor());\r\n    };\r\n    ResultLink.prototype.getDisplayedTitle = function () {\r\n        if (!this.options.titleTemplate) {\r\n            return this.result.title\r\n                ? HighlightUtils_1.HighlightUtils.highlightString(this.result.title, this.result.titleHighlights, null, 'coveo-highlight')\r\n                : this.escapedClickUri;\r\n        }\r\n        else {\r\n            var newTitle = StringUtils_1.StringUtils.buildStringTemplateFromResult(this.options.titleTemplate, this.result);\r\n            return newTitle\r\n                ? StreamHighlightUtils_1.StreamHighlightUtils.highlightStreamText(newTitle, this.result.termsToHighlight, this.result.phrasesToHighlight)\r\n                : this.escapedClickUri;\r\n        }\r\n    };\r\n    ResultLink.prototype.getDisplayedTitleAsText = function () {\r\n        var container = Dom_1.$$('div');\r\n        container.setHtml(this.getDisplayedTitle());\r\n        return container.text();\r\n    };\r\n    Object.defineProperty(ResultLink.prototype, \"escapedClickUri\", {\r\n        get: function () {\r\n            return underscore_1.escape(this.result.clickUri);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ResultLink.prototype.bindOnClickIfNotUndefined = function () {\r\n        var _this = this;\r\n        if (this.options.onClick != undefined) {\r\n            this.toExecuteOnOpen = function (e) {\r\n                _this.options.onClick.call(_this, e, _this.result);\r\n            };\r\n            new AccessibleButton_1.AccessibleButton()\r\n                .withElement(this.element)\r\n                .withLabel(this.result.title)\r\n                .withSelectAction(function (e) { return _this.toExecuteOnOpen(e); })\r\n                .build();\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    };\r\n    ResultLink.prototype.bindOpenQuickviewIfNotUndefined = function () {\r\n        var _this = this;\r\n        if (this.quickviewShouldBeOpened()) {\r\n            this.toExecuteOnOpen = function () {\r\n                Dom_1.$$(_this.bindings.resultElement).trigger(ResultListEvents_1.ResultListEvents.openQuickview);\r\n            };\r\n            Dom_1.$$(this.element).on('click', function (e) {\r\n                e.preventDefault();\r\n                _this.toExecuteOnOpen();\r\n            });\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    };\r\n    ResultLink.prototype.openLinkThatIsNotAnAnchor = function () {\r\n        var _this = this;\r\n        if (!this.elementIsAnAnchor()) {\r\n            this.toExecuteOnOpen = function () {\r\n                if (_this.options.alwaysOpenInNewWindow) {\r\n                    if (_this.options.openInOutlook) {\r\n                        _this.openLinkInOutlook();\r\n                    }\r\n                    else {\r\n                        _this.openLinkInNewWindow();\r\n                    }\r\n                }\r\n                else {\r\n                    _this.openLink();\r\n                }\r\n            };\r\n            Dom_1.$$(this.element).on('click', function () {\r\n                _this.toExecuteOnOpen();\r\n            });\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ResultLink.prototype.setHrefIfNotAlready = function () {\r\n        // Do not erase any value put in href by the template, etc. Allows\r\n        // using custom click urls while still keeping analytics recording\r\n        // and other behavior brought by the component.\r\n        if (this.elementIsAnAnchor() && !Utils_1.Utils.isNonEmptyString(Dom_1.$$(this.element).getAttribute('href'))) {\r\n            Dom_1.$$(this.element).setAttribute('href', this.getResultUri());\r\n            if (this.options.alwaysOpenInNewWindow && !(this.options.openInOutlook && this.hasOutlookField())) {\r\n                Dom_1.$$(this.element).setAttribute('target', '_blank');\r\n            }\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    };\r\n    ResultLink.prototype.filterProtocol = function (uri) {\r\n        var isAbsolute = /^(https?|ftp|file|mailto|tel):/i.test(uri);\r\n        var isRelative = /^\\//.test(uri);\r\n        return isAbsolute || isRelative ? uri : '';\r\n    };\r\n    ResultLink.prototype.getResultUri = function () {\r\n        if (this.options.hrefTemplate) {\r\n            var uri = StringUtils_1.StringUtils.buildStringTemplateFromResult(this.options.hrefTemplate, this.result);\r\n            return this.filterProtocol(uri);\r\n        }\r\n        if (this.options.field == undefined && this.options.openInOutlook) {\r\n            this.setField();\r\n        }\r\n        if (this.options.field != undefined) {\r\n            return this.filterProtocol(Utils_1.Utils.getFieldValue(this.result, this.options.field));\r\n        }\r\n        return this.filterProtocol(this.result.clickUri);\r\n    };\r\n    ResultLink.prototype.elementIsAnAnchor = function () {\r\n        return this.element.tagName == 'A';\r\n    };\r\n    ResultLink.prototype.setField = function () {\r\n        var os = Utils_1.Utils.exists(this.os) ? this.os : OSUtils_1.OSUtils.get();\r\n        if (os == OSUtils_1.OS_NAME.MACOSX && this.hasOutlookField()) {\r\n            this.options.field = '@outlookformacuri';\r\n        }\r\n        else if (os == OSUtils_1.OS_NAME.WINDOWS && this.hasOutlookField()) {\r\n            this.options.field = '@outlookuri';\r\n        }\r\n    };\r\n    ResultLink.prototype.hasOutlookField = function () {\r\n        var os = Utils_1.Utils.exists(this.os) ? this.os : OSUtils_1.OSUtils.get();\r\n        if (os == OSUtils_1.OS_NAME.MACOSX && this.result.raw['outlookformacuri'] != undefined) {\r\n            return true;\r\n        }\r\n        else if (os == OSUtils_1.OS_NAME.WINDOWS && this.result.raw['outlookuri'] != undefined) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ResultLink.prototype.isUriThatMustBeOpenedInQuickview = function () {\r\n        return this.escapedClickUri.toLowerCase().indexOf('ldap://') == 0;\r\n    };\r\n    ResultLink.prototype.quickviewShouldBeOpened = function () {\r\n        return (this.options.openQuickview || this.isUriThatMustBeOpenedInQuickview()) && QueryUtils_1.QueryUtils.hasHTMLVersion(this.result);\r\n    };\r\n    ResultLink.ID = 'ResultLink';\r\n    ResultLink.doExport = function () {\r\n        GlobalExports_1.exportGlobally({\r\n            ResultLink: ResultLink\r\n        });\r\n    };\r\n    /**\r\n     * The options for the ResultLink\r\n     * @componentOptions\r\n     */\r\n    ResultLink.options = {\r\n        /**\r\n         * Specifies the field to use to output the component `href` attribute value.\r\n         *\r\n         * **Tip:**\r\n         * > Instead of specifying a value for the `field` option, you can directly add an `href` attribute to the\r\n         * > `ResultLink` HTML element. Then, you can use a custom script to generate the `href` value.\r\n         *\r\n         * **Examples:**\r\n         * - With the following markup, the `ResultLink` outputs its `href` value using the `@uri` field (rather than the\r\n         * default field):\r\n         *\r\n         * ```html\r\n         * <a class=\"CoveoResultLink\" data-field=\"@uri\"></a>\r\n         * ```\r\n         *\r\n         * - In the following result template, the custom `getMyKBUri()` function provides the `href` value:\r\n         *\r\n         * ```html\r\n         * <script id=\"KnowledgeArticle\" type=\"text/underscore\" class=\"result-template\">\r\n         *   <div class='CoveoIcon>'></div>\r\n         *   <a class=\"CoveoResultLink\" href=\"<%= getMyKBUri(raw) %>\"></a>\r\n         *   <div class=\"CoveoExcerpt\"></div>\r\n         * </script>\r\n         * ```\r\n         *\r\n         * See also [`hrefTemplate`]{@link ResultLink.options.hrefTemplate}, which can override this option.\r\n         *\r\n         * By default, the component uses the `@clickUri` field of the item to output the value of its `href` attribute.\r\n         */\r\n        field: ComponentOptions_1.ComponentOptions.buildFieldOption(),\r\n        /**\r\n         * Specifies whether the component should try to open its link in Microsoft Outlook.\r\n         *\r\n         * Setting this option to `true` is normally useful for `ResultLink` instances related to Microsoft Exchange emails.\r\n         *\r\n         * If this option is `true`, clicking the `ResultLink` calls the\r\n         * [`openLinkInOutlook`]{@link ResultLink.openLinkInOutlook} method instead of the\r\n         * [`openLink`]{@link ResultLink.openLink} method.\r\n         *\r\n         * Default value is `false`.\r\n         */\r\n        openInOutlook: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n        /**\r\n         * Specifies whether the component should open its link in the [`Quickview`]{@link Quickview} component rather than\r\n         * loading through the original URL.\r\n         *\r\n         * Default value is `false`.\r\n         */\r\n        openQuickview: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n        /**\r\n         * Specifies whether the component should open its link in a new window instead of opening it in the current\r\n         * context.\r\n         *\r\n         * If this option is `true`, clicking the `ResultLink` calls the\r\n         * [`openLinkInNewWindow`]{@link ResultLink.openLinkInNewWindow} method instead of the\r\n         * [`openLink`]{@link ResultLink.openLink} method.\r\n         *\r\n         * **Note:**\r\n         * > If a search page contains a [`ResultPreferences`]{@link ResultsPreferences} component whose\r\n         * > [`enableOpenInNewWindow`]{@link ResultsPreferences.options.enableOpenInNewWindow} option is `true`, and the end\r\n         * > user checks the <b>Always open results in new window</b> box, `ResultLink` components in this page will always\r\n         * > open their links in a new window when the end user clicks them, no matter what the value of their\r\n         * > `alwaysOpenInNewWindow` option is.\r\n         *\r\n         * Default value is `false`.\r\n         */\r\n        alwaysOpenInNewWindow: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n        /**\r\n         * Specifies a template literal from which to generate the `ResultLink` `href` attribute value (see\r\n         * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\r\n         *\r\n         * This option overrides the [`field`]{@link ResultLink.options.field} option value.\r\n         *\r\n         * The template literal can reference any number of fields from the parent result. It can also reference global\r\n         * scope properties.\r\n         *\r\n         * **Examples:**\r\n         *\r\n         * - The following markup generates an `href` value such as `http://uri.com?id=itemTitle`:\r\n         *\r\n         * ```html\r\n         * <a class='CoveoResultLink' data-href-template='${clickUri}?id=${raw.title}'></a>\r\n         * ```\r\n         *\r\n         * - The following markup generates an `href` value such as `localhost/fooBar`:\r\n         *\r\n         * ```html\r\n         * <a class='CoveoResultLink' data-href-template='${window.location.hostname}/{Foo.Bar}'></a>\r\n         * ```\r\n         *\r\n         * Default value is `undefined`.\r\n         */\r\n        hrefTemplate: ComponentOptions_1.ComponentOptions.buildStringOption(),\r\n        /**\r\n         * Specifies a template literal from which to generate the `ResultLink` display title (see\r\n         * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\r\n         *\r\n         * This option overrides the default `ResultLink` display title behavior.\r\n         *\r\n         * The template literal can reference any number of fields from the parent result. However, if the template literal\r\n         * references a key whose value is undefined in the parent result fields, the `ResultLink` title displays the\r\n         * name of this key instead.\r\n         *\r\n         * This option is ignored if the `ResultLink` innerHTML contains any value.\r\n         *\r\n         * **Examples:**\r\n         *\r\n         * - The following markup generates a `ResultLink` display title such as `Case number: 123456` if both the\r\n         * `raw.objecttype` and `raw.objectnumber` keys are defined in the parent result fields:\r\n         *\r\n         * ```html\r\n         * <a class=\"CoveoResultLink\" data-title-template=\"${raw.objecttype} number: ${raw.objectnumber}\"></a>\r\n         * ```\r\n         *\r\n         * - The following markup generates `${myField}` as a `ResultLink` display title if the `myField` key is undefined\r\n         * in the parent result fields:\r\n         *\r\n         * ```html\r\n         * <a class=\"CoveoResultLink\" data-title-template=\"${myField}\"></a>\r\n         * ```\r\n         *\r\n         * - The following markup generates `Foobar` as a `ResultLink` display title, because the `ResultLink` innterHTML is\r\n         * not empty:\r\n         *\r\n         * ```html\r\n         * <a class=\"CoveoResultLink\" data-title-template=\"${will} ${be} ${ignored}\">Foobar</a>\r\n         * ```\r\n         *\r\n         * Default value is `undefined`.\r\n         *\r\n         * @availablesince [January 2017 Release (v1.1865.9)](https://docs.coveo.com/en/396/#january-2017-release-v118659)\r\n         */\r\n        titleTemplate: ComponentOptions_1.ComponentOptions.buildStringOption(),\r\n        /**\r\n         * Specifies an event handler function to execute when the user clicks the `ResultLink` component.\r\n         *\r\n         * The handler function takes a JavaScript [`Event`](https://developer.mozilla.org/en/docs/Web/API/Event) object and\r\n         * an [`IQueryResult`]{@link IQueryResult} as its parameters.\r\n         *\r\n         * Overriding the default behavior of the `onClick` event can allow you to execute specific code instead.\r\n         *\r\n         * **Note:**\r\n         * > You cannot set this option directly in the component markup as an HTML attribute. You must either set it in the\r\n         * > [`init`]{@link init} call of your search interface (see\r\n         * > [Passing Component Options in the init Call](https://docs.coveo.com/en/346/#passing-component-options-in-the-init-call)),\r\n         * > or before the `init` call, using the `options` top-level function (see\r\n         * > [Passing Component Options Before the init Call](https://docs.coveo.com/en/346/#passing-component-options-before-the-init-call)).\r\n         *\r\n         * **Example:**\r\n         * ```javascript\r\n         * // You can set the option in the 'init' call:\r\n         * Coveo.init(document.querySelector(\"#search\"), {\r\n         *   ResultLink : {\r\n         *     onClick : function(e, result) {\r\n         *       e.preventDefault();\r\n         *       // Custom code to execute with the item URI and title.\r\n         *       openUriInASpecialTab(result.clickUri, result.title);\r\n         *     }\r\n         *   }\r\n         * });\r\n         *\r\n         * // Or before the 'init' call, using the 'options' top-level function:\r\n         * // Coveo.options(document.querySelector('#search'), {\r\n         * //   ResultLink : {\r\n         * //     onClick : function(e, result) {\r\n         * //       e.preventDefault();\r\n         * //       // Custom code to execute with the item URI and title.\r\n         * //       openUriInASpecialTab(result.clickUri, result.title);\r\n         * //     }\r\n         * //   }\r\n         * // });\r\n         * ```\r\n         */\r\n        onClick: ComponentOptions_1.ComponentOptions.buildCustomOption(function () {\r\n            return null;\r\n        })\r\n    };\r\n    return ResultLink;\r\n}(Component_1.Component));\r\nexports.ResultLink = ResultLink;\r\nInitialization_1.Initialization.registerAutoCreateComponent(ResultLink);\r\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// Thumbnail.min__5f3280c404a1ee75a113.js","import { Component } from '../Base/Component';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { IFieldConditionOption } from '../Base/IComponentOptions';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\nimport { Assert } from '../../misc/Assert';\r\nimport { QueryUtils } from '../../utils/QueryUtils';\r\nimport { Initialization } from '../Base/Initialization';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { FileTypes, IFileTypeInfo } from '../Misc/FileTypes';\r\nimport { $$ } from '../../utils/Dom';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { TemplateFieldsEvaluator } from '../Templates/TemplateFieldsEvaluator';\r\n\r\n/**\r\n * Available options for the {@link Icon} component.\r\n */\r\nexport interface IIconOptions {\r\n  value?: string;\r\n  small?: boolean;\r\n  withLabel?: boolean;\r\n  labelValue?: string;\r\n  conditions?: IFieldConditionOption[];\r\n}\r\n\r\n/**\r\n * The Icon component outputs the corresponding icon for a given file type. The component searches for a suitable icon\r\n * from those available in the Coveo JavaScript Search Framework. If the component finds no suitable icon, it instead\r\n * outputs a generic icon.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n */\r\nexport class Icon extends Component {\r\n  static ID = 'Icon';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      Icon: Icon\r\n    });\r\n  };\r\n\r\n  /**\r\n   * The options for the Icon\r\n   * @componentOptions\r\n   */\r\n  static options: IIconOptions = {\r\n    /**\r\n     * Specifies the value that the Icon component should output as its CSS class instead of the auto-selected value.\r\n     *\r\n     * Default value is `undefined`, which means that the Coveo JavaScript Search Framework outputs a suitable icon\r\n     * depending on the result file type.\r\n     */\r\n    value: ComponentOptions.buildStringOption(),\r\n\r\n    /**\r\n     * Specifies whether the Icon component should output the smaller version of the icon instead of the regular one.\r\n     *\r\n     * Default value is `undefined`.\r\n     */\r\n    small: ComponentOptions.buildBooleanOption(),\r\n\r\n    /**\r\n     * Specifies whether the Icon component should force the output icon to display its caption/label.\r\n     *\r\n     * **Note:**\r\n     *\r\n     * > Due to limited screen real estate, setting this option to `true` has no effect on icons used inside Coveo for\r\n     * > Salesforce Insight Panels.\r\n     *\r\n     * Default value is `undefined`, which means that the Coveo JavaScript Search Framework determines whether the icon\r\n     * needs to display a caption/label depending on the result file type.\r\n     */\r\n    withLabel: ComponentOptions.buildBooleanOption(),\r\n\r\n    /**\r\n     * Specifies what text to display as the icon caption/label.\r\n     *\r\n     * Default value is `undefined`, which means that the Coveo JavaScript Search Framework determines what text the icon\r\n     * needs to display depending on the result file type.\r\n     */\r\n    labelValue: ComponentOptions.buildLocalizedStringOption(),\r\n\r\n    /**\r\n     * A field-based condition that must be satisfied by the query result item for the component to be rendered.\r\n     *\r\n     * Note: This option uses a distinctive markup configuration syntax allowing multiple conditions to be expressed. Its underlying logic is the same as that of the field value conditions mechanism used by result templates.\r\n     *\r\n     * **Examples:**\r\n     * Render the component if the query result item's @documenttype field value is Article or Documentation.\r\n     * ```html\r\n     * <div class=\"CoveoIcon\" data-field=\"@author\" data-condition-field-documenttype=\"Article, Documentation\"></div>\r\n     * ```\r\n     *\r\n     * Render the component if the query result item's @documenttype field value is anything but Case.\r\n     * ```html\r\n     * <div class=\"CoveoIcon\" data-field=\"@author\" data-condition-field-not-documenttype=\"Case\"></div>\r\n     * ```\r\n     * Render the component if the query result item's @documenttype field value is Article, and if its @author field value is anything but Anonymous.\r\n     * ```html\r\n     * <div class=\"CoveoIcon\" data-field=\"@author\" data-condition-field-documenttype=\"Article\" data-condition-field-not-author=\"Anonymous\"></div>\r\n     * ```\r\n     * Default value is `undefined`.\r\n     */\r\n    conditions: ComponentOptions.buildFieldConditionOption()\r\n  };\r\n\r\n  /**\r\n   * Creates a new Icon component.\r\n   * @param element The HTMLElement on which to instantiate the component.\r\n   * @param options The options for the Icon component.\r\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n   * automatically resolved (with a slower execution time).\r\n   * @param result The result to associate the component with.\r\n   */\r\n  constructor(public element: HTMLElement, public options?: IIconOptions, bindings?: IComponentBindings, public result?: IQueryResult) {\r\n    super(element, Icon.ID, bindings);\r\n\r\n    this.options = ComponentOptions.initComponentOptions(element, Icon, options);\r\n    this.result = this.result || this.resolveResult();\r\n    Assert.exists(this.result);\r\n\r\n    if (TemplateFieldsEvaluator.evaluateFieldsToMatch(this.options.conditions, this.result)) {\r\n      this.initialize(element, bindings);\r\n    } else if (this.element.parentElement != null) {\r\n      this.element.parentElement.removeChild(this.element);\r\n    }\r\n  }\r\n\r\n  private initialize(element: HTMLElement, bindings: IComponentBindings) {\r\n    const possibleInternalQuickview = $$(this.element).find('.' + Component.computeCssClassNameForType('Quickview'));\r\n    if (!Utils.isNullOrUndefined(possibleInternalQuickview) && QueryUtils.hasHTMLVersion(this.result)) {\r\n      $$(this.element).addClass('coveo-with-quickview');\r\n      $$(this.element).on('click', () => {\r\n        const qv = <any>Component.get(possibleInternalQuickview);\r\n        qv.open();\r\n      });\r\n    }\r\n\r\n    Icon.createIcon(this.result, this.options, element, bindings);\r\n  }\r\n\r\n  static createIcon(result: IQueryResult, options: IIconOptions = {}, element: HTMLElement = $$('div').el, bindings?: IComponentBindings) {\r\n    let info = FileTypes.get(result);\r\n    if (!bindings && result.searchInterface) {\r\n      // try to resolve results bindings automatically\r\n      bindings = result.searchInterface.getBindings();\r\n    }\r\n    info = Icon.preprocessIconInfo(options, info);\r\n    $$(element).toggleClass('coveo-small', options.small === true);\r\n\r\n    if (options.value != undefined) {\r\n      if (options.small === true) {\r\n        if (options.value.indexOf('-small') == -1) {\r\n          info.icon += '-small';\r\n        }\r\n      }\r\n      if (options.small === false) {\r\n        if (options.value.indexOf('-small') != -1) {\r\n          info.icon = info.icon.replace('-small', '');\r\n        }\r\n      }\r\n    }\r\n    $$(element).addClass(info.icon);\r\n    element.setAttribute('title', info.caption);\r\n\r\n    if (Icon.shouldDisplayLabel(options, bindings)) {\r\n      element.appendChild(\r\n        $$(\r\n          'span',\r\n          {\r\n            className: 'coveo-icon-caption-overlay'\r\n          },\r\n          info.caption\r\n        ).el\r\n      );\r\n      $$(element).addClass('coveo-icon-with-caption-overlay');\r\n      $$(element).setAttribute('data-with-label', 'true');\r\n    }\r\n    return element;\r\n  }\r\n\r\n  static shouldDisplayLabel(options: IIconOptions, bindings: IComponentBindings) {\r\n    // If withLabel is explicitely set to false, the label will never display\r\n    // If withLabel is explicitely set to true, the label will always display\r\n    // If withLabel is set to default value (not a hard true or false), the label will display based on ./core/filetypes/**.json\r\n    // with the property shouldDisplayLabel set on each file type/ objecttype\r\n    // In this case, the generated css will take care of outputting the correct css to display : block\r\n    return options.withLabel !== false;\r\n  }\r\n\r\n  static preprocessIconInfo(options: IIconOptions, info: IFileTypeInfo) {\r\n    if (options.labelValue != null) {\r\n      info.caption = options.labelValue;\r\n    }\r\n    if (options.value != null) {\r\n      info.icon = 'coveo-icon ' + options.value;\r\n    }\r\n    if (info.caption == null) {\r\n      info.caption = '';\r\n    }\r\n    if (info.icon == null) {\r\n      info.icon = 'coveo-icon coveo-sprites-custom';\r\n    }\r\n    return info;\r\n  }\r\n}\r\nInitialization.registerAutoCreateComponent(Icon);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Icon/Icon.ts","import * as _ from 'underscore';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\nimport { ISearchEndpoint } from '../../rest/SearchEndpointInterface';\r\nimport { $$ } from '../../utils/Dom';\r\nimport { QueryUtils } from '../../utils/QueryUtils';\r\nimport { Component } from '../Base/Component';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { Initialization } from '../Base/Initialization';\r\nimport { get } from '../Base/RegisteredNamedMethods';\r\nimport { IResultsComponentBindings } from '../Base/ResultsComponentBindings';\r\nimport { Icon } from '../Icon/Icon';\r\nimport { ResultLink } from '../ResultLink/ResultLink';\r\nimport { IResultLinkOptions } from '../ResultLink/ResultLinkOptions';\r\nimport { FieldTable } from '../FieldTable/FieldTable';\r\nimport { l } from '../../strings/Strings';\r\n\r\nexport interface IThumbnailOptions extends IResultLinkOptions {\r\n  noThumbnailClass?: string;\r\n  clickable?: boolean;\r\n}\r\n\r\n/**\r\n * The Thumbnail component automatically fetches the thumbnail of the result object and outputs an HTML `img` tag with\r\n * it.\r\n * @notSupportedIn salesforcefree\r\n */\r\nexport class Thumbnail extends Component {\r\n  static ID = 'Thumbnail';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      Thumbnail: Thumbnail\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Options for the Thumbnail\r\n   * @componentOptions\r\n   */\r\n  static options: IThumbnailOptions = {\r\n    /**\r\n     * Specifies the CSS class to use on the `img` tag that the Thumbnail component outputs when a result has no\r\n     * thumbnail in the index.\r\n     *\r\n     * Default value is `coveo-no-thumbnail`.\r\n     */\r\n    noThumbnailClass: ComponentOptions.buildStringOption({ defaultValue: 'coveo-no-thumbnail' }),\r\n\r\n    /**\r\n     * Specifies whether to create a clickable {@link ResultLink} around the Thumbnail.\r\n     *\r\n     * Default value is `false`.\r\n     *\r\n     * If set to true, you can use the options specified on {@link ResultLink.options}\r\n     */\r\n    clickable: ComponentOptions.buildBooleanOption({ defaultValue: false })\r\n  };\r\n\r\n  static parent = ResultLink;\r\n\r\n  public img: HTMLImageElement;\r\n\r\n  /**\r\n   * Creates a new Thumbnail component.\r\n   * @param element The HTMLElement on which to instantiate the component.\r\n   * @param options The options for the Thumbnail component.\r\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n   * automatically resolved (with a slower execution time).\r\n   * @param result The result to associate the component with.\r\n   */\r\n  constructor(\r\n    public element: HTMLElement,\r\n    public options?: IThumbnailOptions,\r\n    public bindings?: IResultsComponentBindings,\r\n    public result?: IQueryResult\r\n  ) {\r\n    super(element, Thumbnail.ID, bindings);\r\n\r\n    this.options = ComponentOptions.initOptions(element, <any>Thumbnail.options, options, Thumbnail.ID);\r\n\r\n    if (this.element.tagName.toLowerCase() != 'img') {\r\n      this.img = <HTMLImageElement>$$('img').el;\r\n      this.element.appendChild(this.img);\r\n    } else {\r\n      this.img = <HTMLImageElement>this.element;\r\n    }\r\n\r\n    if (this.options.clickable) {\r\n      if (this.element.tagName.toLowerCase() != 'img') {\r\n        new ResultLink(this.element, this.options, this.bindings, this.result);\r\n      } else {\r\n        let href = $$('a');\r\n        $$(this.element).replaceWith(href.el);\r\n        $$(href).append(this.element);\r\n        new ResultLink(href.el, this.options, this.bindings, this.result);\r\n      }\r\n    }\r\n\r\n    // We need to set src to a blank image right away to avoid the image from\r\n    // changing size once it's loaded. Also, doing this prevents a border from\r\n    // appearing on some browsers when there is no thumbnail. I've found no other\r\n    // way to get rid of it...\r\n    this.img.setAttribute('src', 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==');\r\n\r\n    if (QueryUtils.hasThumbnail(result)) {\r\n      this.buildThumbnailImage();\r\n    } else {\r\n      this.logger.info('Result has no thumbnail. Cannot build thumbnail image, instanciating an Icon component instead.');\r\n      const icn = new Icon($$('div').el, { small: true }, bindings, result);\r\n      $$(this.element).replaceWith(icn.element);\r\n    }\r\n  }\r\n\r\n  private buildThumbnailImage() {\r\n    let endpoint = this.bindings.queryController.getEndpoint();\r\n\r\n    if (endpoint.isJsonp()) {\r\n      // For jsonp we can't GET/POST for binary data. We are limited\r\n      // to only setting the src attribute directly on the img.\r\n      this.buildImageWithDirectSrcAttribute(endpoint);\r\n    } else {\r\n      // Base 64 img allows us to GET/POST the image as raw binary, so that we can also\r\n      // pass the credential of the user. Useful for phonegap among others.\r\n      this.buildImageWithBase64SrcAttribute(endpoint);\r\n    }\r\n\r\n    this.makeAccessible();\r\n  }\r\n\r\n  private buildImageWithDirectSrcAttribute(endpoint: ISearchEndpoint) {\r\n    let dataStreamUri = endpoint.getViewAsDatastreamUri(this.result.uniqueId, '$Thumbnail$', {\r\n      contentType: 'image/png'\r\n    });\r\n    this.img.setAttribute('src', dataStreamUri);\r\n    this.resizeContainingFieldTable();\r\n  }\r\n\r\n  private buildImageWithBase64SrcAttribute(endpoint: ISearchEndpoint) {\r\n    endpoint\r\n      .getRawDataStream(this.result.uniqueId, '$Thumbnail$')\r\n      .then(response => {\r\n        let rawBinary = String.fromCharCode.apply(null, new Uint8Array(response));\r\n        this.img.setAttribute('src', 'data:image/png;base64, ' + btoa(rawBinary));\r\n        this.resizeContainingFieldTable();\r\n      })\r\n      .catch(() => {\r\n        this.setEmptyThumbnailClass();\r\n      });\r\n  }\r\n\r\n  private makeAccessible() {\r\n    this.img.setAttribute('alt', l('ThumbnailOf', this.result.title));\r\n  }\r\n\r\n  private resizeContainingFieldTable() {\r\n    const className = Component.computeCssClassNameForType('FieldTable');\r\n    let closestFieldTableElement = $$(this.element).closest(className);\r\n    if (closestFieldTableElement != null) {\r\n      let fieldTable = <FieldTable>get(closestFieldTableElement);\r\n      fieldTable.updateToggleHeight();\r\n    }\r\n  }\r\n\r\n  private setEmptyThumbnailClass() {\r\n    $$(this.img).addClass(this.options.noThumbnailClass);\r\n  }\r\n}\r\n\r\nThumbnail.options = _.extend({}, ResultLink.options, Thumbnail.options);\r\n\r\nInitialization.registerAutoCreateComponent(Thumbnail);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Thumbnail/Thumbnail.ts","import { Component } from '../Base/Component';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { ComponentOptionsModel } from '../../models/ComponentOptionsModel';\r\nimport { IResultsComponentBindings } from '../Base/ResultsComponentBindings';\r\nimport { analyticsActionCauseList } from '../Analytics/AnalyticsActionListMeta';\r\nimport { IResultLinkOptions } from './ResultLinkOptions';\r\nimport { ResultListEvents } from '../../events/ResultListEvents';\r\nimport { HighlightUtils } from '../../utils/HighlightUtils';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\nimport { DeviceUtils } from '../../utils/DeviceUtils';\r\nimport { OS_NAME, OSUtils } from '../../utils/OSUtils';\r\nimport { Initialization } from '../Base/Initialization';\r\nimport { QueryUtils } from '../../utils/QueryUtils';\r\nimport { Assert } from '../../misc/Assert';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { Defer } from '../../misc/Defer';\r\nimport { $$ } from '../../utils/Dom';\r\nimport { StreamHighlightUtils } from '../../utils/StreamHighlightUtils';\r\nimport { StringUtils } from '../../utils/StringUtils';\r\nimport { once, debounce, extend, escape } from 'underscore';\r\nimport { exportGlobally } from '../../GlobalExports';\r\n\r\nimport 'styling/_ResultLink';\r\nimport { AccessibleButton } from '../../utils/AccessibleButton';\r\n\r\n/**\r\n * The `ResultLink` component automatically transform a search result title into a clickable link pointing to the\r\n * original item.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n */\r\nexport class ResultLink extends Component {\r\n  static ID = 'ResultLink';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      ResultLink: ResultLink\r\n    });\r\n  };\r\n\r\n  /**\r\n   * The options for the ResultLink\r\n   * @componentOptions\r\n   */\r\n  static options: IResultLinkOptions = {\r\n    /**\r\n     * Specifies the field to use to output the component `href` attribute value.\r\n     *\r\n     * **Tip:**\r\n     * > Instead of specifying a value for the `field` option, you can directly add an `href` attribute to the\r\n     * > `ResultLink` HTML element. Then, you can use a custom script to generate the `href` value.\r\n     *\r\n     * **Examples:**\r\n     * - With the following markup, the `ResultLink` outputs its `href` value using the `@uri` field (rather than the\r\n     * default field):\r\n     *\r\n     * ```html\r\n     * <a class=\"CoveoResultLink\" data-field=\"@uri\"></a>\r\n     * ```\r\n     *\r\n     * - In the following result template, the custom `getMyKBUri()` function provides the `href` value:\r\n     *\r\n     * ```html\r\n     * <script id=\"KnowledgeArticle\" type=\"text/underscore\" class=\"result-template\">\r\n     *   <div class='CoveoIcon>'></div>\r\n     *   <a class=\"CoveoResultLink\" href=\"<%= getMyKBUri(raw) %>\"></a>\r\n     *   <div class=\"CoveoExcerpt\"></div>\r\n     * </script>\r\n     * ```\r\n     *\r\n     * See also [`hrefTemplate`]{@link ResultLink.options.hrefTemplate}, which can override this option.\r\n     *\r\n     * By default, the component uses the `@clickUri` field of the item to output the value of its `href` attribute.\r\n     */\r\n    field: ComponentOptions.buildFieldOption(),\r\n\r\n    /**\r\n     * Specifies whether the component should try to open its link in Microsoft Outlook.\r\n     *\r\n     * Setting this option to `true` is normally useful for `ResultLink` instances related to Microsoft Exchange emails.\r\n     *\r\n     * If this option is `true`, clicking the `ResultLink` calls the\r\n     * [`openLinkInOutlook`]{@link ResultLink.openLinkInOutlook} method instead of the\r\n     * [`openLink`]{@link ResultLink.openLink} method.\r\n     *\r\n     * Default value is `false`.\r\n     */\r\n    openInOutlook: ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n\r\n    /**\r\n     * Specifies whether the component should open its link in the [`Quickview`]{@link Quickview} component rather than\r\n     * loading through the original URL.\r\n     *\r\n     * Default value is `false`.\r\n     */\r\n    openQuickview: ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n\r\n    /**\r\n     * Specifies whether the component should open its link in a new window instead of opening it in the current\r\n     * context.\r\n     *\r\n     * If this option is `true`, clicking the `ResultLink` calls the\r\n     * [`openLinkInNewWindow`]{@link ResultLink.openLinkInNewWindow} method instead of the\r\n     * [`openLink`]{@link ResultLink.openLink} method.\r\n     *\r\n     * **Note:**\r\n     * > If a search page contains a [`ResultPreferences`]{@link ResultsPreferences} component whose\r\n     * > [`enableOpenInNewWindow`]{@link ResultsPreferences.options.enableOpenInNewWindow} option is `true`, and the end\r\n     * > user checks the <b>Always open results in new window</b> box, `ResultLink` components in this page will always\r\n     * > open their links in a new window when the end user clicks them, no matter what the value of their\r\n     * > `alwaysOpenInNewWindow` option is.\r\n     *\r\n     * Default value is `false`.\r\n     */\r\n    alwaysOpenInNewWindow: ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n\r\n    /**\r\n     * Specifies a template literal from which to generate the `ResultLink` `href` attribute value (see\r\n     * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\r\n     *\r\n     * This option overrides the [`field`]{@link ResultLink.options.field} option value.\r\n     *\r\n     * The template literal can reference any number of fields from the parent result. It can also reference global\r\n     * scope properties.\r\n     *\r\n     * **Examples:**\r\n     *\r\n     * - The following markup generates an `href` value such as `http://uri.com?id=itemTitle`:\r\n     *\r\n     * ```html\r\n     * <a class='CoveoResultLink' data-href-template='${clickUri}?id=${raw.title}'></a>\r\n     * ```\r\n     *\r\n     * - The following markup generates an `href` value such as `localhost/fooBar`:\r\n     *\r\n     * ```html\r\n     * <a class='CoveoResultLink' data-href-template='${window.location.hostname}/{Foo.Bar}'></a>\r\n     * ```\r\n     *\r\n     * Default value is `undefined`.\r\n     */\r\n    hrefTemplate: ComponentOptions.buildStringOption(),\r\n\r\n    /**\r\n     * Specifies a template literal from which to generate the `ResultLink` display title (see\r\n     * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\r\n     *\r\n     * This option overrides the default `ResultLink` display title behavior.\r\n     *\r\n     * The template literal can reference any number of fields from the parent result. However, if the template literal\r\n     * references a key whose value is undefined in the parent result fields, the `ResultLink` title displays the\r\n     * name of this key instead.\r\n     *\r\n     * This option is ignored if the `ResultLink` innerHTML contains any value.\r\n     *\r\n     * **Examples:**\r\n     *\r\n     * - The following markup generates a `ResultLink` display title such as `Case number: 123456` if both the\r\n     * `raw.objecttype` and `raw.objectnumber` keys are defined in the parent result fields:\r\n     *\r\n     * ```html\r\n     * <a class=\"CoveoResultLink\" data-title-template=\"${raw.objecttype} number: ${raw.objectnumber}\"></a>\r\n     * ```\r\n     *\r\n     * - The following markup generates `${myField}` as a `ResultLink` display title if the `myField` key is undefined\r\n     * in the parent result fields:\r\n     *\r\n     * ```html\r\n     * <a class=\"CoveoResultLink\" data-title-template=\"${myField}\"></a>\r\n     * ```\r\n     *\r\n     * - The following markup generates `Foobar` as a `ResultLink` display title, because the `ResultLink` innterHTML is\r\n     * not empty:\r\n     *\r\n     * ```html\r\n     * <a class=\"CoveoResultLink\" data-title-template=\"${will} ${be} ${ignored}\">Foobar</a>\r\n     * ```\r\n     *\r\n     * Default value is `undefined`.\r\n     *\r\n     * @availablesince [January 2017 Release (v1.1865.9)](https://docs.coveo.com/en/396/#january-2017-release-v118659)\r\n     */\r\n    titleTemplate: ComponentOptions.buildStringOption(),\r\n\r\n    /**\r\n     * Specifies an event handler function to execute when the user clicks the `ResultLink` component.\r\n     *\r\n     * The handler function takes a JavaScript [`Event`](https://developer.mozilla.org/en/docs/Web/API/Event) object and\r\n     * an [`IQueryResult`]{@link IQueryResult} as its parameters.\r\n     *\r\n     * Overriding the default behavior of the `onClick` event can allow you to execute specific code instead.\r\n     *\r\n     * **Note:**\r\n     * > You cannot set this option directly in the component markup as an HTML attribute. You must either set it in the\r\n     * > [`init`]{@link init} call of your search interface (see\r\n     * > [Passing Component Options in the init Call](https://docs.coveo.com/en/346/#passing-component-options-in-the-init-call)),\r\n     * > or before the `init` call, using the `options` top-level function (see\r\n     * > [Passing Component Options Before the init Call](https://docs.coveo.com/en/346/#passing-component-options-before-the-init-call)).\r\n     *\r\n     * **Example:**\r\n     * ```javascript\r\n     * // You can set the option in the 'init' call:\r\n     * Coveo.init(document.querySelector(\"#search\"), {\r\n     *   ResultLink : {\r\n     *     onClick : function(e, result) {\r\n     *       e.preventDefault();\r\n     *       // Custom code to execute with the item URI and title.\r\n     *       openUriInASpecialTab(result.clickUri, result.title);\r\n     *     }\r\n     *   }\r\n     * });\r\n     *\r\n     * // Or before the 'init' call, using the 'options' top-level function:\r\n     * // Coveo.options(document.querySelector('#search'), {\r\n     * //   ResultLink : {\r\n     * //     onClick : function(e, result) {\r\n     * //       e.preventDefault();\r\n     * //       // Custom code to execute with the item URI and title.\r\n     * //       openUriInASpecialTab(result.clickUri, result.title);\r\n     * //     }\r\n     * //   }\r\n     * // });\r\n     * ```\r\n     */\r\n    onClick: ComponentOptions.buildCustomOption<(e: Event, result: IQueryResult) => any>(() => {\r\n      return null;\r\n    })\r\n  };\r\n\r\n  private toExecuteOnOpen: (e?: Event) => void;\r\n\r\n  /**\r\n   * Creates a new `ResultLink` component.\r\n   * @param element The HTMLElement on which to instantiate the component.\r\n   * @param options The options for the `ResultLink` component.\r\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n   * automatically resolved (with a slower execution time).\r\n   * @param result The result to associate the component with.\r\n   * @param os\r\n   */\r\n  constructor(\r\n    public element: HTMLElement,\r\n    public options: IResultLinkOptions,\r\n    public bindings?: IResultsComponentBindings,\r\n    public result?: IQueryResult,\r\n    public os?: OS_NAME\r\n  ) {\r\n    super(element, ResultLink.ID, bindings);\r\n\r\n    const initialOptions = ComponentOptions.initComponentOptions(element, ResultLink, options);\r\n    const resultLinkOptions = this.componentOptionsModel.get(ComponentOptionsModel.attributesEnum.resultLink);\r\n    this.options = extend({}, initialOptions, resultLinkOptions);\r\n\r\n    this.result = result || this.resolveResult();\r\n\r\n    if (this.options.openQuickview == null) {\r\n      this.options.openQuickview = result.raw['connectortype'] == 'ExchangeCrawler' && DeviceUtils.isMobileDevice();\r\n    }\r\n    this.element.setAttribute('tabindex', '0');\r\n\r\n    Assert.exists(this.componentOptionsModel);\r\n    Assert.exists(this.result);\r\n\r\n    if (!this.quickviewShouldBeOpened()) {\r\n      // Bind on multiple \"click\" or \"mouse\" events.\r\n      // Create a function that will be executed only once, so as not to log multiple events\r\n      // Once a result link has been opened, and that we log at least one analytics event,\r\n      // it should not matter if the end user open the same link multiple times with different methods.\r\n      // It's still only one \"click\" event as far as UA is concerned.\r\n      // Also need to handle \"longpress\" on mobile (the contextual menu), which we assume to be 1 s long.\r\n\r\n      const executeOnlyOnce = once(() => this.logOpenDocument());\r\n\r\n      $$(element).on(['contextmenu', 'click', 'mousedown', 'mouseup'], executeOnlyOnce);\r\n      let longPressTimer: number;\r\n      $$(element).on('touchstart', () => {\r\n        longPressTimer = window.setTimeout(executeOnlyOnce, 1000);\r\n      });\r\n      $$(element).on('touchend', () => {\r\n        if (longPressTimer) {\r\n          clearTimeout(longPressTimer);\r\n        }\r\n      });\r\n    }\r\n    this.renderUri(element, result);\r\n    this.bindEventToOpen();\r\n  }\r\n  public renderUri(element: HTMLElement, result?: IQueryResult) {\r\n    if (/^\\s*$/.test(this.element.innerHTML)) {\r\n      const title = this.getDisplayedTitle();\r\n      this.element.innerHTML = title;\r\n      if (!this.element.title) {\r\n        this.element.title = this.getDisplayedTitleAsText();\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * Opens the result in the same window, no matter how the actual component is configured for the end user.\r\n   * @param logAnalytics Specifies whether the method should log an analytics event.\r\n   */\r\n  public openLink(logAnalytics = true) {\r\n    if (logAnalytics) {\r\n      this.logOpenDocument();\r\n    }\r\n    window.location.href = this.getResultUri();\r\n  }\r\n\r\n  /**\r\n   * Opens the result in a new window, no matter how the actual component is configured for the end user.\r\n   * @param logAnalytics Specifies whether the method should log an analytics event.\r\n   */\r\n  public openLinkInNewWindow(logAnalytics = true) {\r\n    if (logAnalytics) {\r\n      this.logOpenDocument();\r\n    }\r\n    window.open(this.getResultUri(), '_blank');\r\n  }\r\n\r\n  /**\r\n   * Tries to open the result in Microsoft Outlook if the result has an `outlookformacuri` or `outlookuri` field.\r\n   *\r\n   * Normally, this implies the result should be a link to an email.\r\n   *\r\n   * If the needed fields are not present, this method does nothing.\r\n   * @param logAnalytics Specifies whether the method should log an analytics event.\r\n   */\r\n  public openLinkInOutlook(logAnalytics = true) {\r\n    if (this.hasOutlookField()) {\r\n      if (logAnalytics) {\r\n        this.logOpenDocument();\r\n      }\r\n      this.openLink();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Opens the link in the same manner the end user would.\r\n   *\r\n   * This essentially simulates a click on the result link.\r\n   *\r\n   * @param logAnalytics Specifies whether the method should log an analytics event.\r\n   */\r\n  public openLinkAsConfigured(logAnalytics = true) {\r\n    if (this.toExecuteOnOpen) {\r\n      if (logAnalytics) {\r\n        this.logOpenDocument();\r\n      }\r\n      this.toExecuteOnOpen();\r\n    }\r\n  }\r\n\r\n  protected bindEventToOpen(): boolean {\r\n    return (\r\n      this.bindOnClickIfNotUndefined() ||\r\n      this.bindOpenQuickviewIfNotUndefined() ||\r\n      this.setHrefIfNotAlready() ||\r\n      this.openLinkThatIsNotAnAnchor()\r\n    );\r\n  }\r\n\r\n  private getDisplayedTitle() {\r\n    if (!this.options.titleTemplate) {\r\n      return this.result.title\r\n        ? HighlightUtils.highlightString(this.result.title, this.result.titleHighlights, null, 'coveo-highlight')\r\n        : this.escapedClickUri;\r\n    } else {\r\n      let newTitle = StringUtils.buildStringTemplateFromResult(this.options.titleTemplate, this.result);\r\n      return newTitle\r\n        ? StreamHighlightUtils.highlightStreamText(newTitle, this.result.termsToHighlight, this.result.phrasesToHighlight)\r\n        : this.escapedClickUri;\r\n    }\r\n  }\r\n\r\n  private getDisplayedTitleAsText() {\r\n    const container = $$('div');\r\n    container.setHtml(this.getDisplayedTitle());\r\n    return container.text();\r\n  }\r\n\r\n  private get escapedClickUri() {\r\n    return escape(this.result.clickUri);\r\n  }\r\n\r\n  private bindOnClickIfNotUndefined() {\r\n    if (this.options.onClick != undefined) {\r\n      this.toExecuteOnOpen = (e: MouseEvent) => {\r\n        this.options.onClick.call(this, e, this.result);\r\n      };\r\n\r\n      new AccessibleButton()\r\n        .withElement(this.element)\r\n        .withLabel(this.result.title)\r\n        .withSelectAction((e: Event) => this.toExecuteOnOpen(e))\r\n        .build();\r\n\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private bindOpenQuickviewIfNotUndefined() {\r\n    if (this.quickviewShouldBeOpened()) {\r\n      this.toExecuteOnOpen = () => {\r\n        $$(this.bindings.resultElement).trigger(ResultListEvents.openQuickview);\r\n      };\r\n\r\n      $$(this.element).on('click', (e: Event) => {\r\n        e.preventDefault();\r\n        this.toExecuteOnOpen();\r\n      });\r\n\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private openLinkThatIsNotAnAnchor() {\r\n    if (!this.elementIsAnAnchor()) {\r\n      this.toExecuteOnOpen = () => {\r\n        if (this.options.alwaysOpenInNewWindow) {\r\n          if (this.options.openInOutlook) {\r\n            this.openLinkInOutlook();\r\n          } else {\r\n            this.openLinkInNewWindow();\r\n          }\r\n        } else {\r\n          this.openLink();\r\n        }\r\n      };\r\n\r\n      $$(this.element).on('click', () => {\r\n        this.toExecuteOnOpen();\r\n      });\r\n\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private setHrefIfNotAlready() {\r\n    // Do not erase any value put in href by the template, etc. Allows\r\n    // using custom click urls while still keeping analytics recording\r\n    // and other behavior brought by the component.\r\n    if (this.elementIsAnAnchor() && !Utils.isNonEmptyString($$(this.element).getAttribute('href'))) {\r\n      $$(this.element).setAttribute('href', this.getResultUri());\r\n      if (this.options.alwaysOpenInNewWindow && !(this.options.openInOutlook && this.hasOutlookField())) {\r\n        $$(this.element).setAttribute('target', '_blank');\r\n      }\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private logOpenDocument = debounce(\r\n    () => {\r\n      this.queryController.saveLastQuery();\r\n      let documentURL = $$(this.element).getAttribute('href');\r\n      if (documentURL == undefined || documentURL == '') {\r\n        documentURL = this.escapedClickUri;\r\n      }\r\n      this.usageAnalytics.logClickEvent(\r\n        analyticsActionCauseList.documentOpen,\r\n        {\r\n          documentURL: documentURL,\r\n          documentTitle: this.result.title,\r\n          author: Utils.getFieldValue(this.result, 'author')\r\n        },\r\n        this.result,\r\n        this.root\r\n      );\r\n      Defer.flush();\r\n    },\r\n    1500,\r\n    true\r\n  );\r\n\r\n  private filterProtocol(uri: string) {\r\n    const isAbsolute = /^(https?|ftp|file|mailto|tel):/i.test(uri);\r\n    const isRelative = /^\\//.test(uri);\r\n\r\n    return isAbsolute || isRelative ? uri : '';\r\n  }\r\n\r\n  private getResultUri(): string {\r\n    if (this.options.hrefTemplate) {\r\n      const uri = StringUtils.buildStringTemplateFromResult(this.options.hrefTemplate, this.result);\r\n      return this.filterProtocol(uri);\r\n    }\r\n\r\n    if (this.options.field == undefined && this.options.openInOutlook) {\r\n      this.setField();\r\n    }\r\n\r\n    if (this.options.field != undefined) {\r\n      return this.filterProtocol(Utils.getFieldValue(this.result, <string>this.options.field));\r\n    }\r\n\r\n    return this.filterProtocol(this.result.clickUri);\r\n  }\r\n\r\n  private elementIsAnAnchor() {\r\n    return this.element.tagName == 'A';\r\n  }\r\n\r\n  private setField() {\r\n    let os = Utils.exists(this.os) ? this.os : OSUtils.get();\r\n    if (os == OS_NAME.MACOSX && this.hasOutlookField()) {\r\n      this.options.field = '@outlookformacuri';\r\n    } else if (os == OS_NAME.WINDOWS && this.hasOutlookField()) {\r\n      this.options.field = '@outlookuri';\r\n    }\r\n  }\r\n\r\n  private hasOutlookField() {\r\n    let os = Utils.exists(this.os) ? this.os : OSUtils.get();\r\n    if (os == OS_NAME.MACOSX && this.result.raw['outlookformacuri'] != undefined) {\r\n      return true;\r\n    } else if (os == OS_NAME.WINDOWS && this.result.raw['outlookuri'] != undefined) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private isUriThatMustBeOpenedInQuickview(): boolean {\r\n    return this.escapedClickUri.toLowerCase().indexOf('ldap://') == 0;\r\n  }\r\n\r\n  private quickviewShouldBeOpened() {\r\n    return (this.options.openQuickview || this.isUriThatMustBeOpenedInQuickview()) && QueryUtils.hasHTMLVersion(this.result);\r\n  }\r\n}\r\n\r\nInitialization.registerAutoCreateComponent(ResultLink);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResultLink/ResultLink.ts"],"sourceRoot":""}
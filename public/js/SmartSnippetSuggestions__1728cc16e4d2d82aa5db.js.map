{"version":3,"sources":["./src/ui/SmartSnippet/SmartSnippetSuggestions.ts","./src/misc/AttachShadowPolyfill.ts","./sass/_AttachShadowPolyfill.scss","./sass/_SmartSnippetSuggestions.scss","./src/ui/SmartSnippet/SmartSnippetCollapsibleSuggestion.ts"],"names":[],"mappings":"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","file":"SmartSnippetSuggestions__1728cc16e4d2d82aa5db.js","sourcesContent":["import 'styling/_SmartSnippetSuggestions';\r\nimport { Component } from '../Base/Component';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\nimport { QueryEvents, IQuerySuccessEventArgs } from '../../events/QueryEvents';\r\nimport { IPartialQuestionAnswerResponse, IQuestionAnswerResponse } from '../../rest/QuestionAnswerResponse';\r\nimport { $$, Dom } from '../../utils/Dom';\r\nimport { uniqueId, isEqual, find } from 'underscore';\r\nimport { SmartSnippetCollapsibleSuggestion } from './SmartSnippetCollapsibleSuggestion';\r\nimport { l } from '../../strings/Strings';\r\nimport { Initialization } from '../Base/Initialization';\r\n\r\nconst BASE_CLASSNAME = 'coveo-smart-snippet-suggestions';\r\nconst HAS_QUESTIONS_CLASSNAME = `${BASE_CLASSNAME}-has-questions`;\r\nconst QUESTIONS_LIST_CLASSNAME = `${BASE_CLASSNAME}-questions`;\r\nconst QUESTIONS_LIST_TITLE_CLASSNAME = `${QUESTIONS_LIST_CLASSNAME}-title`;\r\n\r\nexport const SmartSnippetSuggestionsClassNames = {\r\n  HAS_QUESTIONS_CLASSNAME,\r\n  QUESTIONS_LIST_CLASSNAME,\r\n  QUESTIONS_LIST_TITLE_CLASSNAME\r\n};\r\n\r\nexport class SmartSnippetSuggestions extends Component {\r\n  static ID = 'SmartSnippetSuggestions';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      SmartSnippetSuggestions\r\n    });\r\n  };\r\n\r\n  private readonly titleId = uniqueId(QUESTIONS_LIST_TITLE_CLASSNAME);\r\n  private contentLoaded: Promise<any>;\r\n  private title: Dom;\r\n  private questionAnswers: Dom;\r\n  private renderedQuestionAnswer: IQuestionAnswerResponse;\r\n\r\n  constructor(public element: HTMLElement, public options?: {}, bindings?: IComponentBindings) {\r\n    super(element, SmartSnippetSuggestions.ID, bindings);\r\n    this.bind.onRootElement(QueryEvents.deferredQuerySuccess, (data: IQuerySuccessEventArgs) => this.handleQuerySuccess(data));\r\n  }\r\n\r\n  public get loading() {\r\n    return this.contentLoaded;\r\n  }\r\n\r\n  /**\r\n   * @warning This method only works for the demo. In practice, the source of the answer will not always be part of the results.\r\n   */\r\n  private getCorrespondingResult(questionAnswer: IPartialQuestionAnswerResponse) {\r\n    return find(\r\n      this.queryController.getLastResults().results,\r\n      result => result.raw[questionAnswer.documentId.contentIdKey] === questionAnswer.documentId.contentIdValue\r\n    );\r\n  }\r\n\r\n  private handleQuerySuccess(data: IQuerySuccessEventArgs) {\r\n    const questionAnswer = data.results.questionAnswer;\r\n    const hasQuestions = !!(questionAnswer && questionAnswer.relatedQuestions.length);\r\n    $$(this.element).toggleClass(HAS_QUESTIONS_CLASSNAME, hasQuestions);\r\n    if (hasQuestions) {\r\n      if (this.renderedQuestionAnswer && isEqual(questionAnswer, this.renderedQuestionAnswer)) {\r\n        return;\r\n      }\r\n      this.detachContent();\r\n      this.element.appendChild((this.title = this.buildTitle()).el);\r\n      this.element.appendChild((this.questionAnswers = this.buildQuestionAnswers(questionAnswer.relatedQuestions)).el);\r\n    } else {\r\n      this.detachContent();\r\n    }\r\n    this.renderedQuestionAnswer = questionAnswer;\r\n  }\r\n\r\n  private detachContent() {\r\n    this.title && this.title.detach();\r\n    this.questionAnswers && this.questionAnswers.detach();\r\n    this.title = this.questionAnswers = null;\r\n  }\r\n\r\n  private buildTitle() {\r\n    return $$('span', { className: QUESTIONS_LIST_TITLE_CLASSNAME, id: this.titleId }, l('SuggestedQuestions'));\r\n  }\r\n\r\n  private buildQuestionAnswers(questionAnswers: IPartialQuestionAnswerResponse[]) {\r\n    const innerCSS = this.getInnerCSS();\r\n    const answers = questionAnswers.map(\r\n      questionAnswer => new SmartSnippetCollapsibleSuggestion(questionAnswer, innerCSS, this.getCorrespondingResult(questionAnswer))\r\n    );\r\n    const container = $$(\r\n      'ul',\r\n      { className: QUESTIONS_LIST_CLASSNAME, ariaLabelledby: this.titleId },\r\n      ...answers.map(answer => answer.build())\r\n    );\r\n    this.contentLoaded = Promise.all(answers.map(answer => answer.loading));\r\n    return container;\r\n  }\r\n\r\n  private getInnerCSS() {\r\n    return $$(this.element)\r\n      .children()\r\n      .filter(element => element instanceof HTMLScriptElement && element.type.toLowerCase() === 'text/css')\r\n      .map(element => element.innerHTML)\r\n      .join('\\n');\r\n  }\r\n}\r\n\r\nInitialization.registerAutoCreateComponent(SmartSnippetSuggestions);\r\nSmartSnippetSuggestions.doExport();\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/SmartSnippetSuggestions.ts","import { $$ } from '../utils/Dom';\r\nimport 'styling/_AttachShadowPolyfill';\r\n\r\nexport async function attachShadow(element: HTMLElement, init: ShadowRootInit & { title: string }): Promise<HTMLElement> {\r\n  const iframe = $$('iframe', { className: 'coveo-shadow-iframe', scrolling: 'no', title: init.title }).el as HTMLIFrameElement;\r\n  const onLoad = new Promise(resolve => iframe.addEventListener('load', () => resolve()));\r\n  element.appendChild(iframe);\r\n  await onLoad;\r\n\r\n  const iframeBody = iframe.contentDocument.body as HTMLBodyElement;\r\n  iframeBody.style.margin = '0';\r\n  const shadowRoot = $$('div', { style: 'overflow: auto;' }).el;\r\n  iframeBody.appendChild(shadowRoot);\r\n  autoUpdateHeight(iframe, shadowRoot);\r\n  if (init.mode === 'open') {\r\n    Object.defineProperty(element, 'shadowRoot', { get: () => shadowRoot });\r\n  }\r\n\r\n  return shadowRoot;\r\n}\r\n\r\nfunction autoUpdateHeight(elementToResize: HTMLElement, content: HTMLElement) {\r\n  const heightObserver = new MutationObserver(() => {\r\n    elementToResize.style.height = `${content.clientHeight}px`;\r\n  });\r\n  heightObserver.observe(content, {\r\n    attributes: true,\r\n    characterData: true,\r\n    childList: true,\r\n    subtree: true\r\n  });\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/misc/AttachShadowPolyfill.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_AttachShadowPolyfill.scss\n// module id = 582\n// module chunks = 19 28 88","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_SmartSnippetSuggestions.scss\n// module id = 702\n// module chunks = 28 88","import { IPartialQuestionAnswerResponse } from '../../rest/QuestionAnswerResponse';\r\nimport { uniqueId } from 'underscore';\r\nimport { AccessibleButton } from '../../utils/AccessibleButton';\r\nimport { SVGIcons } from '../../utils/SVGIcons';\r\nimport { attachShadow } from '../../misc/AttachShadowPolyfill';\r\nimport { $$, Dom } from '../../utils/Dom';\r\nimport { l } from '../../strings/Strings';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\n\r\nconst QUESTION_CLASSNAME = `coveo-smart-snippet-suggestions-question`;\r\nconst QUESTION_TITLE_CLASSNAME = `${QUESTION_CLASSNAME}-title`;\r\nconst QUESTION_TITLE_LABEL_CLASSNAME = `${QUESTION_TITLE_CLASSNAME}-label`;\r\nconst QUESTION_TITLE_CHECKBOX_CLASSNAME = `${QUESTION_TITLE_CLASSNAME}-checkbox`;\r\nconst QUESTION_SNIPPET_CLASSNAME = `${QUESTION_CLASSNAME}-snippet`;\r\nconst QUESTION_SNIPPET_HIDDEN_CLASSNAME = `${QUESTION_SNIPPET_CLASSNAME}-hidden`;\r\nconst SHADOW_CLASSNAME = `${QUESTION_SNIPPET_CLASSNAME}-content`;\r\nconst RAW_CONTENT_CLASSNAME = `${SHADOW_CLASSNAME}-raw`;\r\nconst SOURCE_CLASSNAME = `${QUESTION_CLASSNAME}-source`;\r\nconst SOURCE_TITLE_CLASSNAME = `${SOURCE_CLASSNAME}-title`;\r\nconst SOURCE_URL_CLASSNAME = `${SOURCE_CLASSNAME}-url`;\r\n\r\nexport const SmartSnippetCollapsibleSuggestionClassNames = {\r\n  QUESTION_CLASSNAME,\r\n  QUESTION_TITLE_CLASSNAME,\r\n  QUESTION_TITLE_LABEL_CLASSNAME,\r\n  QUESTION_TITLE_CHECKBOX_CLASSNAME,\r\n  QUESTION_SNIPPET_CLASSNAME,\r\n  QUESTION_SNIPPET_HIDDEN_CLASSNAME,\r\n  SHADOW_CLASSNAME,\r\n  RAW_CONTENT_CLASSNAME,\r\n  SOURCE_CLASSNAME,\r\n  SOURCE_TITLE_CLASSNAME,\r\n  SOURCE_URL_CLASSNAME\r\n};\r\n\r\nexport class SmartSnippetCollapsibleSuggestion {\r\n  private readonly labelId = uniqueId(QUESTION_TITLE_LABEL_CLASSNAME);\r\n  private readonly snippetId = uniqueId(QUESTION_SNIPPET_CLASSNAME);\r\n  private readonly checkboxId = uniqueId(QUESTION_TITLE_CHECKBOX_CLASSNAME);\r\n  private contentLoaded: Promise<void>;\r\n  private collapsibleContainer: Dom;\r\n  private checkbox: Dom;\r\n  private expanded = false;\r\n\r\n  constructor(\r\n    private readonly questionAnswer: IPartialQuestionAnswerResponse,\r\n    private readonly innerCSS?: string,\r\n    private readonly source?: IQueryResult\r\n  ) {}\r\n\r\n  public get loading() {\r\n    return this.contentLoaded;\r\n  }\r\n\r\n  public build() {\r\n    const collapsibleContainer = this.buildCollapsibleContainer(\r\n      this.questionAnswer.answerSnippet,\r\n      this.questionAnswer.question,\r\n      this.innerCSS && this.buildStyle(this.innerCSS)\r\n    );\r\n    const title = this.buildTitle(this.questionAnswer.question);\r\n    this.updateExpanded();\r\n    return $$(\r\n      'li',\r\n      {\r\n        className: QUESTION_CLASSNAME,\r\n        ariaLabelledby: this.labelId\r\n      },\r\n      title,\r\n      collapsibleContainer\r\n    ).el as HTMLLIElement;\r\n  }\r\n\r\n  private buildStyle(innerCSS: string) {\r\n    const styleTag = document.createElement('style');\r\n    styleTag.innerHTML = innerCSS;\r\n    return styleTag;\r\n  }\r\n\r\n  private buildTitle(question: string) {\r\n    const checkbox = this.buildCheckbox(question);\r\n    const label = $$('span', { className: QUESTION_TITLE_LABEL_CLASSNAME, id: this.labelId });\r\n    label.text(question);\r\n    const title = $$('span', { className: QUESTION_TITLE_CLASSNAME }, label, checkbox);\r\n    title.on('click', () => this.toggle());\r\n    return title;\r\n  }\r\n\r\n  private buildCheckbox(question: string) {\r\n    this.checkbox = $$('div', {\r\n      role: 'button',\r\n      tabindex: 0,\r\n      ariaControls: this.snippetId,\r\n      className: QUESTION_TITLE_CHECKBOX_CLASSNAME,\r\n      id: this.checkboxId\r\n    });\r\n    new AccessibleButton()\r\n      .withElement(this.checkbox)\r\n      .withLabel(l('ExpandQuestionAnswer', question))\r\n      .withEnterKeyboardAction(() => this.toggle())\r\n      .build();\r\n    return this.checkbox;\r\n  }\r\n\r\n  private buildCollapsibleContainer(innerHTML: string, title: string, style?: HTMLStyleElement) {\r\n    const shadowContainer = $$('div', { className: SHADOW_CLASSNAME });\r\n    this.collapsibleContainer = $$('div', { className: QUESTION_SNIPPET_CLASSNAME, id: this.snippetId }, shadowContainer);\r\n    this.contentLoaded = attachShadow(shadowContainer.el, { mode: 'open', title: l('AnswerSpecificSnippet', title) }).then(shadowRoot => {\r\n      shadowRoot.appendChild(this.buildAnswerSnippetContent(innerHTML, style).el);\r\n    });\r\n    if (this.source) {\r\n      this.collapsibleContainer.append(this.buildSourceUrl(this.source.clickUri));\r\n      this.collapsibleContainer.append(this.buildSourceTitle(this.source.title, this.source.clickUri));\r\n    }\r\n    return this.collapsibleContainer;\r\n  }\r\n\r\n  private buildAnswerSnippetContent(innerHTML: string, style?: HTMLStyleElement) {\r\n    const snippet = $$('div', { className: RAW_CONTENT_CLASSNAME }, innerHTML);\r\n    const container = $$('div', {}, snippet);\r\n    if (style) {\r\n      container.append(style);\r\n    }\r\n    return container;\r\n  }\r\n\r\n  private buildSourceTitle(title: string, clickUri: string) {\r\n    return this.buildLink(title, clickUri, SOURCE_TITLE_CLASSNAME);\r\n  }\r\n\r\n  private buildSourceUrl(url: string) {\r\n    return this.buildLink(url, url, SOURCE_URL_CLASSNAME);\r\n  }\r\n\r\n  private buildLink(text: string, href: string, className: string) {\r\n    const element = $$('a', { className, href }).el as HTMLAnchorElement;\r\n    element.innerText = text;\r\n    return element;\r\n  }\r\n\r\n  private toggle() {\r\n    this.expanded = !this.expanded;\r\n    this.updateExpanded();\r\n  }\r\n\r\n  private updateExpanded() {\r\n    this.checkbox.setAttribute('aria-expanded', this.expanded.toString());\r\n    this.checkbox.setHtml(this.expanded ? SVGIcons.icons.arrowUp : SVGIcons.icons.arrowDown);\r\n    this.collapsibleContainer.setAttribute('tabindex', `${this.expanded ? 0 : -1}`);\r\n    this.collapsibleContainer.setAttribute('aria-hidden', (!this.expanded).toString());\r\n    this.collapsibleContainer.toggleClass(QUESTION_SNIPPET_HIDDEN_CLASSNAME, !this.expanded);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/SmartSnippetCollapsibleSuggestion.ts"],"sourceRoot":""}
{"version":3,"sources":["./src/ui/Settings/Settings.ts","./sass/_Settings.scss"],"names":[],"mappings":"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","file":"Settings__1728cc16e4d2d82aa5db.js","sourcesContent":["import PopperJs from 'popper.js';\r\nimport 'styling/_Settings';\r\nimport { each, escape, times } from 'underscore';\r\nimport { InitializationEvents } from '../../events/InitializationEvents';\r\nimport { SettingsEvents } from '../../events/SettingsEvents';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { l } from '../../strings/Strings';\r\nimport { AccessibleButton } from '../../utils/AccessibleButton';\r\nimport { $$ } from '../../utils/Dom';\r\nimport { SVGDom } from '../../utils/SVGDom';\r\nimport { Component } from '../Base/Component';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { Initialization } from '../Base/Initialization';\r\nimport { IMenuItem } from '../Menu/MenuItem';\r\n\r\nexport interface ISettingsPopulateMenuArgs {\r\n  settings: Settings;\r\n  menuData: IMenuItem[];\r\n}\r\n\r\nexport interface ISettingsOptions {\r\n  menuDelay: number;\r\n}\r\n\r\n/**\r\n * The Settings component renders a **Settings** button that the end user can click to access a popup menu from which\r\n * it is possible to perform several contextual actions. The usual location of the **Settings** button in the page is to\r\n * the right of the {@link Searchbox}.\r\n *\r\n * This component can reference several components to populate its popup menu:\r\n * - {@link AdvancedSearch}\r\n * - {@link ExportToExcel}\r\n * - {@link PreferencesPanel} (see also {@link ResultsFiltersPreferences} and {@link ResultsPreferences})\r\n * - {@link SearchAlerts} (see also {@link SearchAlertsMessage})\r\n * - {@link ShareQuery}\r\n */\r\nexport class Settings extends Component {\r\n  static ID = 'Settings';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      Settings: Settings\r\n    });\r\n  };\r\n\r\n  /**\r\n   * The options for Settings\r\n   * @componentOptions\r\n   */\r\n  static options: ISettingsOptions = {\r\n    /**\r\n     * Specifies the delay (in milliseconds) before hiding the popup menu when the cursor is not hovering over it.\r\n     *\r\n     * Default value is `300`. Minimum value is `0 `.\r\n     */\r\n    menuDelay: ComponentOptions.buildNumberOption({ defaultValue: 300, min: 0 })\r\n  };\r\n\r\n  private menu: HTMLElement;\r\n  private closeTimeout: number;\r\n  private isOpened: boolean = false;\r\n\r\n  /**\r\n   * Creates a new Settings component.\r\n   * @param element The HTMLElement on which to instantiate the component.\r\n   * @param options The options for the Settings component.\r\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n   * automatically resolved (with a slower execution time).\r\n   */\r\n  constructor(public element: HTMLElement, public options: ISettingsOptions, bindings?: IComponentBindings) {\r\n    super(element, Settings.ID, bindings);\r\n    this.options = ComponentOptions.initComponentOptions(element, Settings, options);\r\n    this.bind.onRootElement(InitializationEvents.afterInitialization, () => this.init());\r\n  }\r\n\r\n  /**\r\n   * Opens the **Settings** popup menu.\r\n   */\r\n  public open() {\r\n    this.isOpened = true;\r\n    if (this.menu != null) {\r\n      $$(this.menu).detach();\r\n    }\r\n\r\n    this.menu = this.buildMenu();\r\n    $$(this.menu).insertAfter(this.element);\r\n\r\n    new PopperJs(this.element, this.menu, {\r\n      placement: 'bottom-end',\r\n      modifiers: {\r\n        offset: {\r\n          offset: '0, 5'\r\n        },\r\n        preventOverflow: {\r\n          boundariesElement: this.root\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Closes the **Settings** popup menu.\r\n   */\r\n  public close() {\r\n    this.isOpened = false;\r\n    if (this.menu != null) {\r\n      $$(this.menu).detach();\r\n      this.menu = null;\r\n    }\r\n  }\r\n\r\n  private toggle() {\r\n    if (this.isOpened) {\r\n      this.close();\r\n    } else {\r\n      this.open();\r\n    }\r\n  }\r\n\r\n  private init() {\r\n    const square = $$('span', { className: 'coveo-settings-square' }).el;\r\n    const squares = $$('span', { className: 'coveo-settings-squares' }).el;\r\n    times(3, () => squares.appendChild(square.cloneNode()));\r\n    this.element.appendChild(squares);\r\n\r\n    new AccessibleButton()\r\n      .withElement(this.element)\r\n      .withOwner(this.bind)\r\n      .withSelectAction(() => this.toggle())\r\n      .withFocusAndMouseEnterAction(() => this.onfocus())\r\n      .withBlurAndMouseLeaveAction(() => this.onblur())\r\n      .withLabel(l('Settings'))\r\n      .build();\r\n  }\r\n\r\n  private buildMenu(): HTMLElement {\r\n    const menu = $$('div', { className: 'coveo-settings-advanced-menu' }).el;\r\n    const settingsPopulateMenuArgs: ISettingsPopulateMenuArgs = {\r\n      settings: this,\r\n      menuData: []\r\n    };\r\n    $$(this.root).trigger(SettingsEvents.settingsPopulateMenu, settingsPopulateMenuArgs);\r\n\r\n    each(settingsPopulateMenuArgs.menuData, menuItem => {\r\n      const { menuItemElement, menuItemIcon, menuItemText } = this.buildMenuItem(menuItem, settingsPopulateMenuArgs);\r\n\r\n      menuItemElement.appendChild(menuItemIcon);\r\n      menuItemElement.appendChild(menuItemText);\r\n\r\n      menu.appendChild(menuItemElement);\r\n    });\r\n    return menu;\r\n  }\r\n\r\n  private buildMenuItem(menuItem: IMenuItem, settingsPopulateMenuArgs: ISettingsPopulateMenuArgs) {\r\n    const menuItemElement = $$('div', {\r\n      className: `coveo-settings-item ${menuItem.className}`\r\n    }).el;\r\n\r\n    const selectAction = () => {\r\n      each(settingsPopulateMenuArgs.menuData, menuItem => {\r\n        menuItem.onClose && menuItem.onClose();\r\n      });\r\n      this.close();\r\n      menuItem.onOpen();\r\n    };\r\n\r\n    new AccessibleButton()\r\n      .withElement(menuItemElement)\r\n      .withSelectAction(selectAction)\r\n      .withFocusAndMouseEnterAction(() => this.onfocus())\r\n      .withBlurAndMouseLeaveAction(() => this.onblur())\r\n      .withLabel(menuItem.tooltip || menuItem.text)\r\n      .build();\r\n\r\n    return {\r\n      menuItemElement,\r\n      menuItemIcon: this.buildMenuItemIcon(menuItem),\r\n      menuItemText: this.buildMenuItemText(menuItem)\r\n    };\r\n  }\r\n\r\n  private buildMenuItemIcon(menuItem: IMenuItem) {\r\n    const iconElement = $$('div', {\r\n      className: 'coveo-icon'\r\n    }).el;\r\n\r\n    if (menuItem.svgIcon) {\r\n      iconElement.innerHTML = menuItem.svgIcon;\r\n    }\r\n\r\n    if (menuItem.svgIconClassName) {\r\n      SVGDom.addClassToSVGInContainer(iconElement, menuItem.svgIconClassName);\r\n    }\r\n\r\n    return iconElement;\r\n  }\r\n\r\n  private buildMenuItemText(menuItem: IMenuItem) {\r\n    const textElement = $$(\r\n      'div',\r\n      {\r\n        className: 'coveo-settings-text'\r\n      },\r\n      escape(menuItem.text)\r\n    ).el;\r\n\r\n    return textElement;\r\n  }\r\n\r\n  private onblur() {\r\n    clearTimeout(this.closeTimeout);\r\n    this.closeTimeout = window.setTimeout(() => {\r\n      this.close();\r\n    }, this.options.menuDelay);\r\n  }\r\n\r\n  private onfocus() {\r\n    clearTimeout(this.closeTimeout);\r\n  }\r\n}\r\nInitialization.registerAutoCreateComponent(Settings);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Settings/Settings.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_Settings.scss\n// module id = 666\n// module chunks = 60 88"],"sourceRoot":""}
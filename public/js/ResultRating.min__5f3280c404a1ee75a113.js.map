{"version":3,"sources":["ResultRating.min__5f3280c404a1ee75a113.js","./src/ui/ResultRating/ResultRating.ts"],"names":["webpackJsonpCoveo__temporary","270","module","exports","__webpack_require__","__extends","this","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","value","RatingValues","element","options","bindings","result","ResultRating","ID","ComponentOptions","initComponentOptions","Utils","isNullOrUndefined","rating","renderComponent","_this","starNumber","renderStar","isChecked","star","starElement","$$","find","className","SVGIcons","icons","SVGDom","addClassToSVGInContainer","el","appendChild","searchInterface","enableCollaborativeRating","AccessibleButton","withElement","withSelectAction","e","targetElement","currentTarget","rateDocument","parseInt","getAttribute","withLabel","toString","build","on","setAttribute","toggleClass","request","uniqueId","queryController","getEndpoint","then","catch","logger","error","doExport","exportGlobally","Component","Initialization","registerAutoCreateComponent","657"],"mappings":"AAAAA,8BAA8B,KAExBC,IACA,SAAUC,EAAQC,EAASC,GAEjC,YAEA,IAAIC,GAAaC,MAAQA,KAAKD,WAAc,WACxC,GAAIE,GAAgBC,OAAOC,iBACpBC,uBAA2BC,QAAS,SAAUC,EAAGC,GAAKD,EAAEF,UAAYG,IACvE,SAAUD,EAAGC,GAAK,IAAK,GAAIC,KAAKD,GAAOA,EAAEE,eAAeD,KAAIF,EAAEE,GAAKD,EAAEC,IACzE,OAAO,UAAUF,EAAGC,GAEhB,QAASG,KAAOV,KAAKW,YAAcL,EADnCL,EAAcK,EAAGC,GAEjBD,EAAEM,UAAkB,OAANL,EAAaL,OAAOW,OAAON,IAAMG,EAAGE,UAAYL,EAAEK,UAAW,GAAIF,OAGvFR,QAAOY,eAAejB,EAAS,cAAgBkB,OAAO,ICjBtD,MACA,IAaYC,GAbZ,OAGA,QACA,OACA,QACA,QACA,OACA,OAEA,OACA,QAEA,SAAYA,GACV,6BACA,uBACA,iBACA,yBACA,mBACA,oBANUA,EAAA,EAAAA,eAAA,EAAAA,iBAuBZ,mBAiBE,WACSC,EACAC,EACAC,EACAC,GAJT,MAME,YAAMH,EAASI,EAAaC,GAAIH,IAAS,IDUrC,OCfG,GAAAF,UACA,EAAAC,UACA,EAAAC,WACA,EAAAC,SAGP,EAAKF,QAAU,EAAAK,iBAAiBC,qBAAqBP,EAASI,EAAcH,GAEvE,EAAAO,MAAMC,kBAAkBN,EAAOO,SAClC,EAAKC,gBAAgBX,EAASG,EAAOO,QDM5BE,ECsEf,MAvGkC,QA+BxB,YAAAD,gBAAR,SAAwBX,EAAsBU,GAC5C,IAAK,GAAIG,GAAa,EAAGA,GAAc,EAAGA,IACxC9B,KAAK+B,WAAWd,EAASa,GAAcH,EAAQG,IAI3C,YAAAC,WAAR,SAAmBd,EAAsBe,EAAoBjB,GAA7D,GACMkB,GADN,OAEQC,EAAc,EAAAC,GAAGlB,GAASmB,KAAK,mBAAqBrB,EAAQ,KAC/C,OAAfmB,GACFD,EAAO,EAAAE,GAAG,KAAOE,UAAW,4BAA8B,EAAAC,SAASC,MAAMN,MACzE,EAAAO,OAAOC,yBAAyBR,EAAKS,GAAI,gCACzCzB,EAAQ0B,YAAYV,EAAKS,IAErB1C,KAAKmB,SAASyB,gBAAgB1B,QAAQ2B,6BACxC,GAAI,GAAAC,kBACDC,YAAYd,GACZe,iBAAiB,SAAAC,GAChB,GAAMC,GAA0CD,EAAEE,aAClD,GAAKC,aAAaC,SAASH,EAAcI,aAAa,oBAEvDC,UAAUxC,EAAMyC,YAChBC,QAEHxB,EAAKyB,GAAG,YAAa,SAAAT,GACnB,GAAMC,GAA0CD,EAAEE,aAClD,GAAKvB,gBAAgBX,EAASoC,SAASH,EAAcI,aAAa,oBAGpErB,EAAKyB,GAAG,WAAY,WAClB,EAAK9B,gBAAgBX,EAAS,EAAKG,OAAOO,WAI9CM,EAAKS,GAAGiB,aAAa,eAAgB5C,EAAMyC,aAE3CvB,EAAO,EAAAE,GAAGD,GAGZD,EAAK2B,YAAY,kCAAmC5B,IAgB/C,YAAAoB,aAAP,SAAoBzB,GAApB,WACQkC,GACJlC,OAAQX,EAAaW,GACrBmC,SAAU9D,KAAKoB,OAAO0C,SAGxB9D,MAAK+D,gBACFC,cACAZ,aAAaS,GACbI,KAAK,WACJ,EAAK7C,OAAOO,OAASA,EACrB,EAAKC,gBAAgB,EAAKX,QAASU,KAEpCuC,MAAM,WACL,EAAKC,OAAOC,MAAM,8CAnGjB,EAAA9C,GAAK,eAEL,EAAA+C,SAAW,WAChB,EAAAC,gBACEjD,aAAcA,KAkGpB,GAvGkC,EAAAkD,UAArB,GAAAlD,eAyGb,EAAAmD,eAAeC,4BAA4BpD,IDWrCqD,IACA,SAAU9E,EAAQC","file":"ResultRating.min__5f3280c404a1ee75a113.js","sourcesContent":["webpackJsonpCoveo__temporary([62],{\n\n/***/ 270:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n__webpack_require__(657);\r\nvar GlobalExports_1 = __webpack_require__(3);\r\nvar AccessibleButton_1 = __webpack_require__(15);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar SVGDom_1 = __webpack_require__(16);\r\nvar SVGIcons_1 = __webpack_require__(12);\r\nvar Utils_1 = __webpack_require__(4);\r\nvar Component_1 = __webpack_require__(7);\r\nvar ComponentOptions_1 = __webpack_require__(8);\r\nvar Initialization_1 = __webpack_require__(2);\r\nvar RatingValues;\r\n(function (RatingValues) {\r\n    RatingValues[RatingValues[\"Undefined\"] = 0] = \"Undefined\";\r\n    RatingValues[RatingValues[\"Lowest\"] = 1] = \"Lowest\";\r\n    RatingValues[RatingValues[\"Low\"] = 2] = \"Low\";\r\n    RatingValues[RatingValues[\"Average\"] = 3] = \"Average\";\r\n    RatingValues[RatingValues[\"Good\"] = 4] = \"Good\";\r\n    RatingValues[RatingValues[\"Best\"] = 5] = \"Best\";\r\n})(RatingValues = exports.RatingValues || (exports.RatingValues = {}));\r\n/**\r\n * **Note:**\r\n *\r\n * > The Coveo Cloud V2 platform does not support collaborative rating. Therefore, this component is obsolete in Coveo Cloud V2.\r\n *\r\n * The `ResultRating` component renders a 5-star rating widget. Interactive rating is possible if\r\n * the [`enableCollaborativeRating`]{@link SearchInterface.options.enableCollaborativeRating} option of your\r\n * search interface is `true`, and if collaborative rating is enabled on your Coveo index.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n *\r\n * @notSupportedIn salesforcefree\r\n */\r\nvar ResultRating = /** @class */ (function (_super) {\r\n    __extends(ResultRating, _super);\r\n    /**\r\n     * Creates a new `ResultRating` component.\r\n     * @param element The HTMLElement on which to instantiate the component.\r\n     * @param options The options for the `ResultRating` component.\r\n     * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n     * automatically resolved (with a slower execution time).\r\n     * @param result The result to associate the component with.\r\n     */\r\n    function ResultRating(element, options, bindings, result) {\r\n        var _this = _super.call(this, element, ResultRating.ID, bindings) || this;\r\n        _this.element = element;\r\n        _this.options = options;\r\n        _this.bindings = bindings;\r\n        _this.result = result;\r\n        _this.options = ComponentOptions_1.ComponentOptions.initComponentOptions(element, ResultRating, options);\r\n        if (!Utils_1.Utils.isNullOrUndefined(result.rating)) {\r\n            _this.renderComponent(element, result.rating);\r\n        }\r\n        return _this;\r\n    }\r\n    ResultRating.prototype.renderComponent = function (element, rating) {\r\n        for (var starNumber = 1; starNumber <= 5; starNumber++) {\r\n            this.renderStar(element, starNumber <= rating, starNumber);\r\n        }\r\n    };\r\n    ResultRating.prototype.renderStar = function (element, isChecked, value) {\r\n        var _this = this;\r\n        var star;\r\n        var starElement = Dom_1.$$(element).find('a[rating-value=\"' + value + '\"]');\r\n        if (starElement == null) {\r\n            star = Dom_1.$$('a', { className: 'coveo-result-rating-star' }, SVGIcons_1.SVGIcons.icons.star);\r\n            SVGDom_1.SVGDom.addClassToSVGInContainer(star.el, 'coveo-result-rating-star-svg');\r\n            element.appendChild(star.el);\r\n            if (this.bindings.searchInterface.options.enableCollaborativeRating) {\r\n                new AccessibleButton_1.AccessibleButton()\r\n                    .withElement(star)\r\n                    .withSelectAction(function (e) {\r\n                    var targetElement = e.currentTarget;\r\n                    _this.rateDocument(parseInt(targetElement.getAttribute('rating-value')));\r\n                })\r\n                    .withLabel(value.toString())\r\n                    .build();\r\n                star.on('mouseover', function (e) {\r\n                    var targetElement = e.currentTarget;\r\n                    _this.renderComponent(element, parseInt(targetElement.getAttribute('rating-value')));\r\n                });\r\n                star.on('mouseout', function () {\r\n                    _this.renderComponent(element, _this.result.rating);\r\n                });\r\n            }\r\n            star.el.setAttribute('rating-value', value.toString());\r\n        }\r\n        else {\r\n            star = Dom_1.$$(starElement);\r\n        }\r\n        star.toggleClass('coveo-result-rating-star-active', isChecked);\r\n    };\r\n    /**\r\n     * Rates an item using the the specified `rating` value.\r\n     * @param rating The rating to assign to the item.\r\n     *\r\n     * The possible values are:\r\n     *\r\n     * - `0`: renders no star.\r\n     * - `1`: renders 1 star.\r\n     * - `2`: renders 2 stars.\r\n     * - `3`: renders 3 stars.\r\n     * - `4`: renders 4 stars.\r\n     * - `5`: renders 5 stars.\r\n     */\r\n    ResultRating.prototype.rateDocument = function (rating) {\r\n        var _this = this;\r\n        var request = {\r\n            rating: RatingValues[rating],\r\n            uniqueId: this.result.uniqueId\r\n        };\r\n        this.queryController\r\n            .getEndpoint()\r\n            .rateDocument(request)\r\n            .then(function () {\r\n            _this.result.rating = rating;\r\n            _this.renderComponent(_this.element, rating);\r\n        })\r\n            .catch(function () {\r\n            _this.logger.error('An error occurred while rating the item');\r\n        });\r\n    };\r\n    ResultRating.ID = 'ResultRating';\r\n    ResultRating.doExport = function () {\r\n        GlobalExports_1.exportGlobally({\r\n            ResultRating: ResultRating\r\n        });\r\n    };\r\n    return ResultRating;\r\n}(Component_1.Component));\r\nexports.ResultRating = ResultRating;\r\nInitialization_1.Initialization.registerAutoCreateComponent(ResultRating);\r\n\n\n/***/ }),\n\n/***/ 657:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// ResultRating.min__5f3280c404a1ee75a113.js","import 'styling/_ResultRating';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\nimport { IRatingRequest } from '../../rest/RatingRequest';\r\nimport { AccessibleButton } from '../../utils/AccessibleButton';\r\nimport { $$, Dom } from '../../utils/Dom';\r\nimport { SVGDom } from '../../utils/SVGDom';\r\nimport { SVGIcons } from '../../utils/SVGIcons';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { Component } from '../Base/Component';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { Initialization } from '../Base/Initialization';\r\n\r\nexport enum RatingValues {\r\n  Undefined,\r\n  Lowest,\r\n  Low,\r\n  Average,\r\n  Good,\r\n  Best\r\n}\r\n\r\nexport interface IResultRatingOptions {}\r\n/**\r\n * **Note:**\r\n *\r\n * > The Coveo Cloud V2 platform does not support collaborative rating. Therefore, this component is obsolete in Coveo Cloud V2.\r\n *\r\n * The `ResultRating` component renders a 5-star rating widget. Interactive rating is possible if\r\n * the [`enableCollaborativeRating`]{@link SearchInterface.options.enableCollaborativeRating} option of your\r\n * search interface is `true`, and if collaborative rating is enabled on your Coveo index.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n *\r\n * @notSupportedIn salesforcefree\r\n */\r\nexport class ResultRating extends Component {\r\n  static ID = 'ResultRating';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      ResultRating: ResultRating\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Creates a new `ResultRating` component.\r\n   * @param element The HTMLElement on which to instantiate the component.\r\n   * @param options The options for the `ResultRating` component.\r\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n   * automatically resolved (with a slower execution time).\r\n   * @param result The result to associate the component with.\r\n   */\r\n  constructor(\r\n    public element: HTMLElement,\r\n    public options?: IResultRatingOptions,\r\n    public bindings?: IComponentBindings,\r\n    public result?: IQueryResult\r\n  ) {\r\n    super(element, ResultRating.ID, bindings);\r\n    this.options = ComponentOptions.initComponentOptions(element, ResultRating, options);\r\n\r\n    if (!Utils.isNullOrUndefined(result.rating)) {\r\n      this.renderComponent(element, result.rating);\r\n    }\r\n  }\r\n\r\n  private renderComponent(element: HTMLElement, rating: number) {\r\n    for (let starNumber = 1; starNumber <= 5; starNumber++) {\r\n      this.renderStar(element, starNumber <= rating, starNumber);\r\n    }\r\n  }\r\n\r\n  private renderStar(element: HTMLElement, isChecked: boolean, value: number) {\r\n    let star: Dom;\r\n    const starElement = $$(element).find('a[rating-value=\"' + value + '\"]');\r\n    if (starElement == null) {\r\n      star = $$('a', { className: 'coveo-result-rating-star' }, SVGIcons.icons.star);\r\n      SVGDom.addClassToSVGInContainer(star.el, 'coveo-result-rating-star-svg');\r\n      element.appendChild(star.el);\r\n\r\n      if (this.bindings.searchInterface.options.enableCollaborativeRating) {\r\n        new AccessibleButton()\r\n          .withElement(star)\r\n          .withSelectAction(e => {\r\n            const targetElement: HTMLElement = <HTMLElement>e.currentTarget;\r\n            this.rateDocument(parseInt(targetElement.getAttribute('rating-value')));\r\n          })\r\n          .withLabel(value.toString())\r\n          .build();\r\n\r\n        star.on('mouseover', e => {\r\n          const targetElement: HTMLElement = <HTMLElement>e.currentTarget;\r\n          this.renderComponent(element, parseInt(targetElement.getAttribute('rating-value')));\r\n        });\r\n\r\n        star.on('mouseout', () => {\r\n          this.renderComponent(element, this.result.rating);\r\n        });\r\n      }\r\n\r\n      star.el.setAttribute('rating-value', value.toString());\r\n    } else {\r\n      star = $$(starElement);\r\n    }\r\n\r\n    star.toggleClass('coveo-result-rating-star-active', isChecked);\r\n  }\r\n\r\n  /**\r\n   * Rates an item using the the specified `rating` value.\r\n   * @param rating The rating to assign to the item.\r\n   *\r\n   * The possible values are:\r\n   *\r\n   * - `0`: renders no star.\r\n   * - `1`: renders 1 star.\r\n   * - `2`: renders 2 stars.\r\n   * - `3`: renders 3 stars.\r\n   * - `4`: renders 4 stars.\r\n   * - `5`: renders 5 stars.\r\n   */\r\n  public rateDocument(rating: RatingValues) {\r\n    const request: IRatingRequest = {\r\n      rating: RatingValues[rating],\r\n      uniqueId: this.result.uniqueId\r\n    };\r\n\r\n    this.queryController\r\n      .getEndpoint()\r\n      .rateDocument(request)\r\n      .then(() => {\r\n        this.result.rating = rating;\r\n        this.renderComponent(this.element, rating);\r\n      })\r\n      .catch(() => {\r\n        this.logger.error('An error occurred while rating the item');\r\n      });\r\n  }\r\n}\r\n\r\nInitialization.registerAutoCreateComponent(ResultRating);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResultRating/ResultRating.ts"],"sourceRoot":""}
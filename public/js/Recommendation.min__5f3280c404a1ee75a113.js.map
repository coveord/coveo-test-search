{"version":3,"sources":["Recommendation.min__5f3280c404a1ee75a113.js","./src/ui/ResponsiveComponents/ResponsiveComponentsUtils.ts","./src/ui/Recommendation/Recommendation.ts","./src/events/QuickviewEvents.ts","./src/ui/Templates/DefaultRecommendationTemplate.ts","./src/ui/ResponsiveComponents/ResponsiveRecommendation.ts","./src/ui/ResponsiveComponents/ResponsiveDropdown/RecommendationDropdownContent.ts","./src/ui/Recommendation/RecommendationQuery.ts"],"names":["webpackJsonpCoveo__temporary","126","module","exports","__webpack_require__","Object","defineProperty","value","shouldDrawFacetSlider","root","facetSliderElement","ResponsiveDropdownContent","isTargetInsideOpenedDropdown","this","isSmallFacetActivated","isSmallTabsActivated","hasClass","smallTabsClassName","smallFacetClassName","isSmallRecommendationActivated","smallRecommendationClassName","activateSmallTabs","addClass","deactivateSmallTabs","removeClass","activateSmallFacet","deactivateSmallFacet","activateSmallRecommendation","deactivateSmallRecommendation","ResponsiveComponentsUtils","196","__extends","extendStatics","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","element","options","analyticsOptions","_window","ComponentOptions","initComponentOptions","Recommendation","style","display","id","generateDefaultId","preventEventPropagation","mainSearchInterface","bindToMainSearchInterface","$$","on","QueryEvents","buildingQuery","e","args","handleRecommendationBuildingQuery","querySuccess","handleRecommendationQuerySuccess","noResults","handleRecommendationNoResults","queryError","handleRecommendationQueryError","ensureCurrentPageViewExistsInStore","ResponsiveRecommendation","init","_this","get","queryController","historyStore","enumerable","configurable","getId","enable","show","disable","hide","historyElement","name","document","location","toString","time","JSON","stringify","Date","title","_","escape","addElement","bindComponentOptionsModelToMainSearchInterface","bindQueryEventsToMainSearchInterface","searchInterfaceComponent","SearchInterface","alreadyInitialized","onceInitialized","mainSearchInterfaceOptionsModel","getBindings","componentOptionsModel","setMultiple","getAttributes","getEventName","MODEL_EVENTS","ALL","InitializationEvents","afterComponentsInitialization","mainInterfaceQuery","mainQuerySearchUID","results","searchUid","mainQueryPipeline","pipeline","length","usageAnalytics","logSearchEvent","analyticsActionCauseList","recommendation","executeQuery","closeModalBox","data","disabled","modifyQueryForRecommendation","addRecommendationInfoInQuery","hideIfNoResults","totalCount","Utils","copyObjectAttributes","queryBuilder","optionsToUse","isEmpty","userContext","addContext","preventEventPropagationOn","OmniboxEvents","ResultListEvents","SettingsEvents","PreferencesPanelEvents","AnalyticsEvents","BreadcrumbEvents","QuickviewEvents","getAllModelEvents","eventType","eventName","event","stopPropagation","events","queryStateModel","each","values","Model","eventTypes","QUERY_STATE_ATTRIBUTES","attribute","NEXT_ID","logger","warn","ID","doExport","exportGlobally","DefaultRecommendationTemplate","RecommendationQuery","RecommendationAnalyticsClient","buildSelectorOption","buildJsonOption","buildStringOption","buildListOption","defaultValue","sendActionsHistory","buildBooleanOption","deprecated","autoTriggerQuery","postProcessing","enableResponsiveMode","responsiveBreakpoint","buildNumberOption","dropdownHeaderLabel","buildLocalizedStringOption","localizedString","l","225","quickviewLoaded","openQuickview","463","_super","apply","arguments","instantiateToString","object","instantiateToElement","Promise","resolve","reject","div","createElement","innerHTML","Template","645","coveoRoot","responsiveDropdown","recommendationRoot","getRecommendationRoot","breakpoint","defineResponsiveBreakpoint","searchInterface","Component","el","dropdown","buildDropdown","registerOnOpenHandler","registerQueryEvents","handleResizeEvent","component","Logger","findParentRootOfRecommendationComponent","find","ResponsiveComponentsManager","register","extend","initializationEventRoot","info","parents","computeCssClassName","needSmallMode","changeToSmallMode","changeToLargeMode","isOpened","dropdownContent","positionDropdown","needDropdownWrapper","isWidthSmallerThanBreakpoint","width","responsiveComponents","getResponsiveMode","close","header","DROPDOWN_HEADER_WRAPPER_CSS_CLASS","append","dropdownHeader","disableFacetPreservePosition","Defer","defer","enableFacetPreservePosition","cleanUp","buildDropdownContent","buildDropdownHeader","ResponsiveDropdown","disablePopupBackground","dropdownHeaderElement","content","text","appendChild","ResponsiveDropdownHeader","dropdownContentElement","recommendationColumn","RecommendationDropdownContent","isNullOrUndefined","RESPONSIVE_BREAKPOINT","getFacetSliders","facetSliders","findAll","computeSelectorForType","forEach","facetSlider","push","getFacets","facets","facetElement","facet","preservePosition","drawFacetSliderGraphs","drawDelayedGraphData","recommendationInstance","handleRecommnendationQuerySucess","DROPDOWN_CONTAINER_CSS_CLASS_NAME","646","componentName","cssClassName","DEFAULT_CSS_CLASS_NAME","dropdownContentWrapper","prepend","window","getComputedStyle","maxHeight","OPENED_DROPDOWN_CSS_CLASS_NAME","hideDropdown","647","648","bindings","tagName","toLowerCase","decodeHTMLEntities","isUndefined","bind","onRootElement","handleBuildingQuery","advancedExpression","add","Initialization","registerAutoCreateComponent","649"],"mappings":"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","file":"Recommendation.min__5f3280c404a1ee75a113.js","sourcesContent":["webpackJsonpCoveo__temporary([20],{\n\n/***/ 126:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ResponsiveDropdownContent_1 = __webpack_require__(88);\r\nvar ResponsiveComponentsUtils = /** @class */ (function () {\r\n    function ResponsiveComponentsUtils() {\r\n    }\r\n    ResponsiveComponentsUtils.shouldDrawFacetSlider = function (root, facetSliderElement) {\r\n        return ResponsiveDropdownContent_1.ResponsiveDropdownContent.isTargetInsideOpenedDropdown(facetSliderElement) || !this.isSmallFacetActivated(root);\r\n    };\r\n    ResponsiveComponentsUtils.isSmallTabsActivated = function (root) {\r\n        return root.hasClass(this.smallTabsClassName);\r\n    };\r\n    ResponsiveComponentsUtils.isSmallFacetActivated = function (root) {\r\n        return root.hasClass(this.smallFacetClassName);\r\n    };\r\n    ResponsiveComponentsUtils.isSmallRecommendationActivated = function (root) {\r\n        return root.hasClass(this.smallRecommendationClassName);\r\n    };\r\n    ResponsiveComponentsUtils.activateSmallTabs = function (root) {\r\n        root.addClass(this.smallTabsClassName);\r\n    };\r\n    ResponsiveComponentsUtils.deactivateSmallTabs = function (root) {\r\n        root.removeClass(this.smallTabsClassName);\r\n    };\r\n    ResponsiveComponentsUtils.activateSmallFacet = function (root) {\r\n        root.addClass(this.smallFacetClassName);\r\n    };\r\n    ResponsiveComponentsUtils.deactivateSmallFacet = function (root) {\r\n        root.removeClass(this.smallFacetClassName);\r\n    };\r\n    ResponsiveComponentsUtils.activateSmallRecommendation = function (root) {\r\n        root.addClass(this.smallRecommendationClassName);\r\n    };\r\n    ResponsiveComponentsUtils.deactivateSmallRecommendation = function (root) {\r\n        root.removeClass(this.smallRecommendationClassName);\r\n    };\r\n    ResponsiveComponentsUtils.smallTabsClassName = 'coveo-small-tabs';\r\n    ResponsiveComponentsUtils.smallFacetClassName = 'coveo-small-facets';\r\n    ResponsiveComponentsUtils.smallRecommendationClassName = 'coveo-small-recommendation';\r\n    return ResponsiveComponentsUtils;\r\n}());\r\nexports.ResponsiveComponentsUtils = ResponsiveComponentsUtils;\r\n\n\n/***/ }),\n\n/***/ 196:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar SearchInterface_1 = __webpack_require__(19);\r\nvar ComponentOptions_1 = __webpack_require__(8);\r\nvar QueryEvents_1 = __webpack_require__(11);\r\nvar OmniboxEvents_1 = __webpack_require__(33);\r\nvar ResultListEvents_1 = __webpack_require__(29);\r\nvar SettingsEvents_1 = __webpack_require__(53);\r\nvar PreferencesPanelEvents_1 = __webpack_require__(96);\r\nvar AnalyticsEvents_1 = __webpack_require__(56);\r\nvar AnalyticsActionListMeta_1 = __webpack_require__(10);\r\nvar BreadcrumbEvents_1 = __webpack_require__(34);\r\nvar QuickviewEvents_1 = __webpack_require__(225);\r\nvar QueryStateModel_1 = __webpack_require__(13);\r\nvar Model_1 = __webpack_require__(18);\r\nvar Utils_1 = __webpack_require__(4);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar ResponsiveRecommendation_1 = __webpack_require__(645);\r\nvar RegisteredNamedMethods_1 = __webpack_require__(30);\r\nvar InitializationEvents_1 = __webpack_require__(17);\r\nvar _ = __webpack_require__(0);\r\nvar GlobalExports_1 = __webpack_require__(3);\r\nvar DefaultRecommendationTemplate_1 = __webpack_require__(463);\r\nvar RecommendationQuery_1 = __webpack_require__(648);\r\nvar RecommendationAnalyticsClient_1 = __webpack_require__(206);\r\n__webpack_require__(649);\r\nvar Strings_1 = __webpack_require__(6);\r\n/**\r\n * The Recommendation component is a {@link SearchInterface} that displays recommendations typically based on user\r\n * history.\r\n *\r\n * This component usually listens to the main SearchInterface. When the main SearchInterface generates a query, the\r\n * Recommendation component generates another query to get the recommendations at the same time.\r\n *\r\n * To get history-based recommendations, you will likely want to include the `pageview` script in your page (see\r\n * [coveo.analytics.js](https://github.com/coveo/coveo.analytics.js)). However, including this script is not mandatory.\r\n * For instance, you could use the Recommendation component without the Coveo Machine Learning service to create a\r\n * simple \"recommended people\" interface.\r\n *\r\n * It is possible to include this component inside another SearchInterface, but it is also possible to instantiate it as\r\n * a \"standalone\" search interface, without even instantiating a main SearchInterface component. In any case, a\r\n * Recommendation component always acts as a full-fledged search interface. Therefore, you can include any component\r\n * inside the Recommendation component (Searchbox, Facet, Sort, etc.), just as you would inside the main SearchInterface\r\n * component.\r\n *\r\n * @availablesince [July 2016 Release (v1.667.24)](https://docs.coveo.com/en/309/#july-2016-release-v166724)\r\n */\r\nvar Recommendation = /** @class */ (function (_super) {\r\n    __extends(Recommendation, _super);\r\n    /**\r\n     * Creates a new Recommendation component.\r\n     * @param element The HTMLElement on which to instantiate the component.\r\n     * @param options The options for the Recommendation component.\r\n     * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n     * automatically resolved (with a slower execution time)\r\n     * @param _window\r\n     */\r\n    function Recommendation(element, options, analyticsOptions, _window) {\r\n        if (options === void 0) { options = {}; }\r\n        if (analyticsOptions === void 0) { analyticsOptions = {}; }\r\n        if (_window === void 0) { _window = window; }\r\n        var _this = _super.call(this, element, ComponentOptions_1.ComponentOptions.initComponentOptions(element, Recommendation, options), analyticsOptions, _window) || this;\r\n        _this.element = element;\r\n        _this.options = options;\r\n        _this.analyticsOptions = analyticsOptions;\r\n        _this.element.style.display = '';\r\n        if (!_this.options.id) {\r\n            _this.generateDefaultId();\r\n        }\r\n        // This is done to allow the component to be included in another search interface without triggering the parent events.\r\n        _this.preventEventPropagation();\r\n        if (_this.options.mainSearchInterface) {\r\n            _this.bindToMainSearchInterface();\r\n        }\r\n        Dom_1.$$(_this.element).on(QueryEvents_1.QueryEvents.buildingQuery, function (e, args) {\r\n            return _this.handleRecommendationBuildingQuery(args);\r\n        });\r\n        Dom_1.$$(_this.element).on(QueryEvents_1.QueryEvents.querySuccess, function (e, args) { return _this.handleRecommendationQuerySuccess(args); });\r\n        Dom_1.$$(_this.element).on(QueryEvents_1.QueryEvents.noResults, function (e, args) { return _this.handleRecommendationNoResults(); });\r\n        Dom_1.$$(_this.element).on(QueryEvents_1.QueryEvents.queryError, function (e, args) { return _this.handleRecommendationQueryError(); });\r\n        if (!_this.options.mainSearchInterface) {\r\n            // When the recommendation component is \"standalone\", we add additional safeguard against bad config.\r\n            _this.ensureCurrentPageViewExistsInStore();\r\n        }\r\n        ResponsiveRecommendation_1.ResponsiveRecommendation.init(_this.root, _this, options);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Recommendation.prototype, \"historyStore\", {\r\n        get: function () {\r\n            return this.queryController.historyStore;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Recommendation.prototype.getId = function () {\r\n        return this.options.id;\r\n    };\r\n    Recommendation.prototype.enable = function () {\r\n        _super.prototype.enable.call(this);\r\n        this.show();\r\n    };\r\n    Recommendation.prototype.disable = function () {\r\n        _super.prototype.disable.call(this);\r\n        this.hide();\r\n    };\r\n    Recommendation.prototype.hide = function () {\r\n        Dom_1.$$(this.element).addClass('coveo-hidden');\r\n    };\r\n    Recommendation.prototype.show = function () {\r\n        Dom_1.$$(this.element).removeClass('coveo-hidden');\r\n    };\r\n    Recommendation.prototype.ensureCurrentPageViewExistsInStore = function () {\r\n        // It's not 100% sure that the element will actually be added in the store.\r\n        // It's possible that an external script configured by the end user to log the page view already did that.\r\n        // So we *could* end up with duplicate values in the store :\r\n        // We rely on the fact that the coveo.analytics lib has defensive code against consecutive page view that are identical.\r\n        // This is mainly done if the recommendation component is being initialized before the page view could be logged correctly by the coveo.analytics externa lib.\r\n        var historyElement = {\r\n            name: 'PageView',\r\n            value: document.location.toString(),\r\n            time: JSON.stringify(new Date()),\r\n            title: _.escape(document.title)\r\n        };\r\n        this.historyStore.addElement(historyElement);\r\n    };\r\n    Recommendation.prototype.bindToMainSearchInterface = function () {\r\n        this.bindComponentOptionsModelToMainSearchInterface();\r\n        this.bindQueryEventsToMainSearchInterface();\r\n    };\r\n    Recommendation.prototype.bindComponentOptionsModelToMainSearchInterface = function () {\r\n        var _this = this;\r\n        // Try to fetch the componentOptions from the main search interface.\r\n        // Since we do not know which interface is init first (recommendation or full search interface)\r\n        // add a mechanism that waits for the full search interface to be correctly initialized\r\n        // then, set the needed values on the component options model.\r\n        var searchInterfaceComponent = RegisteredNamedMethods_1.get(this.options.mainSearchInterface, SearchInterface_1.SearchInterface);\r\n        var alreadyInitialized = searchInterfaceComponent != null;\r\n        var onceInitialized = function () {\r\n            var mainSearchInterfaceOptionsModel = searchInterfaceComponent.getBindings().componentOptionsModel;\r\n            _this.componentOptionsModel.setMultiple(mainSearchInterfaceOptionsModel.getAttributes());\r\n            Dom_1.$$(_this.options.mainSearchInterface).on(_this.componentOptionsModel.getEventName(Model_1.MODEL_EVENTS.ALL), function () {\r\n                _this.componentOptionsModel.setMultiple(mainSearchInterfaceOptionsModel.getAttributes());\r\n            });\r\n        };\r\n        if (alreadyInitialized) {\r\n            onceInitialized();\r\n        }\r\n        else {\r\n            Dom_1.$$(this.options.mainSearchInterface).on(InitializationEvents_1.InitializationEvents.afterComponentsInitialization, function () {\r\n                searchInterfaceComponent = RegisteredNamedMethods_1.get(_this.options.mainSearchInterface, SearchInterface_1.SearchInterface);\r\n                onceInitialized();\r\n            });\r\n        }\r\n    };\r\n    Recommendation.prototype.bindQueryEventsToMainSearchInterface = function () {\r\n        var _this = this;\r\n        // Whenever a query sucessfully returns on the full search interface, refresh the recommendation component.\r\n        Dom_1.$$(this.options.mainSearchInterface).on(QueryEvents_1.QueryEvents.querySuccess, function (e, args) {\r\n            _this.mainInterfaceQuery = args;\r\n            _this.mainQuerySearchUID = args.results.searchUid;\r\n            _this.mainQueryPipeline = args.results.pipeline;\r\n            if (args.results.results.length != 0) {\r\n                _this.usageAnalytics.logSearchEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.recommendation, {});\r\n                _this.queryController.executeQuery({\r\n                    closeModalBox: false\r\n                });\r\n            }\r\n        });\r\n        Dom_1.$$(this.options.mainSearchInterface).on(QueryEvents_1.QueryEvents.queryError, function () { return _this.hide(); });\r\n        Dom_1.$$(this.options.mainSearchInterface).on(QueryEvents_1.QueryEvents.noResults, function () { return _this.hide(); });\r\n    };\r\n    Recommendation.prototype.handleRecommendationBuildingQuery = function (data) {\r\n        if (!this.disabled) {\r\n            this.modifyQueryForRecommendation(data);\r\n            this.addRecommendationInfoInQuery(data);\r\n        }\r\n    };\r\n    Recommendation.prototype.handleRecommendationQuerySuccess = function (data) {\r\n        if (!this.disabled) {\r\n            if (this.options.hideIfNoResults) {\r\n                if (data.results.totalCount === 0) {\r\n                    this.hide();\r\n                }\r\n                else {\r\n                    this.show();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Recommendation.prototype.handleRecommendationNoResults = function () {\r\n        if (!this.disabled) {\r\n            if (this.options.hideIfNoResults) {\r\n                this.hide();\r\n            }\r\n        }\r\n    };\r\n    Recommendation.prototype.handleRecommendationQueryError = function () {\r\n        if (!this.disabled) {\r\n            this.hide();\r\n        }\r\n    };\r\n    Recommendation.prototype.modifyQueryForRecommendation = function (data) {\r\n        if (this.mainInterfaceQuery) {\r\n            Utils_1.Utils.copyObjectAttributes(data.queryBuilder, this.mainInterfaceQuery.queryBuilder, this.options.optionsToUse);\r\n        }\r\n    };\r\n    Recommendation.prototype.addRecommendationInfoInQuery = function (data) {\r\n        if (!_.isEmpty(this.options.userContext)) {\r\n            data.queryBuilder.addContext(this.options.userContext);\r\n        }\r\n        data.queryBuilder.recommendation = this.options.id;\r\n    };\r\n    Recommendation.prototype.preventEventPropagation = function () {\r\n        this.preventEventPropagationOn(QueryEvents_1.QueryEvents);\r\n        this.preventEventPropagationOn(OmniboxEvents_1.OmniboxEvents);\r\n        this.preventEventPropagationOn(ResultListEvents_1.ResultListEvents);\r\n        this.preventEventPropagationOn(SettingsEvents_1.SettingsEvents);\r\n        this.preventEventPropagationOn(PreferencesPanelEvents_1.PreferencesPanelEvents);\r\n        this.preventEventPropagationOn(AnalyticsEvents_1.AnalyticsEvents);\r\n        this.preventEventPropagationOn(BreadcrumbEvents_1.BreadcrumbEvents);\r\n        this.preventEventPropagationOn(QuickviewEvents_1.QuickviewEvents);\r\n        this.preventEventPropagationOn(InitializationEvents_1.InitializationEvents);\r\n        this.preventEventPropagationOn(this.getAllModelEvents());\r\n    };\r\n    Recommendation.prototype.preventEventPropagationOn = function (eventType, eventName) {\r\n        if (eventName === void 0) { eventName = function (event) {\r\n            return event;\r\n        }; }\r\n        for (var event_1 in eventType) {\r\n            Dom_1.$$(this.root).on(eventName(event_1), function (e) { return e.stopPropagation(); });\r\n        }\r\n    };\r\n    Recommendation.prototype.getAllModelEvents = function () {\r\n        var _this = this;\r\n        var events = {};\r\n        var queryStateModel = this.getBindings().queryStateModel;\r\n        _.each(_.values(Model_1.Model.eventTypes), function (event) {\r\n            var eventName = queryStateModel.getEventName(event);\r\n            events[eventName] = eventName;\r\n            _.each(_.values(QueryStateModel_1.QUERY_STATE_ATTRIBUTES), function (attribute) {\r\n                var eventName = _this.queryStateModel.getEventName(event + attribute);\r\n                events[eventName] = eventName;\r\n            });\r\n        });\r\n        return events;\r\n    };\r\n    Recommendation.prototype.generateDefaultId = function () {\r\n        var id = 'Recommendation';\r\n        if (Recommendation.NEXT_ID !== 1) {\r\n            this.logger.warn('Generating another recommendation default id', 'Consider configuring a human friendly / meaningful id for this interface');\r\n            id = id + '_' + Recommendation.NEXT_ID;\r\n        }\r\n        Recommendation.NEXT_ID++;\r\n        this.options.id = id;\r\n    };\r\n    Recommendation.ID = 'Recommendation';\r\n    Recommendation.NEXT_ID = 1;\r\n    Recommendation.doExport = function () {\r\n        GlobalExports_1.exportGlobally({\r\n            Recommendation: Recommendation,\r\n            DefaultRecommendationTemplate: DefaultRecommendationTemplate_1.DefaultRecommendationTemplate,\r\n            RecommendationQuery: RecommendationQuery_1.RecommendationQuery,\r\n            RecommendationAnalyticsClient: RecommendationAnalyticsClient_1.RecommendationAnalyticsClient\r\n        });\r\n    };\r\n    /**\r\n     * The options for the recommendation component\r\n     * @componentOptions\r\n     */\r\n    Recommendation.options = {\r\n        /**\r\n         * Specifies the main {@link SearchInterface} to listen to.\r\n         */\r\n        mainSearchInterface: ComponentOptions_1.ComponentOptions.buildSelectorOption(),\r\n        /**\r\n         * Specifies the user context to send to Coveo usage analytics.\r\n         * The component sends this information with the query alongside the user history to get the recommendations.\r\n         */\r\n        userContext: ComponentOptions_1.ComponentOptions.buildJsonOption(),\r\n        /**\r\n         * Specifies the ID of the interface.\r\n         * The usage analytics use the interface ID to know which recommendation interface was selected.\r\n         *\r\n         * Default value is `Recommendation` for the first one and `Recommendation_{number}`, where {number} depends on the\r\n         * number of Recommendation interfaces with default IDs in the page for the others.\r\n         */\r\n        id: ComponentOptions_1.ComponentOptions.buildStringOption(),\r\n        /**\r\n         * Specifies which options from the main {@link QueryBuilder} to use in the triggered query.\r\n         *\r\n         * Possible values are:\r\n         * - `expression`\r\n         * - `advancedExpression`\r\n         * - `constantExpression`\r\n         * - `disjunctionExpression`\r\n         *\r\n         * **Example:**\r\n         *\r\n         * Adding the expression (`q`) and the advanced expression (`aq`) parts of the main query in the triggered query:\r\n         *\r\n         * `data-options-to-use=\"expression,advancedExpression\"`\r\n         *\r\n         * Default value is `expression`.\r\n         */\r\n        optionsToUse: ComponentOptions_1.ComponentOptions.buildListOption({\r\n            defaultValue: ['expression']\r\n        }),\r\n        /**\r\n         * Specifies whether to send the actions history along with the triggered query.\r\n         *\r\n         * Setting this option to `false` makes it impossible for this component to get Coveo Machine Learning\r\n         * recommendations.\r\n         *\r\n         * However, setting this option to `false` can be useful to display side results in a search page.\r\n         *\r\n         * Default value is `true`.\r\n         *\r\n         * @deprecated This option is now deprecated. The correct way to control this behavior is to configure an appropriate machine learning model in the administration interface (Recommendation, Relevance tuning, Query suggestions).\r\n         */\r\n        sendActionsHistory: ComponentOptions_1.ComponentOptions.buildBooleanOption({\r\n            defaultValue: true,\r\n            deprecated: 'This option is now deprecated. The correct way to control this behaviour is to configure an appropriate machine learning model in the administration interface (Recommendation, Relevance tuning, Query suggestions)'\r\n        }),\r\n        /**\r\n         * Specifies whether to hide the Recommendations component if no result or recommendation is available.\r\n         *\r\n         * Default value is `true`.\r\n         */\r\n        hideIfNoResults: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: true }),\r\n        autoTriggerQuery: ComponentOptions_1.ComponentOptions.buildBooleanOption({\r\n            postProcessing: function (value, options) {\r\n                if (options.mainSearchInterface) {\r\n                    return false;\r\n                }\r\n                return value;\r\n            }\r\n        }),\r\n        /**\r\n         * Specifies whether to enable *responsive mode* for Recommendation components. Setting this options to `false` on\r\n         * any Recommendation component in a search interface disables responsive mode for all other Recommendation\r\n         * components in the search interface.\r\n         *\r\n         * Responsive mode displays all Recommendation components under a single dropdown button whenever the width of the\r\n         * HTML element which the search interface is bound to reaches or falls behind a certain threshold (see\r\n         * {@link Recommendation.options.responsiveBreakpoint}).\r\n         *\r\n         * See also {@link Recommendation.options.dropdownHeaderLabel}.\r\n         *\r\n         * Default value is `true`.\r\n         */\r\n        enableResponsiveMode: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: true }),\r\n        /**\r\n         * If {@link Recommendation.options.enableResponsiveMode} is `true` for all Recommendation components, specifies the\r\n         * width threshold (in pixels) of the search interface at which Recommendation components go in responsive mode.\r\n         *\r\n         * Recommendation components go in responsive mode when the width of the search interface is equal to or lower than\r\n         * this value.\r\n         *\r\n         * The `search interface` corresponds to the HTML element with the class `CoveoSearchInterface`.\r\n         *\r\n         * If more than one Recommendation component in the search interface specifies a value for this option, then the\r\n         * framework uses the last occurrence of the option.\r\n         *\r\n         * Default value is `1000`.\r\n         */\r\n        responsiveBreakpoint: ComponentOptions_1.ComponentOptions.buildNumberOption({ defaultValue: 1000 }),\r\n        /**\r\n         * If {@link Recommendation.options.enableResponsiveMode} is `true` for all Recommendation components, specifies the\r\n         * label of the dropdown button that allows to display the Recommendation components when in responsive mode.\r\n         *\r\n         * If more than one Recommendation component in the search interface specifies a value for this option, then the\r\n         * framework uses the first occurrence of the option.\r\n         *\r\n         * Default value is `Recommendations`.\r\n         */\r\n        dropdownHeaderLabel: ComponentOptions_1.ComponentOptions.buildLocalizedStringOption({\r\n            localizedString: function () { return Strings_1.l('Recommendations'); }\r\n        })\r\n    };\r\n    return Recommendation;\r\n}(SearchInterface_1.SearchInterface));\r\nexports.Recommendation = Recommendation;\r\n// We do not register the Recommendation component since it is done with .coveo('initRecommendation')\r\n\n\n/***/ }),\n\n/***/ 225:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * The `QuickviewEvents` static class contains the string definitions of all events that strongly relate to the\r\n * [`Quickview`]{@link Quickview} component.\r\n */\r\nvar QuickviewEvents = /** @class */ (function () {\r\n    function QuickviewEvents() {\r\n    }\r\n    /**\r\n     * Triggered by the [`QuickviewDocument`]{@link QuickviewDocument} component when the content to display in the\r\n     * quickview modal window has just finished downloading.\r\n     *\r\n     * The [`Quickview`]{@link Quickview} component listens to this event to know when to remove its loading animation.\r\n     *\r\n     * All `quickviewLoaded` event handlers receive a [`QuickviewLoadedEventArgs`]{@link IQuickviewLoadedEventArgs} object\r\n     * as an argument.\r\n     *\r\n     * @type {string} The string value is `quickviewLoaded`.\r\n     */\r\n    QuickviewEvents.quickviewLoaded = 'quickviewLoaded';\r\n    /**\r\n     * Triggered by the [`QuickviewDocument`]{@link QuickviewDocument} component when the end user has just clicked the\r\n     * **Quickview** button/link to open the quickview modal window.\r\n     *\r\n     * This event allows external code to modify the terms to highlight before the content of the quickview modal window\r\n     * is rendered.\r\n     *\r\n     * All `openQuickview` event handlers receive an\r\n     * [`OpenQuickviewEventArgs`]{@link ResultListEvents.IOpenQuickviewEventArgs} object as an argument.\r\n     *\r\n     * @type {string} The string value is `openQuickview`.\r\n     */\r\n    QuickviewEvents.openQuickview = 'openQuickview';\r\n    return QuickviewEvents;\r\n}());\r\nexports.QuickviewEvents = QuickviewEvents;\r\n\n\n/***/ }),\n\n/***/ 463:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Template_1 = __webpack_require__(27);\r\nvar DefaultRecommendationTemplate = /** @class */ (function (_super) {\r\n    __extends(DefaultRecommendationTemplate, _super);\r\n    function DefaultRecommendationTemplate() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DefaultRecommendationTemplate.prototype.instantiateToString = function (object) {\r\n        var template = \"<div class=\\\"coveo-result-frame\\\">\\n        <div class=\\\"coveo-result-row\\\">\\n          <div class=\\\"coveo-result-cell\\\" style=\\\"width:40px;text-align:center;vertical-align:middle;\\\">\\n            <span class=\\\"CoveoIcon\\\" data-small=\\\"true\\\" data-with-label=\\\"false\\\">\\n            </span>\\n          </div>\\n          <div class=\\\"coveo-result-cell\\\" style=\\\"padding:0 0 3px 5px;vertical-align:middle\\\">\\n            <div class=\\\"coveo-result-row\\\">\\n              <div class=\\\"coveo-result-cell\\\" style=\\\"font-size:10pt;\\\">\\n                <a class=\\\"CoveoResultLink\\\" style=\\\"display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\\\">\\n                </a>\\n              </div>\\n            </div>\\n          </div>\\n        </div>\\n      </div>\";\r\n        return template;\r\n    };\r\n    DefaultRecommendationTemplate.prototype.instantiateToElement = function (object) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var div = document.createElement('div');\r\n            div.innerHTML = _this.instantiateToString(object);\r\n            resolve(div);\r\n        });\r\n    };\r\n    return DefaultRecommendationTemplate;\r\n}(Template_1.Template));\r\nexports.DefaultRecommendationTemplate = DefaultRecommendationTemplate;\r\n\n\n/***/ }),\n\n/***/ 645:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ResponsiveComponentsManager_1 = __webpack_require__(60);\r\nvar ResponsiveComponentsUtils_1 = __webpack_require__(126);\r\nvar SearchInterface_1 = __webpack_require__(19);\r\nvar Utils_1 = __webpack_require__(4);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar Logger_1 = __webpack_require__(9);\r\nvar Recommendation_1 = __webpack_require__(196);\r\nvar RecommendationDropdownContent_1 = __webpack_require__(646);\r\nvar ResponsiveDropdownHeader_1 = __webpack_require__(131);\r\nvar ResponsiveDropdown_1 = __webpack_require__(117);\r\nvar Strings_1 = __webpack_require__(6);\r\nvar Component_1 = __webpack_require__(7);\r\nvar RegisteredNamedMethods_1 = __webpack_require__(30);\r\nvar QueryEvents_1 = __webpack_require__(11);\r\nvar _ = __webpack_require__(0);\r\n__webpack_require__(647);\r\nvar MiscModules_1 = __webpack_require__(71);\r\nvar ResponsiveRecommendation = /** @class */ (function () {\r\n    function ResponsiveRecommendation(coveoRoot, ID, options, responsiveDropdown) {\r\n        this.coveoRoot = coveoRoot;\r\n        this.ID = ID;\r\n        this.responsiveDropdown = responsiveDropdown;\r\n        this.recommendationRoot = this.getRecommendationRoot();\r\n        this.dropdownHeaderLabel = options.dropdownHeaderLabel;\r\n        this.breakpoint = this.defineResponsiveBreakpoint(options);\r\n        this.searchInterface = Component_1.Component.get(this.coveoRoot.el, SearchInterface_1.SearchInterface, false);\r\n        this.dropdown = this.buildDropdown(responsiveDropdown);\r\n        this.registerOnOpenHandler();\r\n        this.registerQueryEvents();\r\n        this.handleResizeEvent();\r\n    }\r\n    ResponsiveRecommendation.init = function (root, component, options) {\r\n        var logger = new Logger_1.Logger('ResponsiveRecommendation');\r\n        var coveoRoot = this.findParentRootOfRecommendationComponent(root);\r\n        if (!coveoRoot) {\r\n            logger.info('Recommendation component has no parent interface. Disabling responsive mode for this component.');\r\n            return;\r\n        }\r\n        if (!Dom_1.$$(coveoRoot).find('.coveo-results-column')) {\r\n            logger.info('Cannot find element with class coveo-results-column. Disabling responsive mode for this component.');\r\n            return;\r\n        }\r\n        ResponsiveComponentsManager_1.ResponsiveComponentsManager.register(ResponsiveRecommendation, Dom_1.$$(coveoRoot), Recommendation_1.Recommendation.ID, component, _.extend({}, options, { initializationEventRoot: Dom_1.$$(root) }));\r\n    };\r\n    ResponsiveRecommendation.findParentRootOfRecommendationComponent = function (root) {\r\n        var coveoRoot = Dom_1.$$(root).parents(Component_1.Component.computeCssClassName(SearchInterface_1.SearchInterface));\r\n        if (coveoRoot[0]) {\r\n            return Dom_1.$$(coveoRoot[0]);\r\n        }\r\n        return null;\r\n    };\r\n    ResponsiveRecommendation.prototype.handleResizeEvent = function () {\r\n        if (this.needSmallMode() && !ResponsiveComponentsUtils_1.ResponsiveComponentsUtils.isSmallRecommendationActivated(this.coveoRoot)) {\r\n            this.changeToSmallMode();\r\n        }\r\n        else if (!this.needSmallMode() && ResponsiveComponentsUtils_1.ResponsiveComponentsUtils.isSmallRecommendationActivated(this.coveoRoot)) {\r\n            this.changeToLargeMode();\r\n        }\r\n        if (this.dropdown.isOpened) {\r\n            this.dropdown.dropdownContent.positionDropdown();\r\n        }\r\n    };\r\n    ResponsiveRecommendation.prototype.needDropdownWrapper = function () {\r\n        return this.needSmallMode();\r\n    };\r\n    ResponsiveRecommendation.prototype.needSmallMode = function () {\r\n        var isWidthSmallerThanBreakpoint = this.coveoRoot.width() <= this.breakpoint;\r\n        if (!this.searchInterface) {\r\n            return isWidthSmallerThanBreakpoint;\r\n        }\r\n        switch (this.searchInterface.responsiveComponents.getResponsiveMode()) {\r\n            case 'small':\r\n                return true;\r\n            case 'auto':\r\n                return isWidthSmallerThanBreakpoint;\r\n            default:\r\n                return false;\r\n        }\r\n    };\r\n    ResponsiveRecommendation.prototype.changeToSmallMode = function () {\r\n        var _this = this;\r\n        this.dropdown.close();\r\n        var header = this.coveoRoot.find(\".\" + ResponsiveComponentsManager_1.ResponsiveComponentsManager.DROPDOWN_HEADER_WRAPPER_CSS_CLASS);\r\n        if (!header) {\r\n            // It's possible that recommendation gets initialized before the main interface is completed.\r\n            // We defer the resize event execution in that case.\r\n            MiscModules_1.Defer.defer(function () { return _this.handleResizeEvent(); });\r\n        }\r\n        else {\r\n            Dom_1.$$(header).append(this.dropdown.dropdownHeader.element.el);\r\n            this.disableFacetPreservePosition();\r\n            ResponsiveComponentsUtils_1.ResponsiveComponentsUtils.activateSmallRecommendation(this.coveoRoot);\r\n            ResponsiveComponentsUtils_1.ResponsiveComponentsUtils.activateSmallRecommendation(this.recommendationRoot);\r\n        }\r\n    };\r\n    ResponsiveRecommendation.prototype.changeToLargeMode = function () {\r\n        this.enableFacetPreservePosition();\r\n        this.dropdown.cleanUp();\r\n        ResponsiveComponentsUtils_1.ResponsiveComponentsUtils.deactivateSmallRecommendation(this.coveoRoot);\r\n        ResponsiveComponentsUtils_1.ResponsiveComponentsUtils.deactivateSmallRecommendation(this.recommendationRoot);\r\n    };\r\n    ResponsiveRecommendation.prototype.buildDropdown = function (responsiveDropdown) {\r\n        var dropdownContent = this.buildDropdownContent();\r\n        var dropdownHeader = this.buildDropdownHeader();\r\n        var dropdown = responsiveDropdown ? responsiveDropdown : new ResponsiveDropdown_1.ResponsiveDropdown(dropdownContent, dropdownHeader, this.coveoRoot);\r\n        dropdown.disablePopupBackground();\r\n        return dropdown;\r\n    };\r\n    ResponsiveRecommendation.prototype.buildDropdownHeader = function () {\r\n        var dropdownHeaderElement = Dom_1.$$('a');\r\n        var content = Dom_1.$$('p');\r\n        content.text(Strings_1.l(this.dropdownHeaderLabel));\r\n        dropdownHeaderElement.el.appendChild(content.el);\r\n        var dropdownHeader = new ResponsiveDropdownHeader_1.ResponsiveDropdownHeader('recommendation', dropdownHeaderElement);\r\n        return dropdownHeader;\r\n    };\r\n    ResponsiveRecommendation.prototype.buildDropdownContent = function () {\r\n        var dropdownContentElement;\r\n        var recommendationColumn = this.coveoRoot.find('.coveo-recommendation-column');\r\n        if (recommendationColumn) {\r\n            dropdownContentElement = Dom_1.$$(recommendationColumn);\r\n        }\r\n        else {\r\n            dropdownContentElement = Dom_1.$$(this.coveoRoot.find('.' + Component_1.Component.computeCssClassName(Recommendation_1.Recommendation)));\r\n        }\r\n        var dropdownContent = new RecommendationDropdownContent_1.RecommendationDropdownContent('recommendation', dropdownContentElement, this.coveoRoot);\r\n        return dropdownContent;\r\n    };\r\n    ResponsiveRecommendation.prototype.defineResponsiveBreakpoint = function (options) {\r\n        var breakpoint;\r\n        if (Utils_1.Utils.isNullOrUndefined(options.responsiveBreakpoint)) {\r\n            breakpoint = ResponsiveRecommendation.RESPONSIVE_BREAKPOINT;\r\n        }\r\n        else {\r\n            breakpoint = options.responsiveBreakpoint;\r\n        }\r\n        return breakpoint;\r\n    };\r\n    ResponsiveRecommendation.prototype.getFacetSliders = function () {\r\n        var facetSliders = [];\r\n        this.coveoRoot.findAll(Component_1.Component.computeSelectorForType('FacetSlider')).forEach(function (facetSliderElement) {\r\n            var facetSlider = Component_1.Component.get(facetSliderElement);\r\n            facetSlider && facetSliders.push(facetSlider);\r\n        });\r\n        return facetSliders;\r\n    };\r\n    ResponsiveRecommendation.prototype.getFacets = function () {\r\n        var facets = [];\r\n        this.coveoRoot.findAll(Component_1.Component.computeSelectorForType('Facet')).forEach(function (facetElement) {\r\n            var facet = Component_1.Component.get(facetElement);\r\n            facet && facets.push(facet);\r\n        });\r\n        return facets;\r\n    };\r\n    ResponsiveRecommendation.prototype.enableFacetPreservePosition = function () {\r\n        this.getFacets().forEach(function (facet) { return (facet.options.preservePosition = true); });\r\n    };\r\n    ResponsiveRecommendation.prototype.disableFacetPreservePosition = function () {\r\n        this.getFacets().forEach(function (facet) { return (facet.options.preservePosition = false); });\r\n    };\r\n    ResponsiveRecommendation.prototype.drawFacetSliderGraphs = function () {\r\n        this.getFacetSliders().forEach(function (facetSlider) { return facetSlider.drawDelayedGraphData(); });\r\n    };\r\n    ResponsiveRecommendation.prototype.registerOnOpenHandler = function () {\r\n        this.dropdown.registerOnOpenHandler(this.drawFacetSliderGraphs, this);\r\n    };\r\n    ResponsiveRecommendation.prototype.getRecommendationRoot = function () {\r\n        return Dom_1.$$(this.coveoRoot.find('.' + Component_1.Component.computeCssClassName(Recommendation_1.Recommendation)));\r\n    };\r\n    ResponsiveRecommendation.prototype.registerQueryEvents = function () {\r\n        var _this = this;\r\n        var recommendationInstance = RegisteredNamedMethods_1.get(this.recommendationRoot.el, SearchInterface_1.SearchInterface);\r\n        if (recommendationInstance && recommendationInstance.options.hideIfNoResults) {\r\n            this.coveoRoot.on(QueryEvents_1.QueryEvents.querySuccess, function (e, data) { return _this.handleRecommnendationQuerySucess(data); });\r\n            this.coveoRoot.on(QueryEvents_1.QueryEvents.noResults, function (e, data) { return _this.handleRecommendationNoResults(); });\r\n        }\r\n        this.coveoRoot.on(QueryEvents_1.QueryEvents.queryError, function () { return _this.handleRecommendationQueryError(); });\r\n    };\r\n    ResponsiveRecommendation.prototype.handleRecommnendationQuerySucess = function (data) {\r\n        if (data.results.totalCount === 0) {\r\n            this.dropdown.close();\r\n            this.dropdown.dropdownHeader.hide();\r\n        }\r\n        else {\r\n            this.dropdown.dropdownHeader.show();\r\n        }\r\n    };\r\n    ResponsiveRecommendation.prototype.handleRecommendationNoResults = function () {\r\n        this.dropdown.close();\r\n        this.dropdown.dropdownHeader.hide();\r\n    };\r\n    ResponsiveRecommendation.prototype.handleRecommendationQueryError = function () {\r\n        this.dropdown.close();\r\n        this.dropdown.dropdownHeader.hide();\r\n    };\r\n    ResponsiveRecommendation.DROPDOWN_CONTAINER_CSS_CLASS_NAME = 'coveo-recommendation-dropdown-container';\r\n    ResponsiveRecommendation.RESPONSIVE_BREAKPOINT = 1000;\r\n    return ResponsiveRecommendation;\r\n}());\r\nexports.ResponsiveRecommendation = ResponsiveRecommendation;\r\n\n\n/***/ }),\n\n/***/ 646:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ResponsiveDropdownContent_1 = __webpack_require__(88);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar RecommendationDropdownContent = /** @class */ (function () {\r\n    function RecommendationDropdownContent(componentName, element, coveoRoot) {\r\n        this.element = element;\r\n        this.coveoRoot = coveoRoot;\r\n        this.cssClassName = \"coveo-\" + componentName + \"-dropdown-content\";\r\n        this.element.addClass(this.cssClassName);\r\n        this.element.addClass(ResponsiveDropdownContent_1.ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME);\r\n    }\r\n    RecommendationDropdownContent.prototype.positionDropdown = function () {\r\n        this.element.el.style.display = '';\r\n        var dropdownContentWrapper = this.coveoRoot.find('.coveo-results-column');\r\n        Dom_1.$$(dropdownContentWrapper).prepend(this.element.el);\r\n        this.element.addClass(ResponsiveDropdownContent_1.ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME);\r\n        this.element.addClass(this.cssClassName);\r\n        // forces the browser to reflow the element, so that the transition is applied.\r\n        window.getComputedStyle(this.element.el).maxHeight;\r\n        this.element.addClass(RecommendationDropdownContent.OPENED_DROPDOWN_CSS_CLASS_NAME);\r\n    };\r\n    RecommendationDropdownContent.prototype.hideDropdown = function () {\r\n        this.element.addClass(ResponsiveDropdownContent_1.ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME);\r\n        this.element.addClass(this.cssClassName);\r\n        this.element.removeClass(RecommendationDropdownContent.OPENED_DROPDOWN_CSS_CLASS_NAME);\r\n    };\r\n    RecommendationDropdownContent.prototype.cleanUp = function () {\r\n        this.element.removeClass(this.cssClassName);\r\n        this.element.removeClass(ResponsiveDropdownContent_1.ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME);\r\n    };\r\n    RecommendationDropdownContent.OPENED_DROPDOWN_CSS_CLASS_NAME = 'coveo-open-dropdown-content';\r\n    return RecommendationDropdownContent;\r\n}());\r\nexports.RecommendationDropdownContent = RecommendationDropdownContent;\r\n\n\n/***/ }),\n\n/***/ 647:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 648:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Component_1 = __webpack_require__(7);\r\nvar ComponentOptions_1 = __webpack_require__(8);\r\nvar Utils_1 = __webpack_require__(4);\r\nvar QueryEvents_1 = __webpack_require__(11);\r\nvar Initialization_1 = __webpack_require__(2);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar _ = __webpack_require__(0);\r\nvar RecommendationQuery = /** @class */ (function (_super) {\r\n    __extends(RecommendationQuery, _super);\r\n    function RecommendationQuery(element, options, bindings) {\r\n        var _this = _super.call(this, element, RecommendationQuery.ID, bindings) || this;\r\n        _this.element = element;\r\n        _this.options = options;\r\n        _this.options = ComponentOptions_1.ComponentOptions.initComponentOptions(element, RecommendationQuery, options);\r\n        if (_this.element.tagName.toLowerCase() === 'script') {\r\n            try {\r\n                _this.content = Utils_1.Utils.decodeHTMLEntities(Dom_1.$$(_this.element).text());\r\n            }\r\n            catch (e) {\r\n                return _this;\r\n            }\r\n            if (!_.isUndefined(_this.content) && _this.content != '') {\r\n                _this.bind.onRootElement(QueryEvents_1.QueryEvents.buildingQuery, _this.handleBuildingQuery);\r\n            }\r\n        }\r\n        return _this;\r\n    }\r\n    RecommendationQuery.prototype.handleBuildingQuery = function (data) {\r\n        data.queryBuilder.advancedExpression.add(this.content);\r\n    };\r\n    RecommendationQuery.ID = 'RecommendationQuery';\r\n    /**\r\n     * The options for the RecommendationQuery component\r\n     * @componentOptions\r\n     */\r\n    RecommendationQuery.options = {};\r\n    return RecommendationQuery;\r\n}(Component_1.Component));\r\nexports.RecommendationQuery = RecommendationQuery;\r\nInitialization_1.Initialization.registerAutoCreateComponent(RecommendationQuery);\r\n\n\n/***/ }),\n\n/***/ 649:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// Recommendation.min__5f3280c404a1ee75a113.js","import { Dom } from '../../utils/Dom';\r\nimport { ResponsiveDropdownContent } from './ResponsiveDropdown/ResponsiveDropdownContent';\r\n\r\nexport class ResponsiveComponentsUtils {\r\n  private static smallTabsClassName: string = 'coveo-small-tabs';\r\n  private static smallFacetClassName: string = 'coveo-small-facets';\r\n  private static smallRecommendationClassName: string = 'coveo-small-recommendation';\r\n\r\n  static shouldDrawFacetSlider(root: Dom, facetSliderElement: Dom): boolean {\r\n    return ResponsiveDropdownContent.isTargetInsideOpenedDropdown(facetSliderElement) || !this.isSmallFacetActivated(root);\r\n  }\r\n\r\n  static isSmallTabsActivated(root: Dom): boolean {\r\n    return root.hasClass(this.smallTabsClassName);\r\n  }\r\n\r\n  static isSmallFacetActivated(root: Dom): boolean {\r\n    return root.hasClass(this.smallFacetClassName);\r\n  }\r\n\r\n  static isSmallRecommendationActivated(root: Dom): boolean {\r\n    return root.hasClass(this.smallRecommendationClassName);\r\n  }\r\n\r\n  static activateSmallTabs(root: Dom): void {\r\n    root.addClass(this.smallTabsClassName);\r\n  }\r\n\r\n  static deactivateSmallTabs(root: Dom): void {\r\n    root.removeClass(this.smallTabsClassName);\r\n  }\r\n\r\n  static activateSmallFacet(root: Dom): void {\r\n    root.addClass(this.smallFacetClassName);\r\n  }\r\n\r\n  static deactivateSmallFacet(root: Dom): void {\r\n    root.removeClass(this.smallFacetClassName);\r\n  }\r\n\r\n  static activateSmallRecommendation(root: Dom): void {\r\n    root.addClass(this.smallRecommendationClassName);\r\n  }\r\n\r\n  static deactivateSmallRecommendation(root: Dom): void {\r\n    root.removeClass(this.smallRecommendationClassName);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResponsiveComponents/ResponsiveComponentsUtils.ts","import { SearchInterface, ISearchInterfaceOptions } from '../SearchInterface/SearchInterface';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { QueryEvents, IQuerySuccessEventArgs, IBuildingQueryEventArgs } from '../../events/QueryEvents';\r\nimport { OmniboxEvents } from '../../events/OmniboxEvents';\r\nimport { ResultListEvents } from '../../events/ResultListEvents';\r\nimport { SettingsEvents } from '../../events/SettingsEvents';\r\nimport { PreferencesPanelEvents } from '../../events/PreferencesPanelEvents';\r\nimport { AnalyticsEvents } from '../../events/AnalyticsEvents';\r\nimport { analyticsActionCauseList, IAnalyticsNoMeta } from '../Analytics/AnalyticsActionListMeta';\r\nimport { BreadcrumbEvents } from '../../events/BreadcrumbEvents';\r\nimport { QuickviewEvents } from '../../events/QuickviewEvents';\r\nimport { QUERY_STATE_ATTRIBUTES } from '../../models/QueryStateModel';\r\nimport { Model, MODEL_EVENTS } from '../../models/Model';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { $$ } from '../../utils/Dom';\r\nimport { INoResultsEventArgs } from '../../events/QueryEvents';\r\nimport { IQueryErrorEventArgs } from '../../events/QueryEvents';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\nimport { ResponsiveRecommendation } from '../ResponsiveComponents/ResponsiveRecommendation';\r\nimport { get } from '../Base/RegisteredNamedMethods';\r\nimport { InitializationEvents } from '../../events/InitializationEvents';\r\nimport { ComponentOptionsModel } from '../../models/ComponentOptionsModel';\r\nimport * as _ from 'underscore';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { DefaultRecommendationTemplate } from '../Templates/DefaultRecommendationTemplate';\r\nimport { RecommendationQuery } from './RecommendationQuery';\r\nimport { RecommendationAnalyticsClient } from '../Analytics/RecommendationAnalyticsClient';\r\nimport 'styling/_Recommendation';\r\nimport { IStringMap } from '../../rest/GenericParam';\r\nimport { l } from '../../strings/Strings';\r\n\r\nexport interface IRecommendationOptions extends ISearchInterfaceOptions {\r\n  mainSearchInterface?: HTMLElement;\r\n  userContext?: IStringMap<any>;\r\n  id?: string;\r\n  optionsToUse?: string[];\r\n  sendActionsHistory?: boolean;\r\n  hideIfNoResults?: boolean;\r\n  enableResponsiveMode?: boolean;\r\n  responsiveBreakpoint?: number;\r\n  dropdownHeaderLabel?: string;\r\n}\r\n\r\n/**\r\n * The Recommendation component is a {@link SearchInterface} that displays recommendations typically based on user\r\n * history.\r\n *\r\n * This component usually listens to the main SearchInterface. When the main SearchInterface generates a query, the\r\n * Recommendation component generates another query to get the recommendations at the same time.\r\n *\r\n * To get history-based recommendations, you will likely want to include the `pageview` script in your page (see\r\n * [coveo.analytics.js](https://github.com/coveo/coveo.analytics.js)). However, including this script is not mandatory.\r\n * For instance, you could use the Recommendation component without the Coveo Machine Learning service to create a\r\n * simple \"recommended people\" interface.\r\n *\r\n * It is possible to include this component inside another SearchInterface, but it is also possible to instantiate it as\r\n * a \"standalone\" search interface, without even instantiating a main SearchInterface component. In any case, a\r\n * Recommendation component always acts as a full-fledged search interface. Therefore, you can include any component\r\n * inside the Recommendation component (Searchbox, Facet, Sort, etc.), just as you would inside the main SearchInterface\r\n * component.\r\n *\r\n * @availablesince [July 2016 Release (v1.667.24)](https://docs.coveo.com/en/309/#july-2016-release-v166724)\r\n */\r\nexport class Recommendation extends SearchInterface implements IComponentBindings {\r\n  static ID = 'Recommendation';\r\n  private static NEXT_ID = 1;\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      Recommendation: Recommendation,\r\n      DefaultRecommendationTemplate: DefaultRecommendationTemplate,\r\n      RecommendationQuery: RecommendationQuery,\r\n      RecommendationAnalyticsClient: RecommendationAnalyticsClient\r\n    });\r\n  };\r\n\r\n  /**\r\n   * The options for the recommendation component\r\n   * @componentOptions\r\n   */\r\n  static options: IRecommendationOptions = {\r\n    /**\r\n     * Specifies the main {@link SearchInterface} to listen to.\r\n     */\r\n    mainSearchInterface: ComponentOptions.buildSelectorOption(),\r\n\r\n    /**\r\n     * Specifies the user context to send to Coveo usage analytics.\r\n     * The component sends this information with the query alongside the user history to get the recommendations.\r\n     */\r\n    userContext: ComponentOptions.buildJsonOption(),\r\n\r\n    /**\r\n     * Specifies the ID of the interface.\r\n     * The usage analytics use the interface ID to know which recommendation interface was selected.\r\n     *\r\n     * Default value is `Recommendation` for the first one and `Recommendation_{number}`, where {number} depends on the\r\n     * number of Recommendation interfaces with default IDs in the page for the others.\r\n     */\r\n    id: ComponentOptions.buildStringOption(),\r\n\r\n    /**\r\n     * Specifies which options from the main {@link QueryBuilder} to use in the triggered query.\r\n     *\r\n     * Possible values are:\r\n     * - `expression`\r\n     * - `advancedExpression`\r\n     * - `constantExpression`\r\n     * - `disjunctionExpression`\r\n     *\r\n     * **Example:**\r\n     *\r\n     * Adding the expression (`q`) and the advanced expression (`aq`) parts of the main query in the triggered query:\r\n     *\r\n     * `data-options-to-use=\"expression,advancedExpression\"`\r\n     *\r\n     * Default value is `expression`.\r\n     */\r\n    optionsToUse: ComponentOptions.buildListOption<'expression' | 'advancedExpression' | 'constantExpression' | 'disjunctionExpression'>({\r\n      defaultValue: ['expression']\r\n    }),\r\n\r\n    /**\r\n     * Specifies whether to send the actions history along with the triggered query.\r\n     *\r\n     * Setting this option to `false` makes it impossible for this component to get Coveo Machine Learning\r\n     * recommendations.\r\n     *\r\n     * However, setting this option to `false` can be useful to display side results in a search page.\r\n     *\r\n     * Default value is `true`.\r\n     *\r\n     * @deprecated This option is now deprecated. The correct way to control this behavior is to configure an appropriate machine learning model in the administration interface (Recommendation, Relevance tuning, Query suggestions).\r\n     */\r\n    sendActionsHistory: ComponentOptions.buildBooleanOption({\r\n      defaultValue: true,\r\n      deprecated:\r\n        'This option is now deprecated. The correct way to control this behaviour is to configure an appropriate machine learning model in the administration interface (Recommendation, Relevance tuning, Query suggestions)'\r\n    }),\r\n\r\n    /**\r\n     * Specifies whether to hide the Recommendations component if no result or recommendation is available.\r\n     *\r\n     * Default value is `true`.\r\n     */\r\n    hideIfNoResults: ComponentOptions.buildBooleanOption({ defaultValue: true }),\r\n    autoTriggerQuery: ComponentOptions.buildBooleanOption({\r\n      postProcessing: (value: boolean, options: IRecommendationOptions) => {\r\n        if (options.mainSearchInterface) {\r\n          return false;\r\n        }\r\n        return value;\r\n      }\r\n    }),\r\n\r\n    /**\r\n     * Specifies whether to enable *responsive mode* for Recommendation components. Setting this options to `false` on\r\n     * any Recommendation component in a search interface disables responsive mode for all other Recommendation\r\n     * components in the search interface.\r\n     *\r\n     * Responsive mode displays all Recommendation components under a single dropdown button whenever the width of the\r\n     * HTML element which the search interface is bound to reaches or falls behind a certain threshold (see\r\n     * {@link Recommendation.options.responsiveBreakpoint}).\r\n     *\r\n     * See also {@link Recommendation.options.dropdownHeaderLabel}.\r\n     *\r\n     * Default value is `true`.\r\n     */\r\n    enableResponsiveMode: ComponentOptions.buildBooleanOption({ defaultValue: true }),\r\n\r\n    /**\r\n     * If {@link Recommendation.options.enableResponsiveMode} is `true` for all Recommendation components, specifies the\r\n     * width threshold (in pixels) of the search interface at which Recommendation components go in responsive mode.\r\n     *\r\n     * Recommendation components go in responsive mode when the width of the search interface is equal to or lower than\r\n     * this value.\r\n     *\r\n     * The `search interface` corresponds to the HTML element with the class `CoveoSearchInterface`.\r\n     *\r\n     * If more than one Recommendation component in the search interface specifies a value for this option, then the\r\n     * framework uses the last occurrence of the option.\r\n     *\r\n     * Default value is `1000`.\r\n     */\r\n    responsiveBreakpoint: ComponentOptions.buildNumberOption({ defaultValue: 1000 }),\r\n\r\n    /**\r\n     * If {@link Recommendation.options.enableResponsiveMode} is `true` for all Recommendation components, specifies the\r\n     * label of the dropdown button that allows to display the Recommendation components when in responsive mode.\r\n     *\r\n     * If more than one Recommendation component in the search interface specifies a value for this option, then the\r\n     * framework uses the first occurrence of the option.\r\n     *\r\n     * Default value is `Recommendations`.\r\n     */\r\n    dropdownHeaderLabel: ComponentOptions.buildLocalizedStringOption({\r\n      localizedString: () => l('Recommendations')\r\n    })\r\n  };\r\n\r\n  // These are used by the analytics client for recommendation\r\n  // so that clicks event inside the recommendation component can be modified and attached to the main search interface.\r\n  public mainQuerySearchUID: string;\r\n  public mainQueryPipeline: string;\r\n\r\n  private mainInterfaceQuery: IQuerySuccessEventArgs;\r\n\r\n  /**\r\n   * Creates a new Recommendation component.\r\n   * @param element The HTMLElement on which to instantiate the component.\r\n   * @param options The options for the Recommendation component.\r\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n   * automatically resolved (with a slower execution time)\r\n   * @param _window\r\n   */\r\n  constructor(public element: HTMLElement, public options: IRecommendationOptions = {}, public analyticsOptions = {}, _window = window) {\r\n    super(element, ComponentOptions.initComponentOptions(element, Recommendation, options), analyticsOptions, _window);\r\n    this.element.style.display = '';\r\n    if (!this.options.id) {\r\n      this.generateDefaultId();\r\n    }\r\n\r\n    // This is done to allow the component to be included in another search interface without triggering the parent events.\r\n    this.preventEventPropagation();\r\n\r\n    if (this.options.mainSearchInterface) {\r\n      this.bindToMainSearchInterface();\r\n    }\r\n\r\n    $$(this.element).on(QueryEvents.buildingQuery, (e: Event, args: IBuildingQueryEventArgs) =>\r\n      this.handleRecommendationBuildingQuery(args)\r\n    );\r\n    $$(this.element).on(QueryEvents.querySuccess, (e: Event, args: IQuerySuccessEventArgs) => this.handleRecommendationQuerySuccess(args));\r\n    $$(this.element).on(QueryEvents.noResults, (e: Event, args: INoResultsEventArgs) => this.handleRecommendationNoResults());\r\n    $$(this.element).on(QueryEvents.queryError, (e: Event, args: IQueryErrorEventArgs) => this.handleRecommendationQueryError());\r\n\r\n    if (!this.options.mainSearchInterface) {\r\n      // When the recommendation component is \"standalone\", we add additional safeguard against bad config.\r\n      this.ensureCurrentPageViewExistsInStore();\r\n    }\r\n    ResponsiveRecommendation.init(this.root, this, options);\r\n  }\r\n\r\n  public get historyStore() {\r\n    return this.queryController.historyStore;\r\n  }\r\n\r\n  public getId(): string {\r\n    return this.options.id;\r\n  }\r\n\r\n  public enable() {\r\n    super.enable();\r\n    this.show();\r\n  }\r\n\r\n  public disable() {\r\n    super.disable();\r\n    this.hide();\r\n  }\r\n\r\n  public hide(): void {\r\n    $$(this.element).addClass('coveo-hidden');\r\n  }\r\n\r\n  public show(): void {\r\n    $$(this.element).removeClass('coveo-hidden');\r\n  }\r\n\r\n  private ensureCurrentPageViewExistsInStore() {\r\n    // It's not 100% sure that the element will actually be added in the store.\r\n    // It's possible that an external script configured by the end user to log the page view already did that.\r\n    // So we *could* end up with duplicate values in the store :\r\n    // We rely on the fact that the coveo.analytics lib has defensive code against consecutive page view that are identical.\r\n    // This is mainly done if the recommendation component is being initialized before the page view could be logged correctly by the coveo.analytics externa lib.\r\n    const historyElement = {\r\n      name: 'PageView',\r\n      value: document.location.toString(),\r\n      time: JSON.stringify(new Date()),\r\n      title: _.escape(document.title)\r\n    };\r\n    this.historyStore.addElement(historyElement);\r\n  }\r\n\r\n  private bindToMainSearchInterface() {\r\n    this.bindComponentOptionsModelToMainSearchInterface();\r\n    this.bindQueryEventsToMainSearchInterface();\r\n  }\r\n\r\n  private bindComponentOptionsModelToMainSearchInterface() {\r\n    // Try to fetch the componentOptions from the main search interface.\r\n    // Since we do not know which interface is init first (recommendation or full search interface)\r\n    // add a mechanism that waits for the full search interface to be correctly initialized\r\n    // then, set the needed values on the component options model.\r\n    let searchInterfaceComponent = <SearchInterface>get(this.options.mainSearchInterface, SearchInterface);\r\n    const alreadyInitialized = searchInterfaceComponent != null;\r\n\r\n    const onceInitialized = () => {\r\n      const mainSearchInterfaceOptionsModel = <ComponentOptionsModel>searchInterfaceComponent.getBindings().componentOptionsModel;\r\n      this.componentOptionsModel.setMultiple(mainSearchInterfaceOptionsModel.getAttributes());\r\n      $$(this.options.mainSearchInterface).on(this.componentOptionsModel.getEventName(MODEL_EVENTS.ALL), () => {\r\n        this.componentOptionsModel.setMultiple(mainSearchInterfaceOptionsModel.getAttributes());\r\n      });\r\n    };\r\n\r\n    if (alreadyInitialized) {\r\n      onceInitialized();\r\n    } else {\r\n      $$(this.options.mainSearchInterface).on(InitializationEvents.afterComponentsInitialization, () => {\r\n        searchInterfaceComponent = <SearchInterface>get(this.options.mainSearchInterface, SearchInterface);\r\n        onceInitialized();\r\n      });\r\n    }\r\n  }\r\n\r\n  private bindQueryEventsToMainSearchInterface() {\r\n    // Whenever a query sucessfully returns on the full search interface, refresh the recommendation component.\r\n    $$(this.options.mainSearchInterface).on(QueryEvents.querySuccess, (e: Event, args: IQuerySuccessEventArgs) => {\r\n      this.mainInterfaceQuery = args;\r\n      this.mainQuerySearchUID = args.results.searchUid;\r\n      this.mainQueryPipeline = args.results.pipeline;\r\n      if (args.results.results.length != 0) {\r\n        this.usageAnalytics.logSearchEvent<IAnalyticsNoMeta>(analyticsActionCauseList.recommendation, {});\r\n        this.queryController.executeQuery({\r\n          closeModalBox: false\r\n        });\r\n      }\r\n    });\r\n\r\n    $$(this.options.mainSearchInterface).on(QueryEvents.queryError, () => this.hide());\r\n    $$(this.options.mainSearchInterface).on(QueryEvents.noResults, () => this.hide());\r\n  }\r\n\r\n  private handleRecommendationBuildingQuery(data: IBuildingQueryEventArgs) {\r\n    if (!this.disabled) {\r\n      this.modifyQueryForRecommendation(data);\r\n      this.addRecommendationInfoInQuery(data);\r\n    }\r\n  }\r\n\r\n  private handleRecommendationQuerySuccess(data: IQuerySuccessEventArgs) {\r\n    if (!this.disabled) {\r\n      if (this.options.hideIfNoResults) {\r\n        if (data.results.totalCount === 0) {\r\n          this.hide();\r\n        } else {\r\n          this.show();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleRecommendationNoResults() {\r\n    if (!this.disabled) {\r\n      if (this.options.hideIfNoResults) {\r\n        this.hide();\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleRecommendationQueryError() {\r\n    if (!this.disabled) {\r\n      this.hide();\r\n    }\r\n  }\r\n\r\n  private modifyQueryForRecommendation(data: IBuildingQueryEventArgs) {\r\n    if (this.mainInterfaceQuery) {\r\n      Utils.copyObjectAttributes(data.queryBuilder, this.mainInterfaceQuery.queryBuilder, this.options.optionsToUse);\r\n    }\r\n  }\r\n\r\n  private addRecommendationInfoInQuery(data: IBuildingQueryEventArgs) {\r\n    if (!_.isEmpty(this.options.userContext)) {\r\n      data.queryBuilder.addContext(this.options.userContext);\r\n    }\r\n\r\n    data.queryBuilder.recommendation = this.options.id;\r\n  }\r\n\r\n  private preventEventPropagation() {\r\n    this.preventEventPropagationOn(QueryEvents);\r\n    this.preventEventPropagationOn(OmniboxEvents);\r\n    this.preventEventPropagationOn(ResultListEvents);\r\n    this.preventEventPropagationOn(SettingsEvents);\r\n    this.preventEventPropagationOn(PreferencesPanelEvents);\r\n    this.preventEventPropagationOn(AnalyticsEvents);\r\n    this.preventEventPropagationOn(BreadcrumbEvents);\r\n    this.preventEventPropagationOn(QuickviewEvents);\r\n    this.preventEventPropagationOn(InitializationEvents);\r\n    this.preventEventPropagationOn(this.getAllModelEvents());\r\n  }\r\n\r\n  private preventEventPropagationOn(\r\n    eventType,\r\n    eventName = (event: string) => {\r\n      return event;\r\n    }\r\n  ) {\r\n    for (const event in eventType) {\r\n      $$(this.root).on(eventName(event), (e: Event) => e.stopPropagation());\r\n    }\r\n  }\r\n\r\n  private getAllModelEvents() {\r\n    const events = {};\r\n    const queryStateModel = this.getBindings().queryStateModel;\r\n    _.each(_.values(Model.eventTypes), event => {\r\n      const eventName = queryStateModel.getEventName(event);\r\n      events[eventName] = eventName;\r\n      _.each(_.values(QUERY_STATE_ATTRIBUTES), attribute => {\r\n        const eventName = this.queryStateModel.getEventName(event + attribute);\r\n        events[eventName] = eventName;\r\n      });\r\n    });\r\n    return events;\r\n  }\r\n\r\n  private generateDefaultId() {\r\n    let id = 'Recommendation';\r\n    if (Recommendation.NEXT_ID !== 1) {\r\n      this.logger.warn(\r\n        'Generating another recommendation default id',\r\n        'Consider configuring a human friendly / meaningful id for this interface'\r\n      );\r\n      id = id + '_' + Recommendation.NEXT_ID;\r\n    }\r\n    Recommendation.NEXT_ID++;\r\n    this.options.id = id;\r\n  }\r\n}\r\n\r\n// We do not register the Recommendation component since it is done with .coveo('initRecommendation')\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Recommendation/Recommendation.ts","/**\r\n * The `IQuickviewLoadedEventArgs` interface describes the object that all\r\n * [`quickviewLoaded`]{@link QuickviewEvents.quickviewLoaded} event handlers receive as an argument.\r\n */\r\nexport interface IQuickviewLoadedEventArgs {\r\n  /**\r\n   * The amount of time it took to download the content to display in the quickview modal window (in milliseconds).\r\n   */\r\n  duration: number;\r\n}\r\n\r\n/**\r\n * The `QuickviewEvents` static class contains the string definitions of all events that strongly relate to the\r\n * [`Quickview`]{@link Quickview} component.\r\n */\r\nexport class QuickviewEvents {\r\n  /**\r\n   * Triggered by the [`QuickviewDocument`]{@link QuickviewDocument} component when the content to display in the\r\n   * quickview modal window has just finished downloading.\r\n   *\r\n   * The [`Quickview`]{@link Quickview} component listens to this event to know when to remove its loading animation.\r\n   *\r\n   * All `quickviewLoaded` event handlers receive a [`QuickviewLoadedEventArgs`]{@link IQuickviewLoadedEventArgs} object\r\n   * as an argument.\r\n   *\r\n   * @type {string} The string value is `quickviewLoaded`.\r\n   */\r\n  public static quickviewLoaded = 'quickviewLoaded';\r\n\r\n  /**\r\n   * Triggered by the [`QuickviewDocument`]{@link QuickviewDocument} component when the end user has just clicked the\r\n   * **Quickview** button/link to open the quickview modal window.\r\n   *\r\n   * This event allows external code to modify the terms to highlight before the content of the quickview modal window\r\n   * is rendered.\r\n   *\r\n   * All `openQuickview` event handlers receive an\r\n   * [`OpenQuickviewEventArgs`]{@link ResultListEvents.IOpenQuickviewEventArgs} object as an argument.\r\n   *\r\n   * @type {string} The string value is `openQuickview`.\r\n   */\r\n  public static openQuickview = 'openQuickview';\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/events/QuickviewEvents.ts","import { Template } from './Template';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\n\r\nexport class DefaultRecommendationTemplate extends Template {\r\n  instantiateToString(object?: IQueryResult): string {\r\n    var template = `<div class=\"coveo-result-frame\">\r\n        <div class=\"coveo-result-row\">\r\n          <div class=\"coveo-result-cell\" style=\"width:40px;text-align:center;vertical-align:middle;\">\r\n            <span class=\"CoveoIcon\" data-small=\"true\" data-with-label=\"false\">\r\n            </span>\r\n          </div>\r\n          <div class=\"coveo-result-cell\" style=\"padding:0 0 3px 5px;vertical-align:middle\">\r\n            <div class=\"coveo-result-row\">\r\n              <div class=\"coveo-result-cell\" style=\"font-size:10pt;\">\r\n                <a class=\"CoveoResultLink\" style=\"display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">\r\n                </a>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>`;\r\n    return template;\r\n  }\r\n\r\n  instantiateToElement(object?: IQueryResult): Promise<HTMLElement> {\r\n    return new Promise((resolve, reject) => {\r\n      var div = document.createElement('div');\r\n      div.innerHTML = this.instantiateToString(object);\r\n      resolve(div);\r\n    });\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Templates/DefaultRecommendationTemplate.ts","import { ResponsiveComponentsManager, IResponsiveComponent, IResponsiveComponentOptions } from './ResponsiveComponentsManager';\r\nimport { ResponsiveComponentsUtils } from './ResponsiveComponentsUtils';\r\nimport { SearchInterface } from '../SearchInterface/SearchInterface';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { $$, Dom } from '../../utils/Dom';\r\nimport { Logger } from '../../misc/Logger';\r\nimport { Recommendation } from '../Recommendation/Recommendation';\r\nimport { RecommendationDropdownContent } from './ResponsiveDropdown/RecommendationDropdownContent';\r\nimport { ResponsiveDropdownHeader } from './ResponsiveDropdown/ResponsiveDropdownHeader';\r\nimport { ResponsiveDropdown } from './ResponsiveDropdown/ResponsiveDropdown';\r\nimport { l } from '../../strings/Strings';\r\nimport { Component } from '../Base/Component';\r\nimport { get } from '../Base/RegisteredNamedMethods';\r\nimport { QueryEvents, IQuerySuccessEventArgs, INoResultsEventArgs } from '../../events/QueryEvents';\r\nimport * as _ from 'underscore';\r\n\r\nimport 'styling/_ResponsiveRecommendation';\r\nimport { Defer } from '../../MiscModules';\r\n\r\nexport class ResponsiveRecommendation implements IResponsiveComponent {\r\n  public static DROPDOWN_CONTAINER_CSS_CLASS_NAME: string = 'coveo-recommendation-dropdown-container';\r\n  public static RESPONSIVE_BREAKPOINT = 1000;\r\n\r\n  public recommendationRoot: Dom;\r\n  private breakpoint: number;\r\n  private dropdown: ResponsiveDropdown;\r\n  private dropdownHeaderLabel: string;\r\n  private searchInterface: SearchInterface;\r\n\r\n  public static init(root: HTMLElement, component, options: IResponsiveComponentOptions) {\r\n    let logger = new Logger('ResponsiveRecommendation');\r\n    let coveoRoot = this.findParentRootOfRecommendationComponent(root);\r\n    if (!coveoRoot) {\r\n      logger.info('Recommendation component has no parent interface. Disabling responsive mode for this component.');\r\n      return;\r\n    }\r\n\r\n    if (!$$(coveoRoot).find('.coveo-results-column')) {\r\n      logger.info('Cannot find element with class coveo-results-column. Disabling responsive mode for this component.');\r\n      return;\r\n    }\r\n\r\n    ResponsiveComponentsManager.register(\r\n      ResponsiveRecommendation,\r\n      $$(coveoRoot),\r\n      Recommendation.ID,\r\n      component,\r\n      _.extend({}, options, { initializationEventRoot: $$(root) })\r\n    );\r\n  }\r\n\r\n  private static findParentRootOfRecommendationComponent(root: HTMLElement): Dom {\r\n    let coveoRoot = $$(root).parents(Component.computeCssClassName(SearchInterface));\r\n    if (coveoRoot[0]) {\r\n      return $$(coveoRoot[0]);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  constructor(\r\n    public coveoRoot: Dom,\r\n    public ID: string,\r\n    options: IResponsiveComponentOptions,\r\n    public responsiveDropdown?: ResponsiveDropdown\r\n  ) {\r\n    this.recommendationRoot = this.getRecommendationRoot();\r\n    this.dropdownHeaderLabel = options.dropdownHeaderLabel;\r\n    this.breakpoint = this.defineResponsiveBreakpoint(options);\r\n    this.searchInterface = <SearchInterface>Component.get(this.coveoRoot.el, SearchInterface, false);\r\n    this.dropdown = this.buildDropdown(responsiveDropdown);\r\n    this.registerOnOpenHandler();\r\n    this.registerQueryEvents();\r\n    this.handleResizeEvent();\r\n  }\r\n\r\n  public handleResizeEvent(): void {\r\n    if (this.needSmallMode() && !ResponsiveComponentsUtils.isSmallRecommendationActivated(this.coveoRoot)) {\r\n      this.changeToSmallMode();\r\n    } else if (!this.needSmallMode() && ResponsiveComponentsUtils.isSmallRecommendationActivated(this.coveoRoot)) {\r\n      this.changeToLargeMode();\r\n    }\r\n\r\n    if (this.dropdown.isOpened) {\r\n      this.dropdown.dropdownContent.positionDropdown();\r\n    }\r\n  }\r\n\r\n  public needDropdownWrapper(): boolean {\r\n    return this.needSmallMode();\r\n  }\r\n\r\n  private needSmallMode(): boolean {\r\n    const isWidthSmallerThanBreakpoint = this.coveoRoot.width() <= this.breakpoint;\r\n    if (!this.searchInterface) {\r\n      return isWidthSmallerThanBreakpoint;\r\n    }\r\n\r\n    switch (this.searchInterface.responsiveComponents.getResponsiveMode()) {\r\n      case 'small':\r\n        return true;\r\n      case 'auto':\r\n        return isWidthSmallerThanBreakpoint;\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  private changeToSmallMode() {\r\n    this.dropdown.close();\r\n    const header = this.coveoRoot.find(`.${ResponsiveComponentsManager.DROPDOWN_HEADER_WRAPPER_CSS_CLASS}`);\r\n    if (!header) {\r\n      // It's possible that recommendation gets initialized before the main interface is completed.\r\n      // We defer the resize event execution in that case.\r\n      Defer.defer(() => this.handleResizeEvent());\r\n    } else {\r\n      $$(header).append(this.dropdown.dropdownHeader.element.el);\r\n      this.disableFacetPreservePosition();\r\n      ResponsiveComponentsUtils.activateSmallRecommendation(this.coveoRoot);\r\n      ResponsiveComponentsUtils.activateSmallRecommendation(this.recommendationRoot);\r\n    }\r\n  }\r\n\r\n  private changeToLargeMode() {\r\n    this.enableFacetPreservePosition();\r\n    this.dropdown.cleanUp();\r\n    ResponsiveComponentsUtils.deactivateSmallRecommendation(this.coveoRoot);\r\n    ResponsiveComponentsUtils.deactivateSmallRecommendation(this.recommendationRoot);\r\n  }\r\n\r\n  private buildDropdown(responsiveDropdown?: ResponsiveDropdown): ResponsiveDropdown {\r\n    let dropdownContent = this.buildDropdownContent();\r\n    let dropdownHeader = this.buildDropdownHeader();\r\n    let dropdown = responsiveDropdown ? responsiveDropdown : new ResponsiveDropdown(dropdownContent, dropdownHeader, this.coveoRoot);\r\n    dropdown.disablePopupBackground();\r\n    return dropdown;\r\n  }\r\n\r\n  private buildDropdownHeader(): ResponsiveDropdownHeader {\r\n    let dropdownHeaderElement = $$('a');\r\n    let content = $$('p');\r\n    content.text(l(this.dropdownHeaderLabel));\r\n    dropdownHeaderElement.el.appendChild(content.el);\r\n    let dropdownHeader = new ResponsiveDropdownHeader('recommendation', dropdownHeaderElement);\r\n    return dropdownHeader;\r\n  }\r\n\r\n  private buildDropdownContent(): RecommendationDropdownContent {\r\n    let dropdownContentElement: Dom;\r\n    let recommendationColumn = this.coveoRoot.find('.coveo-recommendation-column');\r\n    if (recommendationColumn) {\r\n      dropdownContentElement = $$(recommendationColumn);\r\n    } else {\r\n      dropdownContentElement = $$(this.coveoRoot.find('.' + Component.computeCssClassName(Recommendation)));\r\n    }\r\n\r\n    let dropdownContent = new RecommendationDropdownContent('recommendation', dropdownContentElement, this.coveoRoot);\r\n    return dropdownContent;\r\n  }\r\n\r\n  private defineResponsiveBreakpoint(options: IResponsiveComponentOptions): number {\r\n    let breakpoint;\r\n    if (Utils.isNullOrUndefined(options.responsiveBreakpoint)) {\r\n      breakpoint = ResponsiveRecommendation.RESPONSIVE_BREAKPOINT;\r\n    } else {\r\n      breakpoint = options.responsiveBreakpoint;\r\n    }\r\n    return breakpoint;\r\n  }\r\n\r\n  private getFacetSliders(): any[] {\r\n    const facetSliders = [];\r\n    this.coveoRoot.findAll(Component.computeSelectorForType('FacetSlider')).forEach(facetSliderElement => {\r\n      const facetSlider = Component.get(facetSliderElement);\r\n      facetSlider && facetSliders.push(facetSlider);\r\n    });\r\n    return facetSliders;\r\n  }\r\n\r\n  private getFacets(): any[] {\r\n    const facets = [];\r\n    this.coveoRoot.findAll(Component.computeSelectorForType('Facet')).forEach(facetElement => {\r\n      const facet = Component.get(facetElement);\r\n      facet && facets.push(facet);\r\n    });\r\n    return facets;\r\n  }\r\n\r\n  private enableFacetPreservePosition(): void {\r\n    this.getFacets().forEach(facet => (facet.options.preservePosition = true));\r\n  }\r\n\r\n  private disableFacetPreservePosition(): void {\r\n    this.getFacets().forEach(facet => (facet.options.preservePosition = false));\r\n  }\r\n\r\n  private drawFacetSliderGraphs(): void {\r\n    this.getFacetSliders().forEach(facetSlider => facetSlider.drawDelayedGraphData());\r\n  }\r\n\r\n  private registerOnOpenHandler(): void {\r\n    this.dropdown.registerOnOpenHandler(this.drawFacetSliderGraphs, this);\r\n  }\r\n\r\n  private getRecommendationRoot(): Dom {\r\n    return $$(this.coveoRoot.find('.' + Component.computeCssClassName(Recommendation)));\r\n  }\r\n\r\n  private registerQueryEvents() {\r\n    let recommendationInstance = <Recommendation>get(this.recommendationRoot.el, SearchInterface);\r\n    if (recommendationInstance && recommendationInstance.options.hideIfNoResults) {\r\n      this.coveoRoot.on(QueryEvents.querySuccess, (e: Event, data: IQuerySuccessEventArgs) => this.handleRecommnendationQuerySucess(data));\r\n      this.coveoRoot.on(QueryEvents.noResults, (e: Event, data: INoResultsEventArgs) => this.handleRecommendationNoResults());\r\n    }\r\n    this.coveoRoot.on(QueryEvents.queryError, () => this.handleRecommendationQueryError());\r\n  }\r\n\r\n  private handleRecommnendationQuerySucess(data: IQuerySuccessEventArgs) {\r\n    if (data.results.totalCount === 0) {\r\n      this.dropdown.close();\r\n      this.dropdown.dropdownHeader.hide();\r\n    } else {\r\n      this.dropdown.dropdownHeader.show();\r\n    }\r\n  }\r\n\r\n  private handleRecommendationNoResults() {\r\n    this.dropdown.close();\r\n    this.dropdown.dropdownHeader.hide();\r\n  }\r\n\r\n  private handleRecommendationQueryError() {\r\n    this.dropdown.close();\r\n    this.dropdown.dropdownHeader.hide();\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResponsiveComponents/ResponsiveRecommendation.ts","import { IResponsiveDropdownContent, ResponsiveDropdownContent } from './ResponsiveDropdownContent';\r\nimport { $$, Dom } from '../../../utils/Dom';\r\n\r\nexport class RecommendationDropdownContent implements IResponsiveDropdownContent {\r\n  public static OPENED_DROPDOWN_CSS_CLASS_NAME = 'coveo-open-dropdown-content';\r\n\r\n  private cssClassName: string;\r\n\r\n  constructor(componentName: string, public element: Dom, private coveoRoot: Dom) {\r\n    this.cssClassName = `coveo-${componentName}-dropdown-content`;\r\n    this.element.addClass(this.cssClassName);\r\n    this.element.addClass(ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME);\r\n  }\r\n\r\n  public positionDropdown() {\r\n    this.element.el.style.display = '';\r\n\r\n    let dropdownContentWrapper = this.coveoRoot.find('.coveo-results-column');\r\n    $$(dropdownContentWrapper).prepend(this.element.el);\r\n    this.element.addClass(ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME);\r\n    this.element.addClass(this.cssClassName);\r\n\r\n    // forces the browser to reflow the element, so that the transition is applied.\r\n    window.getComputedStyle(this.element.el).maxHeight;\r\n\r\n    this.element.addClass(RecommendationDropdownContent.OPENED_DROPDOWN_CSS_CLASS_NAME);\r\n  }\r\n\r\n  public hideDropdown() {\r\n    this.element.addClass(ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME);\r\n    this.element.addClass(this.cssClassName);\r\n\r\n    this.element.removeClass(RecommendationDropdownContent.OPENED_DROPDOWN_CSS_CLASS_NAME);\r\n  }\r\n\r\n  public cleanUp() {\r\n    this.element.removeClass(this.cssClassName);\r\n    this.element.removeClass(ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResponsiveComponents/ResponsiveDropdown/RecommendationDropdownContent.ts","import { Component } from '../Base/Component';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { QueryEvents, IBuildingQueryEventArgs } from '../../events/QueryEvents';\r\nimport { Initialization } from '../Base/Initialization';\r\nimport { $$ } from '../../utils/Dom';\r\nimport * as _ from 'underscore';\r\n\r\nexport interface IRecommendationQueryOptions {}\r\n\r\nexport class RecommendationQuery extends Component {\r\n  static ID = 'RecommendationQuery';\r\n\r\n  /**\r\n   * The options for the RecommendationQuery component\r\n   * @componentOptions\r\n   */\r\n  static options: IRecommendationQueryOptions = {};\r\n\r\n  private content: string;\r\n\r\n  constructor(public element: HTMLElement, public options?: IRecommendationQueryOptions, bindings?: IComponentBindings) {\r\n    super(element, RecommendationQuery.ID, bindings);\r\n    this.options = ComponentOptions.initComponentOptions(element, RecommendationQuery, options);\r\n\r\n    if (this.element.tagName.toLowerCase() === 'script') {\r\n      try {\r\n        this.content = Utils.decodeHTMLEntities($$(this.element).text());\r\n      } catch (e) {\r\n        return;\r\n      }\r\n      if (!_.isUndefined(this.content) && this.content != '') {\r\n        this.bind.onRootElement(QueryEvents.buildingQuery, this.handleBuildingQuery);\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleBuildingQuery(data: IBuildingQueryEventArgs) {\r\n    data.queryBuilder.advancedExpression.add(this.content);\r\n  }\r\n}\r\n\r\nInitialization.registerAutoCreateComponent(RecommendationQuery);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Recommendation/RecommendationQuery.ts"],"sourceRoot":""}
{"version":3,"sources":["YouTubeThumbnail.min__5f3280c404a1ee75a113.js","./src/ui/YouTube/YouTubeThumbnail.ts","./src/utils/AccessibleModal.ts","./src/ui/FocusTrap/FocusTrap.ts","./src/ui/ResultLink/ResultLink.ts"],"names":["webpackJsonpCoveo__temporary","185","module","exports","__webpack_require__","__extends","this","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","value","element","options","bindings","result","ModalBox","origin","YouTubeThumbnail","ID","ComponentOptions","initComponentOptions","resultLink","$$","className","Component","computeCssClassName","ResultLink","el","thumbnailDiv","append","img","src","Utils","getFieldValue","alt","title","style","width","height","onerror","svgVideo","SVGIcons","icons","video","SVGDom","addStyleToSVGInContainer","remove","span","Initialization","automaticallyCreateComponentsInsideResult","embed","onClick","openYoutubeIframe","modalbox","AccessibleModal","searchInterface","modalContainer","overlayClose","_this","openResultLink","get","openLinkAsConfigured","iframe","extractVideoId","allowfullscreen","div","openResult","showDate","content","validation","wrapper","find","on","close","clickUri","split","doExport","exportGlobally","buildStringOption","defaultValue","buildBooleanOption","registerAutoCreateComponent","220","__assign","assign","t","s","i","n","arguments","length","call","ownerElement","modalboxModule","sizeMod","focusTrap","enumerable","configurable","activeModal","modalBox","querySelector","parameters","isOpen","openModalAndTrap","DomUtils","getQuickviewHeader","makeAccessible","open","initiallyFocusedElement","document","activeElement","onModalClose","body","FocusTrap","setAttribute","headerElement","makeCloseButtonAccessible","closeButton","l","tabIndex","focus","KeyboardUtils","keypressAction","KEYBOARD","ENTER","click","disable","contains","465","container","hiddenElements","enable","sortBy","querySelectorAll","removeEventListener","focusInEvent","focusOutEvent","showHiddenElements","enabled","addEventListener","e","onFocusIn","onFocusOut","hideAllExcept","pop","removeAttribute","hideElement","getAttribute","push","hideSiblings","allowedElement","parent","parentElement","without","children","forEach","elementToHide","getFocusableSibling","previous","elements","focusableElements","currentIndex","indexOf","focusSibling","sibling","focusFirstElement","elementIsBefore","oldElement","newElement","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","onLosingFocus","Defer","defer","focusIsAllowed","elementIsInPage","relatedTarget","target","532","92","os","logOpenDocument","debounce","queryController","saveLastQuery","documentURL","undefined","escapedClickUri","usageAnalytics","logClickEvent","analyticsActionCauseList","documentOpen","documentTitle","author","root","flush","initialOptions","resultLinkOptions","componentOptionsModel","ComponentOptionsModel","attributesEnum","extend","resolveResult","openQuickview","raw","DeviceUtils","isMobileDevice","Assert","exists","quickviewShouldBeOpened","once","window","setTimeout","clearTimeout","renderUri","bindEventToOpen","test","innerHTML","getDisplayedTitle","getDisplayedTitleAsText","openLink","logAnalytics","location","href","getResultUri","openLinkInNewWindow","openLinkInOutlook","hasOutlookField","toExecuteOnOpen","bindOnClickIfNotUndefined","bindOpenQuickviewIfNotUndefined","setHrefIfNotAlready","openLinkThatIsNotAnAnchor","titleTemplate","newTitle","StringUtils","buildStringTemplateFromResult","StreamHighlightUtils","highlightStreamText","termsToHighlight","phrasesToHighlight","HighlightUtils","highlightString","titleHighlights","setHtml","text","escape","AccessibleButton","withElement","withLabel","withSelectAction","build","resultElement","trigger","ResultListEvents","preventDefault","elementIsAnAnchor","alwaysOpenInNewWindow","openInOutlook","isNonEmptyString","filterProtocol","uri","isAbsolute","isRelative","hrefTemplate","field","setField","tagName","OSUtils","OS_NAME","MACOSX","WINDOWS","isUriThatMustBeOpenedInQuickview","toLowerCase","QueryUtils","hasHTMLVersion","buildFieldOption","buildCustomOption"],"mappings":"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","file":"YouTubeThumbnail.min__5f3280c404a1ee75a113.js","sourcesContent":["webpackJsonpCoveo__temporary([25,63],{\n\n/***/ 185:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ExternalModulesShim_1 = __webpack_require__(26);\r\nvar GlobalExports_1 = __webpack_require__(3);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar SVGDom_1 = __webpack_require__(16);\r\nvar SVGIcons_1 = __webpack_require__(12);\r\nvar Utils_1 = __webpack_require__(4);\r\nvar Component_1 = __webpack_require__(7);\r\nvar ComponentOptions_1 = __webpack_require__(8);\r\nvar Initialization_1 = __webpack_require__(2);\r\nvar RegisteredNamedMethods_1 = __webpack_require__(30);\r\nvar ResultLink_1 = __webpack_require__(92);\r\nvar AccessibleModal_1 = __webpack_require__(220);\r\n/**\r\n * The YouTubeThumbnail component automatically fetches the thumbnail of a YouTube video.\r\n *\r\n * This component differs from the standard {@link Thumbnail} component because the thumbnail it outputs is always\r\n * clickable.\r\n *\r\n * Depending on the component configuration, clicking a YouTube thumbnail can either automatically open a modal box\r\n * containing the `iframe` from YouTube, or open the target URL in the current window (see\r\n * {@link YouTubeThumbnail.options.embed}).\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n */\r\nvar YouTubeThumbnail = /** @class */ (function (_super) {\r\n    __extends(YouTubeThumbnail, _super);\r\n    function YouTubeThumbnail(element, options, bindings, result, ModalBox, origin) {\r\n        if (ModalBox === void 0) { ModalBox = ExternalModulesShim_1.ModalBox; }\r\n        var _this = _super.call(this, element, YouTubeThumbnail.ID, bindings) || this;\r\n        _this.element = element;\r\n        _this.options = options;\r\n        _this.bindings = bindings;\r\n        _this.result = result;\r\n        _this.origin = origin;\r\n        _this.options = ComponentOptions_1.ComponentOptions.initComponentOptions(element, YouTubeThumbnail, options);\r\n        _this.resultLink = Dom_1.$$('a', {\r\n            className: Component_1.Component.computeCssClassName(ResultLink_1.ResultLink)\r\n        });\r\n        if (!origin) {\r\n            _this.origin = _this.resultLink.el;\r\n        }\r\n        var thumbnailDiv = Dom_1.$$('div', {\r\n            className: 'coveo-youtube-thumbnail-container'\r\n        });\r\n        _this.resultLink.append(thumbnailDiv.el);\r\n        var img = Dom_1.$$('img', {\r\n            src: Utils_1.Utils.getFieldValue(_this.result, 'ytthumbnailurl'),\r\n            className: 'coveo-youtube-thumbnail-img',\r\n            alt: _this.result.title,\r\n            title: _this.result.title\r\n        });\r\n        img.el.style.width = _this.options.width;\r\n        img.el.style.height = _this.options.height;\r\n        img.el.onerror = function () {\r\n            var svgVideo = Dom_1.$$('div', {}, SVGIcons_1.SVGIcons.icons.video).el;\r\n            SVGDom_1.SVGDom.addStyleToSVGInContainer(svgVideo, {\r\n                width: _this.options.width\r\n            });\r\n            Dom_1.$$(img).remove();\r\n            thumbnailDiv.append(svgVideo);\r\n        };\r\n        thumbnailDiv.append(img.el);\r\n        var span = Dom_1.$$('span', {\r\n            className: 'coveo-youtube-thumbnail-play-button'\r\n        });\r\n        thumbnailDiv.append(span.el);\r\n        Dom_1.$$(_this.element).append(_this.resultLink.el);\r\n        Initialization_1.Initialization.automaticallyCreateComponentsInsideResult(element, result, {\r\n            ResultLink: _this.options.embed ? { onClick: function () { return _this.openYoutubeIframe(); } } : null\r\n        });\r\n        _this.modalbox = new AccessibleModal_1.AccessibleModal('coveo-youtube-player', _this.searchInterface.options.modalContainer, ModalBox, {\r\n            overlayClose: true\r\n        });\r\n        return _this;\r\n    }\r\n    /**\r\n     * Open the result link embedded in this component.\r\n     *\r\n     * With a standard configuration of this component, this will open an iframe that automatically plays the video.\r\n     */\r\n    YouTubeThumbnail.prototype.openResultLink = function () {\r\n        var resultLinkComponent = RegisteredNamedMethods_1.get(this.resultLink.el);\r\n        resultLinkComponent.openLinkAsConfigured();\r\n    };\r\n    YouTubeThumbnail.prototype.openYoutubeIframe = function () {\r\n        var _this = this;\r\n        // need to put iframe inside div : iframe with position absolute and left:0, right : 0 , bottom: 0 is not standard/supported\r\n        var iframe = Dom_1.$$('iframe', {\r\n            src: \"https://www.youtube.com/embed/\" + this.extractVideoId() + \"?autoplay=1\",\r\n            allowfullscreen: 'allowfullscreen',\r\n            width: '100%',\r\n            height: '100%',\r\n            title: this.result.title\r\n        });\r\n        var div = Dom_1.$$('div');\r\n        div.append(iframe.el);\r\n        this.modalbox.openResult({\r\n            result: this.result,\r\n            options: { showDate: true, title: this.result.title },\r\n            bindings: this.bindings,\r\n            content: div.el,\r\n            validation: function () { return true; },\r\n            origin: this.origin\r\n        });\r\n        Dom_1.$$(Dom_1.$$(this.modalbox.wrapper).find('.coveo-quickview-close-button')).on('click', function () {\r\n            _this.modalbox.close();\r\n        });\r\n    };\r\n    YouTubeThumbnail.prototype.extractVideoId = function () {\r\n        return this.result.clickUri.split('watch?v=')[1];\r\n    };\r\n    YouTubeThumbnail.ID = 'YouTubeThumbnail';\r\n    YouTubeThumbnail.doExport = function () {\r\n        GlobalExports_1.exportGlobally({\r\n            YouTubeThumbnail: YouTubeThumbnail\r\n        });\r\n    };\r\n    /**\r\n     * @componentOptions\r\n     */\r\n    YouTubeThumbnail.options = {\r\n        /**\r\n         * Specifies the width (in pixels) of the YouTube thumbnail.\r\n         *\r\n         * Default value is `200px`.\r\n         */\r\n        width: ComponentOptions_1.ComponentOptions.buildStringOption({ defaultValue: '200px' }),\r\n        /**\r\n         * Specifies the height (in pixels) of the YouTube thumbnail.\r\n         *\r\n         * Default value is `112px`.\r\n         */\r\n        height: ComponentOptions_1.ComponentOptions.buildStringOption({ defaultValue: '112px' }),\r\n        /**\r\n         * Specifies whether clicking on the YouTube thumbnail loads the video in a modal box.\r\n         *\r\n         * Setting this option to `false` causes the browser to change its current location to that of the target URL when\r\n         * the end user clicks the YouTube thumbnail.\r\n         *\r\n         * Default value is `true`.\r\n         */\r\n        embed: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: true })\r\n    };\r\n    return YouTubeThumbnail;\r\n}(Component_1.Component));\r\nexports.YouTubeThumbnail = YouTubeThumbnail;\r\nInitialization_1.Initialization.registerAutoCreateComponent(YouTubeThumbnail);\r\n\n\n/***/ }),\n\n/***/ 220:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n            t[p] = s[p];\r\n    }\r\n    return t;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ExternalModulesShim_1 = __webpack_require__(26);\r\nvar FocusTrap_1 = __webpack_require__(465);\r\nvar Strings_1 = __webpack_require__(6);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar KeyboardUtils_1 = __webpack_require__(25);\r\nvar Core_1 = __webpack_require__(20);\r\nvar AccessibleModal = /** @class */ (function () {\r\n    function AccessibleModal(className, ownerElement, modalboxModule, options) {\r\n        if (modalboxModule === void 0) { modalboxModule = ExternalModulesShim_1.ModalBox; }\r\n        if (options === void 0) { options = {}; }\r\n        this.className = className;\r\n        this.ownerElement = ownerElement;\r\n        this.modalboxModule = modalboxModule;\r\n        this.options = __assign({\r\n            sizeMod: 'big'\r\n        }, options);\r\n    }\r\n    Object.defineProperty(AccessibleModal.prototype, \"isOpen\", {\r\n        get: function () {\r\n            return !!this.focusTrap;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AccessibleModal.prototype, \"element\", {\r\n        get: function () {\r\n            return this.activeModal && this.activeModal.modalBox;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AccessibleModal.prototype, \"content\", {\r\n        get: function () {\r\n            return this.activeModal && this.activeModal.content;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AccessibleModal.prototype, \"wrapper\", {\r\n        get: function () {\r\n            return this.activeModal && this.activeModal.wrapper;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AccessibleModal.prototype, \"headerElement\", {\r\n        get: function () {\r\n            return this.element && this.element.querySelector('.coveo-modal-header h1');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AccessibleModal.prototype.openResult = function (parameters) {\r\n        if (this.isOpen) {\r\n            return;\r\n        }\r\n        this.openModalAndTrap({\r\n            content: parameters.content,\r\n            validation: parameters.validation,\r\n            origin: parameters.origin,\r\n            title: Core_1.DomUtils.getQuickviewHeader(parameters.result, parameters.options, parameters.bindings).el\r\n        });\r\n        this.makeAccessible(parameters.options.title || parameters.result.title);\r\n    };\r\n    AccessibleModal.prototype.open = function (parameters) {\r\n        if (this.isOpen) {\r\n            return;\r\n        }\r\n        this.openModalAndTrap(parameters);\r\n        this.makeAccessible();\r\n    };\r\n    AccessibleModal.prototype.openModalAndTrap = function (parameters) {\r\n        var _this = this;\r\n        this.initiallyFocusedElement = parameters.origin || document.activeElement;\r\n        this.activeModal = this.modalboxModule.open(parameters.content, {\r\n            title: parameters.title,\r\n            className: this.className,\r\n            validation: function () {\r\n                _this.onModalClose();\r\n                return parameters.validation();\r\n            },\r\n            body: this.ownerElement,\r\n            sizeMod: this.options.sizeMod,\r\n            overlayClose: this.options.overlayClose\r\n        });\r\n        this.focusTrap = new FocusTrap_1.FocusTrap(this.element);\r\n    };\r\n    AccessibleModal.prototype.close = function () {\r\n        if (!this.isOpen) {\r\n            return;\r\n        }\r\n        this.activeModal.close();\r\n        this.activeModal = null;\r\n    };\r\n    AccessibleModal.prototype.makeAccessible = function (title) {\r\n        this.element.setAttribute('aria-modal', 'true');\r\n        if (title) {\r\n            this.headerElement.setAttribute('aria-label', title);\r\n        }\r\n        this.makeCloseButtonAccessible();\r\n    };\r\n    AccessibleModal.prototype.makeCloseButtonAccessible = function () {\r\n        var closeButton = this.element.querySelector('.coveo-small-close');\r\n        closeButton.setAttribute('aria-label', Strings_1.l('Close'));\r\n        closeButton.setAttribute('role', 'button');\r\n        closeButton.tabIndex = 0;\r\n        closeButton.focus();\r\n        Dom_1.$$(closeButton).on('keyup', KeyboardUtils_1.KeyboardUtils.keypressAction(KeyboardUtils_1.KEYBOARD.ENTER, function () { return closeButton.click(); }));\r\n    };\r\n    AccessibleModal.prototype.onModalClose = function () {\r\n        this.focusTrap.disable();\r\n        this.focusTrap = null;\r\n        if (this.initiallyFocusedElement && document.body.contains(this.initiallyFocusedElement)) {\r\n            this.initiallyFocusedElement.focus();\r\n        }\r\n    };\r\n    return AccessibleModal;\r\n}());\r\nexports.AccessibleModal = AccessibleModal;\r\n\n\n/***/ }),\n\n/***/ 465:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Defer_1 = __webpack_require__(31);\r\nvar underscore_1 = __webpack_require__(0);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar FocusTrap = /** @class */ (function () {\r\n    function FocusTrap(container) {\r\n        this.container = container;\r\n        this.hiddenElements = [];\r\n        this.enable();\r\n    }\r\n    Object.defineProperty(FocusTrap.prototype, \"focusableElements\", {\r\n        get: function () {\r\n            return underscore_1.sortBy(this.container.querySelectorAll('[tabindex]'), function (element) { return element.tabIndex; });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FocusTrap.prototype.disable = function () {\r\n        document.removeEventListener('focusin', this.focusInEvent);\r\n        document.removeEventListener('focusout', this.focusOutEvent);\r\n        this.showHiddenElements();\r\n        this.enabled = false;\r\n    };\r\n    FocusTrap.prototype.enable = function () {\r\n        var _this = this;\r\n        document.addEventListener('focusin', (this.focusInEvent = function (e) { return _this.onFocusIn(e); }));\r\n        document.addEventListener('focusout', (this.focusOutEvent = function (e) { return _this.onFocusOut(e); }));\r\n        this.hideAllExcept(this.container);\r\n        this.enabled = true;\r\n    };\r\n    FocusTrap.prototype.showHiddenElements = function () {\r\n        while (this.hiddenElements.length) {\r\n            this.hiddenElements.pop().removeAttribute('aria-hidden');\r\n        }\r\n    };\r\n    FocusTrap.prototype.hideElement = function (element) {\r\n        if (element.getAttribute('aria-hidden')) {\r\n            return;\r\n        }\r\n        this.hiddenElements.push(element);\r\n        element.setAttribute('aria-hidden', \"\" + true);\r\n    };\r\n    FocusTrap.prototype.hideSiblings = function (allowedElement) {\r\n        var _this = this;\r\n        var parent = allowedElement.parentElement;\r\n        if (parent) {\r\n            underscore_1.without(Dom_1.$$(parent).children(), allowedElement).forEach(function (elementToHide) {\r\n                _this.hideElement(elementToHide);\r\n            });\r\n        }\r\n    };\r\n    FocusTrap.prototype.hideAllExcept = function (allowedElement) {\r\n        this.hideSiblings(allowedElement);\r\n        var parent = allowedElement.parentElement;\r\n        if (parent && parent !== document.body) {\r\n            this.hideAllExcept(parent);\r\n        }\r\n    };\r\n    FocusTrap.prototype.getFocusableSibling = function (element, previous) {\r\n        if (previous === void 0) { previous = false; }\r\n        var elements = this.focusableElements;\r\n        var currentIndex = elements.indexOf(element);\r\n        if (currentIndex === -1) {\r\n            return null;\r\n        }\r\n        return elements[(currentIndex + (previous ? -1 : 1) + elements.length) % elements.length];\r\n    };\r\n    FocusTrap.prototype.focusSibling = function (element, previous) {\r\n        if (previous === void 0) { previous = false; }\r\n        var sibling = this.getFocusableSibling(element, previous);\r\n        if (sibling) {\r\n            sibling.focus();\r\n        }\r\n    };\r\n    FocusTrap.prototype.focusFirstElement = function () {\r\n        var elements = this.focusableElements;\r\n        if (elements.length) {\r\n            elements[0].focus();\r\n        }\r\n    };\r\n    FocusTrap.prototype.elementIsBefore = function (oldElement, newElement) {\r\n        if (!newElement) {\r\n            return false;\r\n        }\r\n        return oldElement.compareDocumentPosition(newElement) === Node.DOCUMENT_POSITION_PRECEDING;\r\n    };\r\n    FocusTrap.prototype.onLosingFocus = function (oldElement, newElement) {\r\n        var _this = this;\r\n        Defer_1.Defer.defer(function () {\r\n            if (!_this.enabled) {\r\n                return;\r\n            }\r\n            _this.enabled = false;\r\n            if (oldElement && _this.focusIsAllowed(oldElement)) {\r\n                _this.focusSibling(oldElement, _this.elementIsBefore(oldElement, newElement));\r\n            }\r\n            else {\r\n                _this.focusFirstElement();\r\n            }\r\n            _this.enabled = true;\r\n        });\r\n    };\r\n    FocusTrap.prototype.focusIsAllowed = function (element) {\r\n        return this.container.contains(element);\r\n    };\r\n    FocusTrap.prototype.elementIsInPage = function (element) {\r\n        return element && element !== document.body.parentElement;\r\n    };\r\n    FocusTrap.prototype.onFocusIn = function (e) {\r\n        if (!this.enabled) {\r\n            return;\r\n        }\r\n        var oldElement = e.relatedTarget;\r\n        var handledByFocusOut = this.elementIsInPage(oldElement);\r\n        if (handledByFocusOut) {\r\n            return;\r\n        }\r\n        var newElement = e.target;\r\n        if (!this.elementIsInPage(newElement)) {\r\n            return;\r\n        }\r\n        if (!this.focusIsAllowed(newElement)) {\r\n            this.onLosingFocus(null, newElement);\r\n        }\r\n    };\r\n    FocusTrap.prototype.onFocusOut = function (e) {\r\n        if (!this.enabled) {\r\n            return;\r\n        }\r\n        var newElement = e.relatedTarget;\r\n        if (!this.elementIsInPage(newElement)) {\r\n            return;\r\n        }\r\n        if (!newElement || !this.focusIsAllowed(newElement)) {\r\n            this.onLosingFocus(e.target, newElement);\r\n        }\r\n    };\r\n    return FocusTrap;\r\n}());\r\nexports.FocusTrap = FocusTrap;\r\n\n\n/***/ }),\n\n/***/ 532:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 92:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Component_1 = __webpack_require__(7);\r\nvar ComponentOptions_1 = __webpack_require__(8);\r\nvar ComponentOptionsModel_1 = __webpack_require__(28);\r\nvar AnalyticsActionListMeta_1 = __webpack_require__(10);\r\nvar ResultListEvents_1 = __webpack_require__(29);\r\nvar HighlightUtils_1 = __webpack_require__(68);\r\nvar DeviceUtils_1 = __webpack_require__(24);\r\nvar OSUtils_1 = __webpack_require__(181);\r\nvar Initialization_1 = __webpack_require__(2);\r\nvar QueryUtils_1 = __webpack_require__(21);\r\nvar Assert_1 = __webpack_require__(5);\r\nvar Utils_1 = __webpack_require__(4);\r\nvar Defer_1 = __webpack_require__(31);\r\nvar Dom_1 = __webpack_require__(1);\r\nvar StreamHighlightUtils_1 = __webpack_require__(114);\r\nvar StringUtils_1 = __webpack_require__(22);\r\nvar underscore_1 = __webpack_require__(0);\r\nvar GlobalExports_1 = __webpack_require__(3);\r\n__webpack_require__(532);\r\nvar AccessibleButton_1 = __webpack_require__(15);\r\n/**\r\n * The `ResultLink` component automatically transform a search result title into a clickable link pointing to the\r\n * original item.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n */\r\nvar ResultLink = /** @class */ (function (_super) {\r\n    __extends(ResultLink, _super);\r\n    /**\r\n     * Creates a new `ResultLink` component.\r\n     * @param element The HTMLElement on which to instantiate the component.\r\n     * @param options The options for the `ResultLink` component.\r\n     * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n     * automatically resolved (with a slower execution time).\r\n     * @param result The result to associate the component with.\r\n     * @param os\r\n     */\r\n    function ResultLink(element, options, bindings, result, os) {\r\n        var _this = _super.call(this, element, ResultLink.ID, bindings) || this;\r\n        _this.element = element;\r\n        _this.options = options;\r\n        _this.bindings = bindings;\r\n        _this.result = result;\r\n        _this.os = os;\r\n        _this.logOpenDocument = underscore_1.debounce(function () {\r\n            _this.queryController.saveLastQuery();\r\n            var documentURL = Dom_1.$$(_this.element).getAttribute('href');\r\n            if (documentURL == undefined || documentURL == '') {\r\n                documentURL = _this.escapedClickUri;\r\n            }\r\n            _this.usageAnalytics.logClickEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.documentOpen, {\r\n                documentURL: documentURL,\r\n                documentTitle: _this.result.title,\r\n                author: Utils_1.Utils.getFieldValue(_this.result, 'author')\r\n            }, _this.result, _this.root);\r\n            Defer_1.Defer.flush();\r\n        }, 1500, true);\r\n        var initialOptions = ComponentOptions_1.ComponentOptions.initComponentOptions(element, ResultLink, options);\r\n        var resultLinkOptions = _this.componentOptionsModel.get(ComponentOptionsModel_1.ComponentOptionsModel.attributesEnum.resultLink);\r\n        _this.options = underscore_1.extend({}, initialOptions, resultLinkOptions);\r\n        _this.result = result || _this.resolveResult();\r\n        if (_this.options.openQuickview == null) {\r\n            _this.options.openQuickview = result.raw['connectortype'] == 'ExchangeCrawler' && DeviceUtils_1.DeviceUtils.isMobileDevice();\r\n        }\r\n        _this.element.setAttribute('tabindex', '0');\r\n        Assert_1.Assert.exists(_this.componentOptionsModel);\r\n        Assert_1.Assert.exists(_this.result);\r\n        if (!_this.quickviewShouldBeOpened()) {\r\n            // Bind on multiple \"click\" or \"mouse\" events.\r\n            // Create a function that will be executed only once, so as not to log multiple events\r\n            // Once a result link has been opened, and that we log at least one analytics event,\r\n            // it should not matter if the end user open the same link multiple times with different methods.\r\n            // It's still only one \"click\" event as far as UA is concerned.\r\n            // Also need to handle \"longpress\" on mobile (the contextual menu), which we assume to be 1 s long.\r\n            var executeOnlyOnce_1 = underscore_1.once(function () { return _this.logOpenDocument(); });\r\n            Dom_1.$$(element).on(['contextmenu', 'click', 'mousedown', 'mouseup'], executeOnlyOnce_1);\r\n            var longPressTimer_1;\r\n            Dom_1.$$(element).on('touchstart', function () {\r\n                longPressTimer_1 = window.setTimeout(executeOnlyOnce_1, 1000);\r\n            });\r\n            Dom_1.$$(element).on('touchend', function () {\r\n                if (longPressTimer_1) {\r\n                    clearTimeout(longPressTimer_1);\r\n                }\r\n            });\r\n        }\r\n        _this.renderUri(element, result);\r\n        _this.bindEventToOpen();\r\n        return _this;\r\n    }\r\n    ResultLink.prototype.renderUri = function (element, result) {\r\n        if (/^\\s*$/.test(this.element.innerHTML)) {\r\n            var title = this.getDisplayedTitle();\r\n            this.element.innerHTML = title;\r\n            if (!this.element.title) {\r\n                this.element.title = this.getDisplayedTitleAsText();\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Opens the result in the same window, no matter how the actual component is configured for the end user.\r\n     * @param logAnalytics Specifies whether the method should log an analytics event.\r\n     */\r\n    ResultLink.prototype.openLink = function (logAnalytics) {\r\n        if (logAnalytics === void 0) { logAnalytics = true; }\r\n        if (logAnalytics) {\r\n            this.logOpenDocument();\r\n        }\r\n        window.location.href = this.getResultUri();\r\n    };\r\n    /**\r\n     * Opens the result in a new window, no matter how the actual component is configured for the end user.\r\n     * @param logAnalytics Specifies whether the method should log an analytics event.\r\n     */\r\n    ResultLink.prototype.openLinkInNewWindow = function (logAnalytics) {\r\n        if (logAnalytics === void 0) { logAnalytics = true; }\r\n        if (logAnalytics) {\r\n            this.logOpenDocument();\r\n        }\r\n        window.open(this.getResultUri(), '_blank');\r\n    };\r\n    /**\r\n     * Tries to open the result in Microsoft Outlook if the result has an `outlookformacuri` or `outlookuri` field.\r\n     *\r\n     * Normally, this implies the result should be a link to an email.\r\n     *\r\n     * If the needed fields are not present, this method does nothing.\r\n     * @param logAnalytics Specifies whether the method should log an analytics event.\r\n     */\r\n    ResultLink.prototype.openLinkInOutlook = function (logAnalytics) {\r\n        if (logAnalytics === void 0) { logAnalytics = true; }\r\n        if (this.hasOutlookField()) {\r\n            if (logAnalytics) {\r\n                this.logOpenDocument();\r\n            }\r\n            this.openLink();\r\n        }\r\n    };\r\n    /**\r\n     * Opens the link in the same manner the end user would.\r\n     *\r\n     * This essentially simulates a click on the result link.\r\n     *\r\n     * @param logAnalytics Specifies whether the method should log an analytics event.\r\n     */\r\n    ResultLink.prototype.openLinkAsConfigured = function (logAnalytics) {\r\n        if (logAnalytics === void 0) { logAnalytics = true; }\r\n        if (this.toExecuteOnOpen) {\r\n            if (logAnalytics) {\r\n                this.logOpenDocument();\r\n            }\r\n            this.toExecuteOnOpen();\r\n        }\r\n    };\r\n    ResultLink.prototype.bindEventToOpen = function () {\r\n        return (this.bindOnClickIfNotUndefined() ||\r\n            this.bindOpenQuickviewIfNotUndefined() ||\r\n            this.setHrefIfNotAlready() ||\r\n            this.openLinkThatIsNotAnAnchor());\r\n    };\r\n    ResultLink.prototype.getDisplayedTitle = function () {\r\n        if (!this.options.titleTemplate) {\r\n            return this.result.title\r\n                ? HighlightUtils_1.HighlightUtils.highlightString(this.result.title, this.result.titleHighlights, null, 'coveo-highlight')\r\n                : this.escapedClickUri;\r\n        }\r\n        else {\r\n            var newTitle = StringUtils_1.StringUtils.buildStringTemplateFromResult(this.options.titleTemplate, this.result);\r\n            return newTitle\r\n                ? StreamHighlightUtils_1.StreamHighlightUtils.highlightStreamText(newTitle, this.result.termsToHighlight, this.result.phrasesToHighlight)\r\n                : this.escapedClickUri;\r\n        }\r\n    };\r\n    ResultLink.prototype.getDisplayedTitleAsText = function () {\r\n        var container = Dom_1.$$('div');\r\n        container.setHtml(this.getDisplayedTitle());\r\n        return container.text();\r\n    };\r\n    Object.defineProperty(ResultLink.prototype, \"escapedClickUri\", {\r\n        get: function () {\r\n            return underscore_1.escape(this.result.clickUri);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ResultLink.prototype.bindOnClickIfNotUndefined = function () {\r\n        var _this = this;\r\n        if (this.options.onClick != undefined) {\r\n            this.toExecuteOnOpen = function (e) {\r\n                _this.options.onClick.call(_this, e, _this.result);\r\n            };\r\n            new AccessibleButton_1.AccessibleButton()\r\n                .withElement(this.element)\r\n                .withLabel(this.result.title)\r\n                .withSelectAction(function (e) { return _this.toExecuteOnOpen(e); })\r\n                .build();\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    };\r\n    ResultLink.prototype.bindOpenQuickviewIfNotUndefined = function () {\r\n        var _this = this;\r\n        if (this.quickviewShouldBeOpened()) {\r\n            this.toExecuteOnOpen = function () {\r\n                Dom_1.$$(_this.bindings.resultElement).trigger(ResultListEvents_1.ResultListEvents.openQuickview);\r\n            };\r\n            Dom_1.$$(this.element).on('click', function (e) {\r\n                e.preventDefault();\r\n                _this.toExecuteOnOpen();\r\n            });\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    };\r\n    ResultLink.prototype.openLinkThatIsNotAnAnchor = function () {\r\n        var _this = this;\r\n        if (!this.elementIsAnAnchor()) {\r\n            this.toExecuteOnOpen = function () {\r\n                if (_this.options.alwaysOpenInNewWindow) {\r\n                    if (_this.options.openInOutlook) {\r\n                        _this.openLinkInOutlook();\r\n                    }\r\n                    else {\r\n                        _this.openLinkInNewWindow();\r\n                    }\r\n                }\r\n                else {\r\n                    _this.openLink();\r\n                }\r\n            };\r\n            Dom_1.$$(this.element).on('click', function () {\r\n                _this.toExecuteOnOpen();\r\n            });\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ResultLink.prototype.setHrefIfNotAlready = function () {\r\n        // Do not erase any value put in href by the template, etc. Allows\r\n        // using custom click urls while still keeping analytics recording\r\n        // and other behavior brought by the component.\r\n        if (this.elementIsAnAnchor() && !Utils_1.Utils.isNonEmptyString(Dom_1.$$(this.element).getAttribute('href'))) {\r\n            Dom_1.$$(this.element).setAttribute('href', this.getResultUri());\r\n            if (this.options.alwaysOpenInNewWindow && !(this.options.openInOutlook && this.hasOutlookField())) {\r\n                Dom_1.$$(this.element).setAttribute('target', '_blank');\r\n            }\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    };\r\n    ResultLink.prototype.filterProtocol = function (uri) {\r\n        var isAbsolute = /^(https?|ftp|file|mailto|tel):/i.test(uri);\r\n        var isRelative = /^\\//.test(uri);\r\n        return isAbsolute || isRelative ? uri : '';\r\n    };\r\n    ResultLink.prototype.getResultUri = function () {\r\n        if (this.options.hrefTemplate) {\r\n            var uri = StringUtils_1.StringUtils.buildStringTemplateFromResult(this.options.hrefTemplate, this.result);\r\n            return this.filterProtocol(uri);\r\n        }\r\n        if (this.options.field == undefined && this.options.openInOutlook) {\r\n            this.setField();\r\n        }\r\n        if (this.options.field != undefined) {\r\n            return this.filterProtocol(Utils_1.Utils.getFieldValue(this.result, this.options.field));\r\n        }\r\n        return this.filterProtocol(this.result.clickUri);\r\n    };\r\n    ResultLink.prototype.elementIsAnAnchor = function () {\r\n        return this.element.tagName == 'A';\r\n    };\r\n    ResultLink.prototype.setField = function () {\r\n        var os = Utils_1.Utils.exists(this.os) ? this.os : OSUtils_1.OSUtils.get();\r\n        if (os == OSUtils_1.OS_NAME.MACOSX && this.hasOutlookField()) {\r\n            this.options.field = '@outlookformacuri';\r\n        }\r\n        else if (os == OSUtils_1.OS_NAME.WINDOWS && this.hasOutlookField()) {\r\n            this.options.field = '@outlookuri';\r\n        }\r\n    };\r\n    ResultLink.prototype.hasOutlookField = function () {\r\n        var os = Utils_1.Utils.exists(this.os) ? this.os : OSUtils_1.OSUtils.get();\r\n        if (os == OSUtils_1.OS_NAME.MACOSX && this.result.raw['outlookformacuri'] != undefined) {\r\n            return true;\r\n        }\r\n        else if (os == OSUtils_1.OS_NAME.WINDOWS && this.result.raw['outlookuri'] != undefined) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ResultLink.prototype.isUriThatMustBeOpenedInQuickview = function () {\r\n        return this.escapedClickUri.toLowerCase().indexOf('ldap://') == 0;\r\n    };\r\n    ResultLink.prototype.quickviewShouldBeOpened = function () {\r\n        return (this.options.openQuickview || this.isUriThatMustBeOpenedInQuickview()) && QueryUtils_1.QueryUtils.hasHTMLVersion(this.result);\r\n    };\r\n    ResultLink.ID = 'ResultLink';\r\n    ResultLink.doExport = function () {\r\n        GlobalExports_1.exportGlobally({\r\n            ResultLink: ResultLink\r\n        });\r\n    };\r\n    /**\r\n     * The options for the ResultLink\r\n     * @componentOptions\r\n     */\r\n    ResultLink.options = {\r\n        /**\r\n         * Specifies the field to use to output the component `href` attribute value.\r\n         *\r\n         * **Tip:**\r\n         * > Instead of specifying a value for the `field` option, you can directly add an `href` attribute to the\r\n         * > `ResultLink` HTML element. Then, you can use a custom script to generate the `href` value.\r\n         *\r\n         * **Examples:**\r\n         * - With the following markup, the `ResultLink` outputs its `href` value using the `@uri` field (rather than the\r\n         * default field):\r\n         *\r\n         * ```html\r\n         * <a class=\"CoveoResultLink\" data-field=\"@uri\"></a>\r\n         * ```\r\n         *\r\n         * - In the following result template, the custom `getMyKBUri()` function provides the `href` value:\r\n         *\r\n         * ```html\r\n         * <script id=\"KnowledgeArticle\" type=\"text/underscore\" class=\"result-template\">\r\n         *   <div class='CoveoIcon>'></div>\r\n         *   <a class=\"CoveoResultLink\" href=\"<%= getMyKBUri(raw) %>\"></a>\r\n         *   <div class=\"CoveoExcerpt\"></div>\r\n         * </script>\r\n         * ```\r\n         *\r\n         * See also [`hrefTemplate`]{@link ResultLink.options.hrefTemplate}, which can override this option.\r\n         *\r\n         * By default, the component uses the `@clickUri` field of the item to output the value of its `href` attribute.\r\n         */\r\n        field: ComponentOptions_1.ComponentOptions.buildFieldOption(),\r\n        /**\r\n         * Specifies whether the component should try to open its link in Microsoft Outlook.\r\n         *\r\n         * Setting this option to `true` is normally useful for `ResultLink` instances related to Microsoft Exchange emails.\r\n         *\r\n         * If this option is `true`, clicking the `ResultLink` calls the\r\n         * [`openLinkInOutlook`]{@link ResultLink.openLinkInOutlook} method instead of the\r\n         * [`openLink`]{@link ResultLink.openLink} method.\r\n         *\r\n         * Default value is `false`.\r\n         */\r\n        openInOutlook: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n        /**\r\n         * Specifies whether the component should open its link in the [`Quickview`]{@link Quickview} component rather than\r\n         * loading through the original URL.\r\n         *\r\n         * Default value is `false`.\r\n         */\r\n        openQuickview: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n        /**\r\n         * Specifies whether the component should open its link in a new window instead of opening it in the current\r\n         * context.\r\n         *\r\n         * If this option is `true`, clicking the `ResultLink` calls the\r\n         * [`openLinkInNewWindow`]{@link ResultLink.openLinkInNewWindow} method instead of the\r\n         * [`openLink`]{@link ResultLink.openLink} method.\r\n         *\r\n         * **Note:**\r\n         * > If a search page contains a [`ResultPreferences`]{@link ResultsPreferences} component whose\r\n         * > [`enableOpenInNewWindow`]{@link ResultsPreferences.options.enableOpenInNewWindow} option is `true`, and the end\r\n         * > user checks the <b>Always open results in new window</b> box, `ResultLink` components in this page will always\r\n         * > open their links in a new window when the end user clicks them, no matter what the value of their\r\n         * > `alwaysOpenInNewWindow` option is.\r\n         *\r\n         * Default value is `false`.\r\n         */\r\n        alwaysOpenInNewWindow: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n        /**\r\n         * Specifies a template literal from which to generate the `ResultLink` `href` attribute value (see\r\n         * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\r\n         *\r\n         * This option overrides the [`field`]{@link ResultLink.options.field} option value.\r\n         *\r\n         * The template literal can reference any number of fields from the parent result. It can also reference global\r\n         * scope properties.\r\n         *\r\n         * **Examples:**\r\n         *\r\n         * - The following markup generates an `href` value such as `http://uri.com?id=itemTitle`:\r\n         *\r\n         * ```html\r\n         * <a class='CoveoResultLink' data-href-template='${clickUri}?id=${raw.title}'></a>\r\n         * ```\r\n         *\r\n         * - The following markup generates an `href` value such as `localhost/fooBar`:\r\n         *\r\n         * ```html\r\n         * <a class='CoveoResultLink' data-href-template='${window.location.hostname}/{Foo.Bar}'></a>\r\n         * ```\r\n         *\r\n         * Default value is `undefined`.\r\n         */\r\n        hrefTemplate: ComponentOptions_1.ComponentOptions.buildStringOption(),\r\n        /**\r\n         * Specifies a template literal from which to generate the `ResultLink` display title (see\r\n         * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\r\n         *\r\n         * This option overrides the default `ResultLink` display title behavior.\r\n         *\r\n         * The template literal can reference any number of fields from the parent result. However, if the template literal\r\n         * references a key whose value is undefined in the parent result fields, the `ResultLink` title displays the\r\n         * name of this key instead.\r\n         *\r\n         * This option is ignored if the `ResultLink` innerHTML contains any value.\r\n         *\r\n         * **Examples:**\r\n         *\r\n         * - The following markup generates a `ResultLink` display title such as `Case number: 123456` if both the\r\n         * `raw.objecttype` and `raw.objectnumber` keys are defined in the parent result fields:\r\n         *\r\n         * ```html\r\n         * <a class=\"CoveoResultLink\" data-title-template=\"${raw.objecttype} number: ${raw.objectnumber}\"></a>\r\n         * ```\r\n         *\r\n         * - The following markup generates `${myField}` as a `ResultLink` display title if the `myField` key is undefined\r\n         * in the parent result fields:\r\n         *\r\n         * ```html\r\n         * <a class=\"CoveoResultLink\" data-title-template=\"${myField}\"></a>\r\n         * ```\r\n         *\r\n         * - The following markup generates `Foobar` as a `ResultLink` display title, because the `ResultLink` innterHTML is\r\n         * not empty:\r\n         *\r\n         * ```html\r\n         * <a class=\"CoveoResultLink\" data-title-template=\"${will} ${be} ${ignored}\">Foobar</a>\r\n         * ```\r\n         *\r\n         * Default value is `undefined`.\r\n         *\r\n         * @availablesince [January 2017 Release (v1.1865.9)](https://docs.coveo.com/en/396/#january-2017-release-v118659)\r\n         */\r\n        titleTemplate: ComponentOptions_1.ComponentOptions.buildStringOption(),\r\n        /**\r\n         * Specifies an event handler function to execute when the user clicks the `ResultLink` component.\r\n         *\r\n         * The handler function takes a JavaScript [`Event`](https://developer.mozilla.org/en/docs/Web/API/Event) object and\r\n         * an [`IQueryResult`]{@link IQueryResult} as its parameters.\r\n         *\r\n         * Overriding the default behavior of the `onClick` event can allow you to execute specific code instead.\r\n         *\r\n         * **Note:**\r\n         * > You cannot set this option directly in the component markup as an HTML attribute. You must either set it in the\r\n         * > [`init`]{@link init} call of your search interface (see\r\n         * > [Passing Component Options in the init Call](https://docs.coveo.com/en/346/#passing-component-options-in-the-init-call)),\r\n         * > or before the `init` call, using the `options` top-level function (see\r\n         * > [Passing Component Options Before the init Call](https://docs.coveo.com/en/346/#passing-component-options-before-the-init-call)).\r\n         *\r\n         * **Example:**\r\n         * ```javascript\r\n         * // You can set the option in the 'init' call:\r\n         * Coveo.init(document.querySelector(\"#search\"), {\r\n         *   ResultLink : {\r\n         *     onClick : function(e, result) {\r\n         *       e.preventDefault();\r\n         *       // Custom code to execute with the item URI and title.\r\n         *       openUriInASpecialTab(result.clickUri, result.title);\r\n         *     }\r\n         *   }\r\n         * });\r\n         *\r\n         * // Or before the 'init' call, using the 'options' top-level function:\r\n         * // Coveo.options(document.querySelector('#search'), {\r\n         * //   ResultLink : {\r\n         * //     onClick : function(e, result) {\r\n         * //       e.preventDefault();\r\n         * //       // Custom code to execute with the item URI and title.\r\n         * //       openUriInASpecialTab(result.clickUri, result.title);\r\n         * //     }\r\n         * //   }\r\n         * // });\r\n         * ```\r\n         */\r\n        onClick: ComponentOptions_1.ComponentOptions.buildCustomOption(function () {\r\n            return null;\r\n        })\r\n    };\r\n    return ResultLink;\r\n}(Component_1.Component));\r\nexports.ResultLink = ResultLink;\r\nInitialization_1.Initialization.registerAutoCreateComponent(ResultLink);\r\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// YouTubeThumbnail.min__5f3280c404a1ee75a113.js","import { ModalBox as ModalBoxModule } from '../../ExternalModulesShim';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\nimport { $$, Dom } from '../../utils/Dom';\r\nimport { SVGDom } from '../../utils/SVGDom';\r\nimport { SVGIcons } from '../../utils/SVGIcons';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { Component } from '../Base/Component';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { Initialization } from '../Base/Initialization';\r\nimport { get } from '../Base/RegisteredNamedMethods';\r\nimport { IResultsComponentBindings } from '../Base/ResultsComponentBindings';\r\nimport { ResultLink } from '../ResultLink/ResultLink';\r\nimport { AccessibleModal } from '../../utils/AccessibleModal';\r\n\r\nexport interface IYouTubeThumbnailOptions {\r\n  width: string;\r\n  height: string;\r\n  embed: boolean;\r\n}\r\n\r\n/**\r\n * The YouTubeThumbnail component automatically fetches the thumbnail of a YouTube video.\r\n *\r\n * This component differs from the standard {@link Thumbnail} component because the thumbnail it outputs is always\r\n * clickable.\r\n *\r\n * Depending on the component configuration, clicking a YouTube thumbnail can either automatically open a modal box\r\n * containing the `iframe` from YouTube, or open the target URL in the current window (see\r\n * {@link YouTubeThumbnail.options.embed}).\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n */\r\nexport class YouTubeThumbnail extends Component {\r\n  static ID = 'YouTubeThumbnail';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      YouTubeThumbnail: YouTubeThumbnail\r\n    });\r\n  };\r\n\r\n  /**\r\n   * @componentOptions\r\n   */\r\n  static options: IYouTubeThumbnailOptions = {\r\n    /**\r\n     * Specifies the width (in pixels) of the YouTube thumbnail.\r\n     *\r\n     * Default value is `200px`.\r\n     */\r\n    width: ComponentOptions.buildStringOption({ defaultValue: '200px' }),\r\n\r\n    /**\r\n     * Specifies the height (in pixels) of the YouTube thumbnail.\r\n     *\r\n     * Default value is `112px`.\r\n     */\r\n    height: ComponentOptions.buildStringOption({ defaultValue: '112px' }),\r\n\r\n    /**\r\n     * Specifies whether clicking on the YouTube thumbnail loads the video in a modal box.\r\n     *\r\n     * Setting this option to `false` causes the browser to change its current location to that of the target URL when\r\n     * the end user clicks the YouTube thumbnail.\r\n     *\r\n     * Default value is `true`.\r\n     */\r\n    embed: ComponentOptions.buildBooleanOption({ defaultValue: true })\r\n  };\r\n\r\n  public resultLink: Dom;\r\n\r\n  private modalbox: AccessibleModal;\r\n\r\n  constructor(\r\n    public element: HTMLElement,\r\n    public options?: IYouTubeThumbnailOptions,\r\n    public bindings?: IResultsComponentBindings,\r\n    public result?: IQueryResult,\r\n    ModalBox = ModalBoxModule,\r\n    private origin?: HTMLElement\r\n  ) {\r\n    super(element, YouTubeThumbnail.ID, bindings);\r\n    this.options = ComponentOptions.initComponentOptions(element, YouTubeThumbnail, options);\r\n\r\n    this.resultLink = $$('a', {\r\n      className: Component.computeCssClassName(ResultLink)\r\n    });\r\n\r\n    if (!origin) {\r\n      this.origin = this.resultLink.el;\r\n    }\r\n\r\n    const thumbnailDiv = $$('div', {\r\n      className: 'coveo-youtube-thumbnail-container'\r\n    });\r\n\r\n    this.resultLink.append(thumbnailDiv.el);\r\n\r\n    const img = $$('img', {\r\n      src: Utils.getFieldValue(this.result, 'ytthumbnailurl'),\r\n      className: 'coveo-youtube-thumbnail-img',\r\n      alt: this.result.title,\r\n      title: this.result.title\r\n    });\r\n\r\n    img.el.style.width = this.options.width;\r\n    img.el.style.height = this.options.height;\r\n    img.el.onerror = () => {\r\n      const svgVideo = $$('div', {}, SVGIcons.icons.video).el;\r\n      SVGDom.addStyleToSVGInContainer(svgVideo, {\r\n        width: this.options.width\r\n      });\r\n      $$(img).remove();\r\n      thumbnailDiv.append(svgVideo);\r\n    };\r\n    thumbnailDiv.append(img.el);\r\n\r\n    const span = $$('span', {\r\n      className: 'coveo-youtube-thumbnail-play-button'\r\n    });\r\n\r\n    thumbnailDiv.append(span.el);\r\n\r\n    $$(this.element).append(this.resultLink.el);\r\n\r\n    Initialization.automaticallyCreateComponentsInsideResult(element, result, {\r\n      ResultLink: this.options.embed ? { onClick: () => this.openYoutubeIframe() } : null\r\n    });\r\n    this.modalbox = new AccessibleModal('coveo-youtube-player', this.searchInterface.options.modalContainer, ModalBox, {\r\n      overlayClose: true\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Open the result link embedded in this component.\r\n   *\r\n   * With a standard configuration of this component, this will open an iframe that automatically plays the video.\r\n   */\r\n  public openResultLink() {\r\n    let resultLinkComponent = <ResultLink>get(this.resultLink.el);\r\n    resultLinkComponent.openLinkAsConfigured();\r\n  }\r\n\r\n  private openYoutubeIframe() {\r\n    // need to put iframe inside div : iframe with position absolute and left:0, right : 0 , bottom: 0 is not standard/supported\r\n    const iframe = $$('iframe', {\r\n      src: `https://www.youtube.com/embed/${this.extractVideoId()}?autoplay=1`,\r\n      allowfullscreen: 'allowfullscreen',\r\n      width: '100%',\r\n      height: '100%',\r\n      title: this.result.title\r\n    });\r\n\r\n    const div = $$('div');\r\n\r\n    div.append(iframe.el);\r\n\r\n    this.modalbox.openResult({\r\n      result: this.result,\r\n      options: { showDate: true, title: this.result.title },\r\n      bindings: this.bindings,\r\n      content: div.el,\r\n      validation: () => true,\r\n      origin: this.origin\r\n    });\r\n\r\n    $$($$(this.modalbox.wrapper).find('.coveo-quickview-close-button')).on('click', () => {\r\n      this.modalbox.close();\r\n    });\r\n  }\r\n\r\n  private extractVideoId() {\r\n    return this.result.clickUri.split('watch?v=')[1];\r\n  }\r\n}\r\nInitialization.registerAutoCreateComponent(YouTubeThumbnail);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/YouTube/YouTubeThumbnail.ts","import { ModalBox as ModalBoxModule } from '../ExternalModulesShim';\r\nimport { FocusTrap } from '../ui/FocusTrap/FocusTrap';\r\nimport { l } from '../strings/Strings';\r\nimport { $$ } from './Dom';\r\nimport { KeyboardUtils, KEYBOARD } from './KeyboardUtils';\r\nimport { IQuickViewHeaderOptions } from './DomUtils';\r\nimport { IQueryResult } from '../rest/QueryResult';\r\nimport { IComponentBindings } from '../ui/Base/ComponentBindings';\r\nimport { DomUtils } from '../Core';\r\n\r\nexport interface IAccessibleModalOptions {\r\n  overlayClose?: boolean;\r\n  sizeMod: 'small' | 'normal' | 'big';\r\n}\r\n\r\nexport interface IAccessibleModalOpenParameters {\r\n  content: HTMLElement;\r\n  validation: () => boolean;\r\n  origin: HTMLElement;\r\n}\r\n\r\nexport interface IAccessibleModalOpenResultParameters extends IAccessibleModalOpenParameters {\r\n  result: IQueryResult;\r\n  options: IQuickViewHeaderOptions;\r\n  bindings: IComponentBindings;\r\n}\r\n\r\nexport interface IAccessibleModalOpenNormalParameters extends IAccessibleModalOpenParameters {\r\n  title: HTMLElement;\r\n}\r\n\r\nexport class AccessibleModal {\r\n  private focusTrap: FocusTrap;\r\n  private activeModal: Coveo.ModalBox.ModalBox;\r\n  private options: IAccessibleModalOptions;\r\n  private initiallyFocusedElement: HTMLElement;\r\n\r\n  public get isOpen() {\r\n    return !!this.focusTrap;\r\n  }\r\n\r\n  public get element() {\r\n    return this.activeModal && this.activeModal.modalBox;\r\n  }\r\n\r\n  public get content() {\r\n    return this.activeModal && this.activeModal.content;\r\n  }\r\n\r\n  public get wrapper() {\r\n    return this.activeModal && this.activeModal.wrapper;\r\n  }\r\n\r\n  private get headerElement() {\r\n    return this.element && this.element.querySelector<HTMLElement>('.coveo-modal-header h1');\r\n  }\r\n\r\n  constructor(\r\n    private className: string,\r\n    private ownerElement: HTMLElement,\r\n    private modalboxModule: Coveo.ModalBox.ModalBox = ModalBoxModule,\r\n    options: Partial<IAccessibleModalOptions> = {}\r\n  ) {\r\n    this.options = {\r\n      ...{\r\n        sizeMod: 'big'\r\n      },\r\n      ...options\r\n    };\r\n  }\r\n\r\n  public openResult(parameters: IAccessibleModalOpenResultParameters) {\r\n    if (this.isOpen) {\r\n      return;\r\n    }\r\n    this.openModalAndTrap({\r\n      content: parameters.content,\r\n      validation: parameters.validation,\r\n      origin: parameters.origin,\r\n      title: DomUtils.getQuickviewHeader(parameters.result, parameters.options, parameters.bindings).el\r\n    });\r\n    this.makeAccessible(parameters.options.title || parameters.result.title);\r\n  }\r\n\r\n  public open(parameters: IAccessibleModalOpenNormalParameters) {\r\n    if (this.isOpen) {\r\n      return;\r\n    }\r\n    this.openModalAndTrap(parameters);\r\n    this.makeAccessible();\r\n  }\r\n\r\n  private openModalAndTrap(parameters: IAccessibleModalOpenNormalParameters) {\r\n    this.initiallyFocusedElement = parameters.origin || (document.activeElement as HTMLElement);\r\n    this.activeModal = this.modalboxModule.open(parameters.content, {\r\n      title: parameters.title,\r\n      className: this.className,\r\n      validation: () => {\r\n        this.onModalClose();\r\n        return parameters.validation();\r\n      },\r\n      body: this.ownerElement,\r\n      sizeMod: this.options.sizeMod,\r\n      overlayClose: this.options.overlayClose\r\n    });\r\n    this.focusTrap = new FocusTrap(this.element);\r\n  }\r\n\r\n  public close() {\r\n    if (!this.isOpen) {\r\n      return;\r\n    }\r\n    this.activeModal.close();\r\n    this.activeModal = null;\r\n  }\r\n\r\n  private makeAccessible(title?: string) {\r\n    this.element.setAttribute('aria-modal', 'true');\r\n    if (title) {\r\n      this.headerElement.setAttribute('aria-label', title);\r\n    }\r\n    this.makeCloseButtonAccessible();\r\n  }\r\n\r\n  private makeCloseButtonAccessible() {\r\n    const closeButton: HTMLElement = this.element.querySelector('.coveo-small-close');\r\n    closeButton.setAttribute('aria-label', l('Close'));\r\n    closeButton.setAttribute('role', 'button');\r\n    closeButton.tabIndex = 0;\r\n    closeButton.focus();\r\n    $$(closeButton).on('keyup', KeyboardUtils.keypressAction(KEYBOARD.ENTER, () => closeButton.click()));\r\n  }\r\n\r\n  private onModalClose() {\r\n    this.focusTrap.disable();\r\n    this.focusTrap = null;\r\n    if (this.initiallyFocusedElement && document.body.contains(this.initiallyFocusedElement)) {\r\n      this.initiallyFocusedElement.focus();\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/AccessibleModal.ts","import { Defer } from '../../misc/Defer';\r\nimport { sortBy, without } from 'underscore';\r\nimport { $$ } from '../../utils/Dom';\r\n\r\nexport class FocusTrap {\r\n  private focusInEvent: (e: FocusEvent) => void;\r\n  private focusOutEvent: (e: FocusEvent) => void;\r\n  private hiddenElements: HTMLElement[];\r\n  private enabled: boolean;\r\n\r\n  private get focusableElements(): HTMLElement[] {\r\n    return sortBy(this.container.querySelectorAll('[tabindex]'), element => element.tabIndex);\r\n  }\r\n\r\n  constructor(private container: HTMLElement) {\r\n    this.hiddenElements = [];\r\n    this.enable();\r\n  }\r\n\r\n  public disable() {\r\n    document.removeEventListener('focusin', this.focusInEvent);\r\n    document.removeEventListener('focusout', this.focusOutEvent);\r\n    this.showHiddenElements();\r\n    this.enabled = false;\r\n  }\r\n\r\n  private enable() {\r\n    document.addEventListener('focusin', (this.focusInEvent = e => this.onFocusIn(e)));\r\n    document.addEventListener('focusout', (this.focusOutEvent = e => this.onFocusOut(e)));\r\n    this.hideAllExcept(this.container);\r\n    this.enabled = true;\r\n  }\r\n\r\n  private showHiddenElements() {\r\n    while (this.hiddenElements.length) {\r\n      this.hiddenElements.pop().removeAttribute('aria-hidden');\r\n    }\r\n  }\r\n\r\n  private hideElement(element: HTMLElement) {\r\n    if (element.getAttribute('aria-hidden')) {\r\n      return;\r\n    }\r\n    this.hiddenElements.push(element);\r\n    element.setAttribute('aria-hidden', `${true}`);\r\n  }\r\n\r\n  private hideSiblings(allowedElement: HTMLElement) {\r\n    const parent = allowedElement.parentElement;\r\n    if (parent) {\r\n      without($$(parent).children(), allowedElement).forEach(elementToHide => {\r\n        this.hideElement(elementToHide);\r\n      });\r\n    }\r\n  }\r\n\r\n  private hideAllExcept(allowedElement: HTMLElement) {\r\n    this.hideSiblings(allowedElement);\r\n    const parent = allowedElement.parentElement;\r\n    if (parent && parent !== document.body) {\r\n      this.hideAllExcept(parent);\r\n    }\r\n  }\r\n\r\n  private getFocusableSibling(element: HTMLElement, previous = false) {\r\n    const elements = this.focusableElements;\r\n    const currentIndex = elements.indexOf(element);\r\n    if (currentIndex === -1) {\r\n      return null;\r\n    }\r\n    return elements[(currentIndex + (previous ? -1 : 1) + elements.length) % elements.length];\r\n  }\r\n\r\n  private focusSibling(element: HTMLElement, previous = false) {\r\n    const sibling = this.getFocusableSibling(element, previous);\r\n    if (sibling) {\r\n      sibling.focus();\r\n    }\r\n  }\r\n\r\n  private focusFirstElement() {\r\n    const elements = this.focusableElements;\r\n    if (elements.length) {\r\n      elements[0].focus();\r\n    }\r\n  }\r\n\r\n  private elementIsBefore(oldElement: HTMLElement, newElement: HTMLElement) {\r\n    if (!newElement) {\r\n      return false;\r\n    }\r\n    return oldElement.compareDocumentPosition(newElement) === Node.DOCUMENT_POSITION_PRECEDING;\r\n  }\r\n\r\n  private onLosingFocus(oldElement: HTMLElement, newElement: HTMLElement) {\r\n    Defer.defer(() => {\r\n      if (!this.enabled) {\r\n        return;\r\n      }\r\n      this.enabled = false;\r\n      if (oldElement && this.focusIsAllowed(oldElement)) {\r\n        this.focusSibling(oldElement, this.elementIsBefore(oldElement, newElement));\r\n      } else {\r\n        this.focusFirstElement();\r\n      }\r\n      this.enabled = true;\r\n    });\r\n  }\r\n\r\n  private focusIsAllowed(element: HTMLElement) {\r\n    return this.container.contains(element);\r\n  }\r\n\r\n  private elementIsInPage(element: HTMLElement) {\r\n    return element && element !== document.body.parentElement;\r\n  }\r\n\r\n  private onFocusIn(e: FocusEvent) {\r\n    if (!this.enabled) {\r\n      return;\r\n    }\r\n    const oldElement = e.relatedTarget as HTMLElement;\r\n    const handledByFocusOut = this.elementIsInPage(oldElement);\r\n    if (handledByFocusOut) {\r\n      return;\r\n    }\r\n    const newElement = e.target as HTMLElement;\r\n    if (!this.elementIsInPage(newElement)) {\r\n      return;\r\n    }\r\n    if (!this.focusIsAllowed(newElement)) {\r\n      this.onLosingFocus(null, newElement);\r\n    }\r\n  }\r\n\r\n  private onFocusOut(e: FocusEvent) {\r\n    if (!this.enabled) {\r\n      return;\r\n    }\r\n    const newElement = e.relatedTarget as HTMLElement;\r\n    if (!this.elementIsInPage(newElement)) {\r\n      return;\r\n    }\r\n    if (!newElement || !this.focusIsAllowed(newElement)) {\r\n      this.onLosingFocus(e.target as HTMLElement, newElement);\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/FocusTrap/FocusTrap.ts","import { Component } from '../Base/Component';\r\nimport { ComponentOptions } from '../Base/ComponentOptions';\r\nimport { ComponentOptionsModel } from '../../models/ComponentOptionsModel';\r\nimport { IResultsComponentBindings } from '../Base/ResultsComponentBindings';\r\nimport { analyticsActionCauseList } from '../Analytics/AnalyticsActionListMeta';\r\nimport { IResultLinkOptions } from './ResultLinkOptions';\r\nimport { ResultListEvents } from '../../events/ResultListEvents';\r\nimport { HighlightUtils } from '../../utils/HighlightUtils';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\nimport { DeviceUtils } from '../../utils/DeviceUtils';\r\nimport { OS_NAME, OSUtils } from '../../utils/OSUtils';\r\nimport { Initialization } from '../Base/Initialization';\r\nimport { QueryUtils } from '../../utils/QueryUtils';\r\nimport { Assert } from '../../misc/Assert';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { Defer } from '../../misc/Defer';\r\nimport { $$ } from '../../utils/Dom';\r\nimport { StreamHighlightUtils } from '../../utils/StreamHighlightUtils';\r\nimport { StringUtils } from '../../utils/StringUtils';\r\nimport { once, debounce, extend, escape } from 'underscore';\r\nimport { exportGlobally } from '../../GlobalExports';\r\n\r\nimport 'styling/_ResultLink';\r\nimport { AccessibleButton } from '../../utils/AccessibleButton';\r\n\r\n/**\r\n * The `ResultLink` component automatically transform a search result title into a clickable link pointing to the\r\n * original item.\r\n *\r\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\r\n */\r\nexport class ResultLink extends Component {\r\n  static ID = 'ResultLink';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      ResultLink: ResultLink\r\n    });\r\n  };\r\n\r\n  /**\r\n   * The options for the ResultLink\r\n   * @componentOptions\r\n   */\r\n  static options: IResultLinkOptions = {\r\n    /**\r\n     * Specifies the field to use to output the component `href` attribute value.\r\n     *\r\n     * **Tip:**\r\n     * > Instead of specifying a value for the `field` option, you can directly add an `href` attribute to the\r\n     * > `ResultLink` HTML element. Then, you can use a custom script to generate the `href` value.\r\n     *\r\n     * **Examples:**\r\n     * - With the following markup, the `ResultLink` outputs its `href` value using the `@uri` field (rather than the\r\n     * default field):\r\n     *\r\n     * ```html\r\n     * <a class=\"CoveoResultLink\" data-field=\"@uri\"></a>\r\n     * ```\r\n     *\r\n     * - In the following result template, the custom `getMyKBUri()` function provides the `href` value:\r\n     *\r\n     * ```html\r\n     * <script id=\"KnowledgeArticle\" type=\"text/underscore\" class=\"result-template\">\r\n     *   <div class='CoveoIcon>'></div>\r\n     *   <a class=\"CoveoResultLink\" href=\"<%= getMyKBUri(raw) %>\"></a>\r\n     *   <div class=\"CoveoExcerpt\"></div>\r\n     * </script>\r\n     * ```\r\n     *\r\n     * See also [`hrefTemplate`]{@link ResultLink.options.hrefTemplate}, which can override this option.\r\n     *\r\n     * By default, the component uses the `@clickUri` field of the item to output the value of its `href` attribute.\r\n     */\r\n    field: ComponentOptions.buildFieldOption(),\r\n\r\n    /**\r\n     * Specifies whether the component should try to open its link in Microsoft Outlook.\r\n     *\r\n     * Setting this option to `true` is normally useful for `ResultLink` instances related to Microsoft Exchange emails.\r\n     *\r\n     * If this option is `true`, clicking the `ResultLink` calls the\r\n     * [`openLinkInOutlook`]{@link ResultLink.openLinkInOutlook} method instead of the\r\n     * [`openLink`]{@link ResultLink.openLink} method.\r\n     *\r\n     * Default value is `false`.\r\n     */\r\n    openInOutlook: ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n\r\n    /**\r\n     * Specifies whether the component should open its link in the [`Quickview`]{@link Quickview} component rather than\r\n     * loading through the original URL.\r\n     *\r\n     * Default value is `false`.\r\n     */\r\n    openQuickview: ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n\r\n    /**\r\n     * Specifies whether the component should open its link in a new window instead of opening it in the current\r\n     * context.\r\n     *\r\n     * If this option is `true`, clicking the `ResultLink` calls the\r\n     * [`openLinkInNewWindow`]{@link ResultLink.openLinkInNewWindow} method instead of the\r\n     * [`openLink`]{@link ResultLink.openLink} method.\r\n     *\r\n     * **Note:**\r\n     * > If a search page contains a [`ResultPreferences`]{@link ResultsPreferences} component whose\r\n     * > [`enableOpenInNewWindow`]{@link ResultsPreferences.options.enableOpenInNewWindow} option is `true`, and the end\r\n     * > user checks the <b>Always open results in new window</b> box, `ResultLink` components in this page will always\r\n     * > open their links in a new window when the end user clicks them, no matter what the value of their\r\n     * > `alwaysOpenInNewWindow` option is.\r\n     *\r\n     * Default value is `false`.\r\n     */\r\n    alwaysOpenInNewWindow: ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n\r\n    /**\r\n     * Specifies a template literal from which to generate the `ResultLink` `href` attribute value (see\r\n     * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\r\n     *\r\n     * This option overrides the [`field`]{@link ResultLink.options.field} option value.\r\n     *\r\n     * The template literal can reference any number of fields from the parent result. It can also reference global\r\n     * scope properties.\r\n     *\r\n     * **Examples:**\r\n     *\r\n     * - The following markup generates an `href` value such as `http://uri.com?id=itemTitle`:\r\n     *\r\n     * ```html\r\n     * <a class='CoveoResultLink' data-href-template='${clickUri}?id=${raw.title}'></a>\r\n     * ```\r\n     *\r\n     * - The following markup generates an `href` value such as `localhost/fooBar`:\r\n     *\r\n     * ```html\r\n     * <a class='CoveoResultLink' data-href-template='${window.location.hostname}/{Foo.Bar}'></a>\r\n     * ```\r\n     *\r\n     * Default value is `undefined`.\r\n     */\r\n    hrefTemplate: ComponentOptions.buildStringOption(),\r\n\r\n    /**\r\n     * Specifies a template literal from which to generate the `ResultLink` display title (see\r\n     * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\r\n     *\r\n     * This option overrides the default `ResultLink` display title behavior.\r\n     *\r\n     * The template literal can reference any number of fields from the parent result. However, if the template literal\r\n     * references a key whose value is undefined in the parent result fields, the `ResultLink` title displays the\r\n     * name of this key instead.\r\n     *\r\n     * This option is ignored if the `ResultLink` innerHTML contains any value.\r\n     *\r\n     * **Examples:**\r\n     *\r\n     * - The following markup generates a `ResultLink` display title such as `Case number: 123456` if both the\r\n     * `raw.objecttype` and `raw.objectnumber` keys are defined in the parent result fields:\r\n     *\r\n     * ```html\r\n     * <a class=\"CoveoResultLink\" data-title-template=\"${raw.objecttype} number: ${raw.objectnumber}\"></a>\r\n     * ```\r\n     *\r\n     * - The following markup generates `${myField}` as a `ResultLink` display title if the `myField` key is undefined\r\n     * in the parent result fields:\r\n     *\r\n     * ```html\r\n     * <a class=\"CoveoResultLink\" data-title-template=\"${myField}\"></a>\r\n     * ```\r\n     *\r\n     * - The following markup generates `Foobar` as a `ResultLink` display title, because the `ResultLink` innterHTML is\r\n     * not empty:\r\n     *\r\n     * ```html\r\n     * <a class=\"CoveoResultLink\" data-title-template=\"${will} ${be} ${ignored}\">Foobar</a>\r\n     * ```\r\n     *\r\n     * Default value is `undefined`.\r\n     *\r\n     * @availablesince [January 2017 Release (v1.1865.9)](https://docs.coveo.com/en/396/#january-2017-release-v118659)\r\n     */\r\n    titleTemplate: ComponentOptions.buildStringOption(),\r\n\r\n    /**\r\n     * Specifies an event handler function to execute when the user clicks the `ResultLink` component.\r\n     *\r\n     * The handler function takes a JavaScript [`Event`](https://developer.mozilla.org/en/docs/Web/API/Event) object and\r\n     * an [`IQueryResult`]{@link IQueryResult} as its parameters.\r\n     *\r\n     * Overriding the default behavior of the `onClick` event can allow you to execute specific code instead.\r\n     *\r\n     * **Note:**\r\n     * > You cannot set this option directly in the component markup as an HTML attribute. You must either set it in the\r\n     * > [`init`]{@link init} call of your search interface (see\r\n     * > [Passing Component Options in the init Call](https://docs.coveo.com/en/346/#passing-component-options-in-the-init-call)),\r\n     * > or before the `init` call, using the `options` top-level function (see\r\n     * > [Passing Component Options Before the init Call](https://docs.coveo.com/en/346/#passing-component-options-before-the-init-call)).\r\n     *\r\n     * **Example:**\r\n     * ```javascript\r\n     * // You can set the option in the 'init' call:\r\n     * Coveo.init(document.querySelector(\"#search\"), {\r\n     *   ResultLink : {\r\n     *     onClick : function(e, result) {\r\n     *       e.preventDefault();\r\n     *       // Custom code to execute with the item URI and title.\r\n     *       openUriInASpecialTab(result.clickUri, result.title);\r\n     *     }\r\n     *   }\r\n     * });\r\n     *\r\n     * // Or before the 'init' call, using the 'options' top-level function:\r\n     * // Coveo.options(document.querySelector('#search'), {\r\n     * //   ResultLink : {\r\n     * //     onClick : function(e, result) {\r\n     * //       e.preventDefault();\r\n     * //       // Custom code to execute with the item URI and title.\r\n     * //       openUriInASpecialTab(result.clickUri, result.title);\r\n     * //     }\r\n     * //   }\r\n     * // });\r\n     * ```\r\n     */\r\n    onClick: ComponentOptions.buildCustomOption<(e: Event, result: IQueryResult) => any>(() => {\r\n      return null;\r\n    })\r\n  };\r\n\r\n  private toExecuteOnOpen: (e?: Event) => void;\r\n\r\n  /**\r\n   * Creates a new `ResultLink` component.\r\n   * @param element The HTMLElement on which to instantiate the component.\r\n   * @param options The options for the `ResultLink` component.\r\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n   * automatically resolved (with a slower execution time).\r\n   * @param result The result to associate the component with.\r\n   * @param os\r\n   */\r\n  constructor(\r\n    public element: HTMLElement,\r\n    public options: IResultLinkOptions,\r\n    public bindings?: IResultsComponentBindings,\r\n    public result?: IQueryResult,\r\n    public os?: OS_NAME\r\n  ) {\r\n    super(element, ResultLink.ID, bindings);\r\n\r\n    const initialOptions = ComponentOptions.initComponentOptions(element, ResultLink, options);\r\n    const resultLinkOptions = this.componentOptionsModel.get(ComponentOptionsModel.attributesEnum.resultLink);\r\n    this.options = extend({}, initialOptions, resultLinkOptions);\r\n\r\n    this.result = result || this.resolveResult();\r\n\r\n    if (this.options.openQuickview == null) {\r\n      this.options.openQuickview = result.raw['connectortype'] == 'ExchangeCrawler' && DeviceUtils.isMobileDevice();\r\n    }\r\n    this.element.setAttribute('tabindex', '0');\r\n\r\n    Assert.exists(this.componentOptionsModel);\r\n    Assert.exists(this.result);\r\n\r\n    if (!this.quickviewShouldBeOpened()) {\r\n      // Bind on multiple \"click\" or \"mouse\" events.\r\n      // Create a function that will be executed only once, so as not to log multiple events\r\n      // Once a result link has been opened, and that we log at least one analytics event,\r\n      // it should not matter if the end user open the same link multiple times with different methods.\r\n      // It's still only one \"click\" event as far as UA is concerned.\r\n      // Also need to handle \"longpress\" on mobile (the contextual menu), which we assume to be 1 s long.\r\n\r\n      const executeOnlyOnce = once(() => this.logOpenDocument());\r\n\r\n      $$(element).on(['contextmenu', 'click', 'mousedown', 'mouseup'], executeOnlyOnce);\r\n      let longPressTimer: number;\r\n      $$(element).on('touchstart', () => {\r\n        longPressTimer = window.setTimeout(executeOnlyOnce, 1000);\r\n      });\r\n      $$(element).on('touchend', () => {\r\n        if (longPressTimer) {\r\n          clearTimeout(longPressTimer);\r\n        }\r\n      });\r\n    }\r\n    this.renderUri(element, result);\r\n    this.bindEventToOpen();\r\n  }\r\n  public renderUri(element: HTMLElement, result?: IQueryResult) {\r\n    if (/^\\s*$/.test(this.element.innerHTML)) {\r\n      const title = this.getDisplayedTitle();\r\n      this.element.innerHTML = title;\r\n      if (!this.element.title) {\r\n        this.element.title = this.getDisplayedTitleAsText();\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * Opens the result in the same window, no matter how the actual component is configured for the end user.\r\n   * @param logAnalytics Specifies whether the method should log an analytics event.\r\n   */\r\n  public openLink(logAnalytics = true) {\r\n    if (logAnalytics) {\r\n      this.logOpenDocument();\r\n    }\r\n    window.location.href = this.getResultUri();\r\n  }\r\n\r\n  /**\r\n   * Opens the result in a new window, no matter how the actual component is configured for the end user.\r\n   * @param logAnalytics Specifies whether the method should log an analytics event.\r\n   */\r\n  public openLinkInNewWindow(logAnalytics = true) {\r\n    if (logAnalytics) {\r\n      this.logOpenDocument();\r\n    }\r\n    window.open(this.getResultUri(), '_blank');\r\n  }\r\n\r\n  /**\r\n   * Tries to open the result in Microsoft Outlook if the result has an `outlookformacuri` or `outlookuri` field.\r\n   *\r\n   * Normally, this implies the result should be a link to an email.\r\n   *\r\n   * If the needed fields are not present, this method does nothing.\r\n   * @param logAnalytics Specifies whether the method should log an analytics event.\r\n   */\r\n  public openLinkInOutlook(logAnalytics = true) {\r\n    if (this.hasOutlookField()) {\r\n      if (logAnalytics) {\r\n        this.logOpenDocument();\r\n      }\r\n      this.openLink();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Opens the link in the same manner the end user would.\r\n   *\r\n   * This essentially simulates a click on the result link.\r\n   *\r\n   * @param logAnalytics Specifies whether the method should log an analytics event.\r\n   */\r\n  public openLinkAsConfigured(logAnalytics = true) {\r\n    if (this.toExecuteOnOpen) {\r\n      if (logAnalytics) {\r\n        this.logOpenDocument();\r\n      }\r\n      this.toExecuteOnOpen();\r\n    }\r\n  }\r\n\r\n  protected bindEventToOpen(): boolean {\r\n    return (\r\n      this.bindOnClickIfNotUndefined() ||\r\n      this.bindOpenQuickviewIfNotUndefined() ||\r\n      this.setHrefIfNotAlready() ||\r\n      this.openLinkThatIsNotAnAnchor()\r\n    );\r\n  }\r\n\r\n  private getDisplayedTitle() {\r\n    if (!this.options.titleTemplate) {\r\n      return this.result.title\r\n        ? HighlightUtils.highlightString(this.result.title, this.result.titleHighlights, null, 'coveo-highlight')\r\n        : this.escapedClickUri;\r\n    } else {\r\n      let newTitle = StringUtils.buildStringTemplateFromResult(this.options.titleTemplate, this.result);\r\n      return newTitle\r\n        ? StreamHighlightUtils.highlightStreamText(newTitle, this.result.termsToHighlight, this.result.phrasesToHighlight)\r\n        : this.escapedClickUri;\r\n    }\r\n  }\r\n\r\n  private getDisplayedTitleAsText() {\r\n    const container = $$('div');\r\n    container.setHtml(this.getDisplayedTitle());\r\n    return container.text();\r\n  }\r\n\r\n  private get escapedClickUri() {\r\n    return escape(this.result.clickUri);\r\n  }\r\n\r\n  private bindOnClickIfNotUndefined() {\r\n    if (this.options.onClick != undefined) {\r\n      this.toExecuteOnOpen = (e: MouseEvent) => {\r\n        this.options.onClick.call(this, e, this.result);\r\n      };\r\n\r\n      new AccessibleButton()\r\n        .withElement(this.element)\r\n        .withLabel(this.result.title)\r\n        .withSelectAction((e: Event) => this.toExecuteOnOpen(e))\r\n        .build();\r\n\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private bindOpenQuickviewIfNotUndefined() {\r\n    if (this.quickviewShouldBeOpened()) {\r\n      this.toExecuteOnOpen = () => {\r\n        $$(this.bindings.resultElement).trigger(ResultListEvents.openQuickview);\r\n      };\r\n\r\n      $$(this.element).on('click', (e: Event) => {\r\n        e.preventDefault();\r\n        this.toExecuteOnOpen();\r\n      });\r\n\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private openLinkThatIsNotAnAnchor() {\r\n    if (!this.elementIsAnAnchor()) {\r\n      this.toExecuteOnOpen = () => {\r\n        if (this.options.alwaysOpenInNewWindow) {\r\n          if (this.options.openInOutlook) {\r\n            this.openLinkInOutlook();\r\n          } else {\r\n            this.openLinkInNewWindow();\r\n          }\r\n        } else {\r\n          this.openLink();\r\n        }\r\n      };\r\n\r\n      $$(this.element).on('click', () => {\r\n        this.toExecuteOnOpen();\r\n      });\r\n\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private setHrefIfNotAlready() {\r\n    // Do not erase any value put in href by the template, etc. Allows\r\n    // using custom click urls while still keeping analytics recording\r\n    // and other behavior brought by the component.\r\n    if (this.elementIsAnAnchor() && !Utils.isNonEmptyString($$(this.element).getAttribute('href'))) {\r\n      $$(this.element).setAttribute('href', this.getResultUri());\r\n      if (this.options.alwaysOpenInNewWindow && !(this.options.openInOutlook && this.hasOutlookField())) {\r\n        $$(this.element).setAttribute('target', '_blank');\r\n      }\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private logOpenDocument = debounce(\r\n    () => {\r\n      this.queryController.saveLastQuery();\r\n      let documentURL = $$(this.element).getAttribute('href');\r\n      if (documentURL == undefined || documentURL == '') {\r\n        documentURL = this.escapedClickUri;\r\n      }\r\n      this.usageAnalytics.logClickEvent(\r\n        analyticsActionCauseList.documentOpen,\r\n        {\r\n          documentURL: documentURL,\r\n          documentTitle: this.result.title,\r\n          author: Utils.getFieldValue(this.result, 'author')\r\n        },\r\n        this.result,\r\n        this.root\r\n      );\r\n      Defer.flush();\r\n    },\r\n    1500,\r\n    true\r\n  );\r\n\r\n  private filterProtocol(uri: string) {\r\n    const isAbsolute = /^(https?|ftp|file|mailto|tel):/i.test(uri);\r\n    const isRelative = /^\\//.test(uri);\r\n\r\n    return isAbsolute || isRelative ? uri : '';\r\n  }\r\n\r\n  private getResultUri(): string {\r\n    if (this.options.hrefTemplate) {\r\n      const uri = StringUtils.buildStringTemplateFromResult(this.options.hrefTemplate, this.result);\r\n      return this.filterProtocol(uri);\r\n    }\r\n\r\n    if (this.options.field == undefined && this.options.openInOutlook) {\r\n      this.setField();\r\n    }\r\n\r\n    if (this.options.field != undefined) {\r\n      return this.filterProtocol(Utils.getFieldValue(this.result, <string>this.options.field));\r\n    }\r\n\r\n    return this.filterProtocol(this.result.clickUri);\r\n  }\r\n\r\n  private elementIsAnAnchor() {\r\n    return this.element.tagName == 'A';\r\n  }\r\n\r\n  private setField() {\r\n    let os = Utils.exists(this.os) ? this.os : OSUtils.get();\r\n    if (os == OS_NAME.MACOSX && this.hasOutlookField()) {\r\n      this.options.field = '@outlookformacuri';\r\n    } else if (os == OS_NAME.WINDOWS && this.hasOutlookField()) {\r\n      this.options.field = '@outlookuri';\r\n    }\r\n  }\r\n\r\n  private hasOutlookField() {\r\n    let os = Utils.exists(this.os) ? this.os : OSUtils.get();\r\n    if (os == OS_NAME.MACOSX && this.result.raw['outlookformacuri'] != undefined) {\r\n      return true;\r\n    } else if (os == OS_NAME.WINDOWS && this.result.raw['outlookuri'] != undefined) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private isUriThatMustBeOpenedInQuickview(): boolean {\r\n    return this.escapedClickUri.toLowerCase().indexOf('ldap://') == 0;\r\n  }\r\n\r\n  private quickviewShouldBeOpened() {\r\n    return (this.options.openQuickview || this.isUriThatMustBeOpenedInQuickview()) && QueryUtils.hasHTMLVersion(this.result);\r\n  }\r\n}\r\n\r\nInitialization.registerAutoCreateComponent(ResultLink);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResultLink/ResultLink.ts"],"sourceRoot":""}
{"version":3,"sources":["./src/ui/ShareQuery/ShareQuery.ts","./sass/_ShareQuery.scss"],"names":[],"mappings":"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","file":"ShareQuery__93518d21988b4536d33d.js","sourcesContent":["import { Component } from '../Base/Component';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\nimport { SettingsEvents } from '../../events/SettingsEvents';\r\nimport { ISettingsPopulateMenuArgs } from '../Settings/Settings';\r\nimport { $$ } from '../../utils/Dom';\r\nimport { l } from '../../strings/Strings';\r\nimport { Utils } from '../../utils/Utils';\r\nimport { Initialization } from '../Base/Initialization';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { ModalBox as ModalBoxModule } from '../../ExternalModulesShim';\r\n\r\nimport 'styling/_ShareQuery';\r\nimport { SVGIcons } from '../../utils/SVGIcons';\r\n\r\nexport interface IShareQueryOptions {}\r\n\r\n/**\r\n * The ShareQuery component populates the {@link Settings} popup menu with the **Share Query** menu item. When the end\r\n * user clicks this item, it displays a panel containing two input boxes: one containing a shareable link and the other\r\n * containing the complete current query expression.\r\n */\r\nexport class ShareQuery extends Component {\r\n  static ID = 'ShareQuery';\r\n  static options: IShareQueryOptions = {};\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      ShareQuery: ShareQuery\r\n    });\r\n  };\r\n\r\n  public dialogBoxContent: HTMLElement;\r\n  private linkToThisQuery: HTMLInputElement;\r\n  private completeQuery: HTMLInputElement;\r\n  private modalbox: Coveo.ModalBox.ModalBox;\r\n\r\n  /**\r\n   * Creates a new ShareQuery component.\r\n   * @param element The HTMLElement on which to instantiate the component.\r\n   * @param options The options for the ShareQuery component.\r\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\r\n   * automatically resolved (with a slower execution time).\r\n   */\r\n  constructor(\r\n    public element: HTMLElement,\r\n    public options: IShareQueryOptions,\r\n    bindings?: IComponentBindings,\r\n    private ModalBox = ModalBoxModule\r\n  ) {\r\n    super(element, ShareQuery.ID, bindings);\r\n\r\n    this.bind.onRootElement(SettingsEvents.settingsPopulateMenu, (args: ISettingsPopulateMenuArgs) => {\r\n      args.menuData.push({\r\n        className: 'coveo-share-query',\r\n        text: l('ShareQuery'),\r\n        onOpen: () => this.open(),\r\n        onClose: () => this.close(),\r\n        svgIcon: SVGIcons.icons.dropdownShareQuery,\r\n        svgIconClassName: 'coveo-share-query-svg'\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Open the **Share Query** modal box.\r\n   */\r\n  public open() {\r\n    if (this.modalbox == null) {\r\n      this.dialogBoxContent = this.buildContent();\r\n      this.modalbox = this.ModalBox.open(this.dialogBoxContent, {\r\n        title: l('ShareQuery'),\r\n        className: 'coveo-share-query-opened',\r\n        body: this.searchInterface.options.modalContainer\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Close the **Share Query** modal box.\r\n   */\r\n  public close() {\r\n    if (this.modalbox) {\r\n      this.modalbox.close();\r\n      this.modalbox = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets the link to the current query.\r\n   */\r\n  public getLinkToThisQuery(): string {\r\n    if (!this.linkToThisQuery) {\r\n      this.buildLinkToThisQuery();\r\n    }\r\n    return this.linkToThisQuery.value;\r\n  }\r\n\r\n  /**\r\n   * Sets the link to the current query.\r\n   */\r\n  public setLinkToThisQuery(link: string): void {\r\n    if (!this.linkToThisQuery) {\r\n      this.buildLinkToThisQuery();\r\n    }\r\n    this.linkToThisQuery.value = link;\r\n  }\r\n\r\n  /**\r\n   * Gets the complete query expression string\r\n   */\r\n  public getCompleteQuery(): string {\r\n    if (!this.completeQuery) {\r\n      this.buildCompleteQuery();\r\n    }\r\n    return this.completeQuery.value;\r\n  }\r\n\r\n  /**\r\n   * Set the complete query expression string.\r\n   */\r\n  public setCompleteQuery(completeQuery: string) {\r\n    if (!this.completeQuery) {\r\n      this.buildCompleteQuery();\r\n    }\r\n    this.completeQuery.value = completeQuery;\r\n  }\r\n\r\n  private outputIfNotNull(value: string): string {\r\n    if (value) {\r\n      return '(' + value + ')';\r\n    }\r\n    return '';\r\n  }\r\n\r\n  private buildContent(): HTMLElement {\r\n    const content = $$('div', {\r\n      className: 'coveo-share-query-summary-info'\r\n    }).el;\r\n\r\n    const boxes = $$('div', {\r\n      className: 'coveo-share-query-summary-info-boxes'\r\n    }).el;\r\n\r\n    this.buildLinkToThisQuery();\r\n    this.buildCompleteQuery();\r\n\r\n    boxes.appendChild(this.buildTextBoxWithLabel(l('Link'), this.linkToThisQuery));\r\n    boxes.appendChild(this.buildTextBoxWithLabel(l('CompleteQuery'), this.completeQuery));\r\n    content.appendChild(boxes);\r\n\r\n    Component.pointElementsToDummyForm(content);\r\n\r\n    return content;\r\n  }\r\n\r\n  private buildCompleteQuery() {\r\n    this.completeQuery = <HTMLInputElement>$$('input', {\r\n      type: 'text',\r\n      className: 'coveo-share-query-summary-info-input'\r\n    }).el;\r\n\r\n    const lastQuery = this.queryController.getLastQuery();\r\n    this.completeQuery.value = Utils.trim(\r\n      `${this.outputIfNotNull(lastQuery.q)} ${this.outputIfNotNull(lastQuery.aq)} ${this.outputIfNotNull(lastQuery.cq)}`\r\n    );\r\n  }\r\n\r\n  private buildLinkToThisQuery() {\r\n    this.linkToThisQuery = <HTMLInputElement>$$('input', {\r\n      type: 'text',\r\n      className: 'coveo-share-query-summary-info-input'\r\n    }).el;\r\n\r\n    $$(this.linkToThisQuery).on('click', () => this.linkToThisQuery.select());\r\n    this.linkToThisQuery.value = window.location.href;\r\n  }\r\n\r\n  private buildTextBoxWithLabel(label: string, input: HTMLInputElement): HTMLElement {\r\n    const labelElement = $$('span', {\r\n      className: 'coveo-share-query-summary-info-label'\r\n    });\r\n    labelElement.text(label);\r\n\r\n    const returnDiv = $$('div').el;\r\n    returnDiv.appendChild(labelElement.el);\r\n    returnDiv.appendChild(input);\r\n    return returnDiv;\r\n  }\r\n}\r\n\r\nInitialization.registerAutoCreateComponent(ShareQuery);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ShareQuery/ShareQuery.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_ShareQuery.scss\n// module id = 667\n// module chunks = 59 88"],"sourceRoot":""}
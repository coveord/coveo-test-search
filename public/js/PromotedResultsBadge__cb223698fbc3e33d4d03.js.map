{"version":3,"sources":["./src/ui/PromotedResultsBadge/PromotedResultsBadge.ts","./sass/_PromotedResultsBadge.scss"],"names":[],"mappings":"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","file":"PromotedResultsBadge__cb223698fbc3e33d4d03.js","sourcesContent":["import 'styling/_PromotedResultsBadge';\r\nimport { $$, ComponentOptions, Dom, Initialization, l, ResultListEvents } from '../../Core';\r\nimport { IDisplayedNewResultEventArgs } from '../../events/ResultListEvents';\r\nimport { exportGlobally } from '../../GlobalExports';\r\nimport { IQueryResult } from '../../rest/QueryResult';\r\nimport { Component } from '../../ui/Base/Component';\r\nimport { IComponentBindings } from '../Base/ComponentBindings';\r\n\r\nexport interface IPromotedResultsBadgeOptions {\r\n  showBadgeForFeaturedResults: boolean;\r\n  showBadgeForRecommendedResults: boolean;\r\n\r\n  captionForRecommended: string;\r\n  captionForFeatured: string;\r\n\r\n  colorForFeaturedResults: string;\r\n  colorForRecommendedResults: string;\r\n}\r\n\r\n/**\r\n * Depending on its configuration, this component will render badges on query result items whose ranking scores were increased by [featured results](https://docs.coveo.com/en/1961/) query pipeline rules and/or [Coveo ML ART](https://docs.coveo.com/en/1671/#automatic-relevance-tuning-art-feature).\r\n *\r\n * This component can be put anywhere in the markup configuration of a search interface. However, it is meant to be initialized only once, and should thus never be included in a result template.\r\n *\r\n * @externaldocs [Adding Promoted Results Badges](https://docs.coveo.com/en/3123/)\r\n * @availablesince [July 2018 Release (v2.4382.10)](https://docs.coveo.com/en/1360/)\r\n */\r\nexport class PromotedResultsBadge extends Component {\r\n  static ID = 'PromotedResultsBadge';\r\n\r\n  static doExport = () => {\r\n    exportGlobally({\r\n      PromotedResultsBadge\r\n    });\r\n  };\r\n\r\n  /**\r\n   * @componentOptions\r\n   */\r\n  static options: IPromotedResultsBadgeOptions = {\r\n    /**\r\n     * Whether to show a badge when a result was promoted by a featured results query pipeline rule.\r\n     */\r\n    showBadgeForFeaturedResults: ComponentOptions.buildBooleanOption({ defaultValue: true }),\r\n\r\n    /**\r\n     * Whether to show a badge when a result was promoted by Coveo ML ART.\r\n     */\r\n    showBadgeForRecommendedResults: ComponentOptions.buildBooleanOption({ defaultValue: false }),\r\n\r\n    /**\r\n     * The caption to show on the badge for results promoted by Coveo ML ART.\r\n     *\r\n     * Default value is the localized string for `Recommended`.\r\n     *\r\n     * @examples Recommended by Coveo ML\r\n     */\r\n    captionForRecommended: ComponentOptions.buildLocalizedStringOption({\r\n      localizedString: () => l('Recommended'),\r\n      depend: 'showBadgeForRecommendedResults'\r\n    }),\r\n\r\n    /**\r\n     * The caption to show on the badge for results promoted by a _featured results_ query pipeline rule.\r\n     *\r\n     * Default value is the localized string for `Featured`.\r\n     *\r\n     * @examples Recommended by ACME\r\n     */\r\n    captionForFeatured: ComponentOptions.buildLocalizedStringOption({\r\n      localizedString: () => l('Featured'),\r\n      depend: 'showBadgeForFeaturedResults'\r\n    }),\r\n\r\n    /**\r\n     * The badge color for results promoted by a _featured results_ query pipeline rule.\r\n     *\r\n     * Can be specified using:\r\n     * - a hexadecimal value\r\n     * - an RGB value\r\n     * - a CSS color name\r\n     *\r\n     * @examples #f58020, rgb(125 10 36), red\r\n     *\r\n     * Default value is controlled through the default stylesheet of the framework.\r\n     */\r\n    colorForFeaturedResults: ComponentOptions.buildColorOption({ depend: 'showBadgeForFeaturedResults' }),\r\n\r\n    /**\r\n     * The badge color for results promoted by Coveo ML ART.\r\n     *\r\n     * Can be specified using:\r\n     * - a hexadecimal value\r\n     * - an RGB value\r\n     * - a CSS color name\r\n     *\r\n     * @examples #f58020, rgb(125 10 36), red\r\n     *\r\n     * Default value is controlled through the default stylesheet of the framework.\r\n     */\r\n    colorForRecommendedResults: ComponentOptions.buildColorOption({ depend: 'showBadgeForRecommendedResults' })\r\n  };\r\n\r\n  constructor(public element: HTMLElement, public options: IPromotedResultsBadgeOptions, public bindings: IComponentBindings) {\r\n    super(element, PromotedResultsBadge.ID, bindings);\r\n    this.options = ComponentOptions.initComponentOptions(element, PromotedResultsBadge, options);\r\n    this.bind.onRootElement(ResultListEvents.newResultDisplayed, (args: IDisplayedNewResultEventArgs) => {\r\n      const badge = this.buildBadge(args.result, args.item);\r\n      if (badge) {\r\n        this.appendBadge(badge, args.item);\r\n      }\r\n    });\r\n  }\r\n\r\n  private buildBadge(result: IQueryResult, resultElement: HTMLElement): Dom {\r\n    if (!this.shouldShowABadge(result, resultElement)) {\r\n      return null;\r\n    }\r\n    const badge = $$('div', {\r\n      className: this.getClassName(result)\r\n    });\r\n\r\n    this.applyTagline(result, badge);\r\n    this.applyColor(result, badge);\r\n    return badge;\r\n  }\r\n\r\n  private appendBadge(badge: Dom, resultElement: HTMLElement) {\r\n    if (this.isCardLayout(resultElement)) {\r\n      this.addBadgeToCardLayout(badge, resultElement);\r\n    } else {\r\n      $$(resultElement).prepend(badge.el);\r\n    }\r\n  }\r\n\r\n  private addBadgeToCardLayout(badge: Dom, resultElement: HTMLElement): void {\r\n    let container: Dom;\r\n\r\n    if (resultElement.parentElement == null) {\r\n      container = $$('div', {\r\n        className: 'coveo-promoted-result-badge-container-card-layout'\r\n      });\r\n\r\n      container.insertBefore(resultElement);\r\n    } else {\r\n      container = $$(resultElement.parentElement);\r\n    }\r\n\r\n    container.append(badge.el);\r\n    container.append(resultElement);\r\n  }\r\n\r\n  private applyColor(result: IQueryResult, badge: Dom) {\r\n    if (this.isFeatured(result) && this.options.colorForFeaturedResults) {\r\n      badge.el.style.backgroundColor = this.options.colorForFeaturedResults;\r\n    }\r\n\r\n    if (this.isRecommended(result) && this.options.colorForRecommendedResults) {\r\n      badge.el.style.backgroundColor = this.options.colorForRecommendedResults;\r\n    }\r\n  }\r\n\r\n  private applyTagline(result: IQueryResult, badge: Dom): string {\r\n    if (this.isFeatured(result) && this.options.showBadgeForFeaturedResults) {\r\n      badge.text(this.options.captionForFeatured);\r\n    }\r\n    if (this.isRecommended(result) && this.options.showBadgeForRecommendedResults) {\r\n      return badge.text(this.options.captionForRecommended);\r\n    }\r\n  }\r\n\r\n  private isFeatured(result: IQueryResult): boolean {\r\n    return result.isTopResult;\r\n  }\r\n\r\n  private isRecommended(result: IQueryResult): boolean {\r\n    return result.isRecommendation && !result.isTopResult;\r\n  }\r\n\r\n  private isTableLayout(resultElement: HTMLElement): boolean {\r\n    return $$(resultElement).hasClass('coveo-table-layout');\r\n  }\r\n\r\n  private isCardLayout(resultElement: HTMLElement): boolean {\r\n    return $$(resultElement).hasClass('coveo-card-layout');\r\n  }\r\n\r\n  private getClassName(result: IQueryResult) {\r\n    return `coveo-promoted-result-badge coveo-${this.isFeatured(result) ? 'featured' : 'recommended'}-result-badge`;\r\n  }\r\n\r\n  private shouldShowABadge(result: IQueryResult, resultElement: HTMLElement): boolean {\r\n    if (this.isTableLayout(resultElement)) {\r\n      return false;\r\n    }\r\n\r\n    if (this.isFeatured(result) && this.options.showBadgeForFeaturedResults) {\r\n      return true;\r\n    }\r\n\r\n    if (this.isRecommended(result) && this.options.showBadgeForRecommendedResults) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n}\r\n\r\nInitialization.registerAutoCreateComponent(PromotedResultsBadge);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/PromotedResultsBadge/PromotedResultsBadge.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_PromotedResultsBadge.scss\n// module id = 674\n// module chunks = 66 88"],"sourceRoot":""}